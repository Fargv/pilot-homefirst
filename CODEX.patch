diff --git a/backend/src/kitchen/routes/shopping.js b/backend/src/kitchen/routes/shopping.js
index 63c6bddd6b0a2ae982c7566eff0aeae2bec5d68c..9cae5064f76113c6bc62de10aee579f3042ce1c6 100644
--- a/backend/src/kitchen/routes/shopping.js
+++ b/backend/src/kitchen/routes/shopping.js
@@ -1,387 +1,405 @@
-import express from "express";
-import { Category } from "../models/Category.js";
-import { Store } from "../models/Store.js";
-import { KitchenUser } from "../models/KitchenUser.js";
-import { requireAuth, requireDiod } from "../middleware.js";
-import { formatDateISO, getWeekStart, parseISODate } from "../utils/dates.js";
-import {
-  buildScopedFilter,
-  getEffectiveHouseholdId,
-  handleHouseholdError
-} from "../householdScope.js";
-import { ensureShoppingList, rebuildShoppingList, resolveShoppingItemIngredientData } from "../shoppingService.js";
-import { CATALOG_SCOPES } from "../utils/catalogScopes.js";
-import {
-  DEFAULT_CATEGORY_COLOR_BG,
-  DEFAULT_CATEGORY_COLOR_TEXT,
-  DEFAULT_CATEGORY_NAME,
-  DEFAULT_CATEGORY_SLUG,
-  ensureDefaultCategory
-} from "../utils/categoryMatching.js";
-
-const router = express.Router();
-
-function normalizeStoreName(value = "") {
-  return String(value).trim().toLowerCase();
-}
-
-function sortStores(stores = []) {
-  return [...stores].sort((a, b) => {
-    const orderA = Number.isFinite(a.order) ? a.order : Number.POSITIVE_INFINITY;
-    const orderB = Number.isFinite(b.order) ? b.order : Number.POSITIVE_INFINITY;
-    if (orderA !== orderB) return orderA - orderB;
-    return String(a.name || "").localeCompare(String(b.name || ""), "es", { sensitivity: "base" });
-  });
-}
-
-function buildStoreVisibilityFilter(effectiveHouseholdId, extraFilter = {}) {
-  return {
-    ...extraFilter,
-    $or: [
-      { scope: "master", householdId: null },
-      { scope: "household", householdId: effectiveHouseholdId }
-    ]
-  };
-}
-
-function buildCategoryVisibilityFilter(effectiveHouseholdId, extraFilter = {}) {
-  return {
-    ...extraFilter,
-    $or: [
-      { scope: CATALOG_SCOPES.MASTER, householdId: null },
-      { scope: CATALOG_SCOPES.HOUSEHOLD, householdId: effectiveHouseholdId },
-      { scope: CATALOG_SCOPES.OVERRIDE, householdId: effectiveHouseholdId }
-    ]
-  };
-}
-
-function toDateGroup(value) {
-  if (!value) return "sin-fecha";
-  return new Date(value).toISOString().slice(0, 10);
-}
-
-async function getShoppingPayload(weekStartDate, effectiveHouseholdId) {
-  const list = await ensureShoppingList(weekStartDate, effectiveHouseholdId);
-
-  const resolved = await resolveShoppingItemIngredientData(list.items.map((item) => item.toObject()), effectiveHouseholdId);
-  if (resolved.changed) {
-    list.items = resolved.resolvedItems;
-    await list.save();
-  }
-
-  const fallbackCategory = await ensureDefaultCategory({
-    Category,
-    householdId: effectiveHouseholdId
-  });
-
-  const categories = await Category.find(buildCategoryVisibilityFilter(effectiveHouseholdId, { isArchived: { $ne: true } })).select(
-    "_id name slug colorBg colorText"
-  );
-  const stores = sortStores(
-    await Store.find(buildStoreVisibilityFilter(effectiveHouseholdId, { active: true }))
-      .select("_id name order scope householdId")
-      .lean()
-  );
-
-  const storeById = new Map(stores.map((store) => [String(store._id), store.name]));
-  const categoryById = new Map(categories.map((category) => [String(category._id), category]));
-  const purchaserIds = list.items
-    .filter((item) => item.purchasedBy)
-    .map((item) => String(item.purchasedBy));
-  const purchasers = purchaserIds.length
-    ? await KitchenUser.find(buildScopedFilter(effectiveHouseholdId, { _id: { $in: purchaserIds } })).select("_id displayName")
-    : [];
-  const purchaserById = new Map(purchasers.map((person) => [String(person._id), person.displayName]));
-
-  const pendingByCategory = list.items
-    .filter((item) => item.status === "pending")
-    .reduce((acc, item) => {
-      const key = item.categoryId ? String(item.categoryId) : "uncategorized";
-      const resolvedCategory = item.categoryId
-        ? categoryById.get(String(item.categoryId)) || null
-        : fallbackCategory || null;
-
-      if (!acc.has(key)) {
-        acc.set(key, {
-          categoryId: resolvedCategory?._id || item.categoryId || null,
-          categoryInfo: {
-            name: resolvedCategory?.name || DEFAULT_CATEGORY_NAME,
-            slug: resolvedCategory?.slug || DEFAULT_CATEGORY_SLUG,
-            colorBg: resolvedCategory?.colorBg || DEFAULT_CATEGORY_COLOR_BG,
-            colorText: resolvedCategory?.colorText || DEFAULT_CATEGORY_COLOR_TEXT
-          },
-          items: []
-        });
-      }
-      acc.get(key).items.push({
-        ...item.toObject(),
-        purchasedByName: item.purchasedBy ? purchaserById.get(String(item.purchasedBy)) || "Usuario" : null
-      });
-      return acc;
-    }, new Map());
-
-  const purchasedByStoreDay = list.items
-    .filter((item) => item.status === "purchased")
-    .reduce((acc, item) => {
-      const dateKey = toDateGroup(item.purchasedAt);
-      const storeKey = item.storeId ? String(item.storeId) : "no-store";
-      const key = `${dateKey}::${storeKey}`;
-      if (!acc.has(key)) {
-        acc.set(key, {
-          storeId: item.storeId || null,
-          storeName: item.storeId ? storeById.get(String(item.storeId)) || "Supermercado" : "Sin supermercado",
-          purchasedDate: dateKey,
-          startedAt: item.purchasedAt,
-          items: []
-        });
-      }
-      acc.get(key).items.push({
-        ...item.toObject(),
-        purchasedByName: item.purchasedBy ? purchaserById.get(String(item.purchasedBy)) || "Usuario" : null
-      });
-      return acc;
-    }, new Map());
-
-  return {
-    list,
-    stores,
-    pendingByCategory: Array.from(pendingByCategory.values()),
-    purchasedByStoreDay: Array.from(purchasedByStoreDay.values()).sort(
-      (a, b) => new Date(b.startedAt || 0).getTime() - new Date(a.startedAt || 0).getTime()
-    )
-  };
-}
-
-async function validateStoreSelection(storeId, effectiveHouseholdId) {
-  if (!storeId) return null;
-  const store = await Store.findOne(buildStoreVisibilityFilter(effectiveHouseholdId, { _id: storeId, active: true }))
-    .select("_id")
-    .lean();
-  return store ? store._id : null;
-}
-
-router.get("/:weekStart", requireAuth, async (req, res) => {
-  try {
-    const weekStart = parseISODate(req.params.weekStart);
-    if (!weekStart) return res.status(400).json({ ok: false, error: "Fecha inválida." });
-
-    const effectiveHouseholdId = getEffectiveHouseholdId(req.user);
-    const monday = getWeekStart(weekStart);
-    const payload = await getShoppingPayload(monday, effectiveHouseholdId);
-
-    res.json({ ok: true, weekStart: formatDateISO(monday), ...payload });
-  } catch (error) {
-    const handled = handleHouseholdError(res, error);
-    if (handled) return handled;
-    return res.status(500).json({ ok: false, error: "No se pudo cargar la lista de compra." });
-  }
-});
-
-router.post("/:weekStart/rebuild", requireAuth, async (req, res) => {
-  try {
-    const weekStart = parseISODate(req.params.weekStart);
-    if (!weekStart) return res.status(400).json({ ok: false, error: "Fecha inválida." });
-
-    const effectiveHouseholdId = getEffectiveHouseholdId(req.user);
-    const monday = getWeekStart(weekStart);
-    await rebuildShoppingList(monday, effectiveHouseholdId);
-    const payload = await getShoppingPayload(monday, effectiveHouseholdId);
-
-    res.json({ ok: true, ...payload });
-  } catch (error) {
-    const handled = handleHouseholdError(res, error);
-    if (handled) return handled;
-    return res.status(500).json({ ok: false, error: "No se pudo reconstruir la lista de compra." });
-  }
-});
-
-router.put("/:weekStart/item", requireAuth, async (req, res) => {
-  try {
-    const weekStart = parseISODate(req.params.weekStart);
-    if (!weekStart) return res.status(400).json({ ok: false, error: "Fecha inválida." });
-
-    const { canonicalName, status, ingredientId, storeId } = req.body;
-    if (!canonicalName && !ingredientId) {
-      return res.status(400).json({ ok: false, error: "Ingrediente inválido." });
-    }
-
-    const effectiveHouseholdId = getEffectiveHouseholdId(req.user);
-    const monday = getWeekStart(weekStart);
-    const list = await ensureShoppingList(monday, effectiveHouseholdId);
-
-    const item = list.items.find((current) => {
-      if (ingredientId && current.ingredientId) return String(current.ingredientId) === String(ingredientId);
-      return current.canonicalName === canonicalName;
-    });
-
-    if (!item) return res.status(404).json({ ok: false, error: "Ingrediente no encontrado en la lista." });
-
-    const normalizedStatus = status === "purchased" ? "purchased" : "pending";
-    item.status = normalizedStatus;
-    if (normalizedStatus === "purchased") {
-      const validatedStoreId = await validateStoreSelection(storeId, effectiveHouseholdId);
-      item.purchasedBy = req.kitchenUser._id;
-      item.purchasedAt = new Date();
-      item.storeId = validatedStoreId;
-    } else {
-      item.purchasedBy = null;
-      item.purchasedAt = null;
-      item.storeId = null;
-    }
-
-    await list.save();
-    const payload = await getShoppingPayload(monday, effectiveHouseholdId);
-    res.json({ ok: true, ...payload });
-  } catch (error) {
-    const handled = handleHouseholdError(res, error);
-    if (handled) return handled;
-    return res.status(500).json({ ok: false, error: "No se pudo actualizar la lista de compra." });
-  }
-});
-
-router.put("/:weekStart/item/store", requireAuth, async (req, res) => {
-  try {
-    const weekStart = parseISODate(req.params.weekStart);
-    if (!weekStart) return res.status(400).json({ ok: false, error: "Fecha inválida." });
-
-    const { canonicalName, ingredientId, storeId } = req.body;
-    if (!canonicalName && !ingredientId) {
-      return res.status(400).json({ ok: false, error: "Ingrediente inválido." });
-    }
-
-    const effectiveHouseholdId = getEffectiveHouseholdId(req.user);
-    const monday = getWeekStart(weekStart);
-    const list = await ensureShoppingList(monday, effectiveHouseholdId);
-
-    const item = list.items.find((current) => {
-      if (ingredientId && current.ingredientId) return String(current.ingredientId) === String(ingredientId);
-      return current.canonicalName === canonicalName;
-    });
-
-    if (!item || item.status !== "purchased") {
-      return res.status(404).json({ ok: false, error: "Ingrediente comprado no encontrado." });
-    }
-
-    item.storeId = await validateStoreSelection(storeId, effectiveHouseholdId);
-    await list.save();
-
-    const payload = await getShoppingPayload(monday, effectiveHouseholdId);
-    return res.json({ ok: true, ...payload });
-  } catch (error) {
-    const handled = handleHouseholdError(res, error);
-    if (handled) return handled;
-    return res.status(500).json({ ok: false, error: "No se pudo actualizar el supermercado." });
-  }
-});
-
-router.post("/:weekStart/purchased/assign-store", requireAuth, async (req, res) => {
-  try {
-    const weekStart = parseISODate(req.params.weekStart);
-    if (!weekStart) return res.status(400).json({ ok: false, error: "Fecha inválida." });
-
-    const { storeId } = req.body;
-    const effectiveHouseholdId = getEffectiveHouseholdId(req.user);
-    const monday = getWeekStart(weekStart);
-    const list = await ensureShoppingList(monday, effectiveHouseholdId);
-    const validatedStoreId = await validateStoreSelection(storeId, effectiveHouseholdId);
-
-    const today = new Date().toISOString().slice(0, 10);
-    let changed = false;
-    for (const item of list.items) {
-      if (item.status !== "purchased" || item.storeId || !item.purchasedAt) continue;
-      if (toDateGroup(item.purchasedAt) !== today) continue;
-      item.storeId = validatedStoreId;
-      changed = true;
-    }
-
-    if (changed) await list.save();
-
-    const payload = await getShoppingPayload(monday, effectiveHouseholdId);
-    return res.json({ ok: true, updated: changed, ...payload });
-  } catch (error) {
-    const handled = handleHouseholdError(res, error);
-    if (handled) return handled;
-    return res.status(500).json({ ok: false, error: "No se pudo asignar el supermercado." });
-  }
-});
-
-router.post("/stores", requireAuth, async (req, res) => {
-  try {
-    const effectiveHouseholdId = getEffectiveHouseholdId(req.user);
-    const name = String(req.body?.name || "").trim();
-    if (!name) return res.status(400).json({ ok: false, error: "Debes indicar un nombre." });
-    const canonicalName = normalizeStoreName(name);
-
-    const store = await Store.findOneAndUpdate(
-      { scope: "household", householdId: effectiveHouseholdId, canonicalName },
-      { $setOnInsert: { scope: "household", householdId: effectiveHouseholdId, name, canonicalName } },
-      { new: true, upsert: true }
-    );
-
-    return res.status(201).json({ ok: true, store });
-  } catch (error) {
-    const handled = handleHouseholdError(res, error);
-    if (handled) return handled;
-    return res.status(500).json({ ok: false, error: "No se pudo crear la tienda." });
-  }
-});
-
-router.get("/stores/master", requireAuth, requireDiod, async (req, res) => {
-  const stores = sortStores(
-    await Store.find({ scope: "master", householdId: null }).select("_id name canonicalName active order scope")
-  );
-  return res.json({ ok: true, stores });
-});
-
-router.post("/stores/master", requireAuth, requireDiod, async (req, res) => {
-  const name = String(req.body?.name || "").trim();
-  if (!name) return res.status(400).json({ ok: false, error: "Debes indicar un nombre." });
-  const canonicalName = normalizeStoreName(name);
-  const requestedOrder = Number(req.body?.order);
-
-  const store = await Store.findOneAndUpdate(
-    { scope: "master", householdId: null, canonicalName },
-    {
-      $set: {
-        name,
-        canonicalName,
-        active: req.body?.active !== false,
-        order: Number.isFinite(requestedOrder) ? requestedOrder : null,
-        scope: "master",
-        householdId: null
-      }
-    },
-    { new: true, upsert: true }
-  );
-  return res.status(201).json({ ok: true, store });
-});
-
-router.put("/stores/master/:storeId", requireAuth, requireDiod, async (req, res) => {
-  const store = await Store.findOne({ _id: req.params.storeId, scope: "master", householdId: null });
-  if (!store) return res.status(404).json({ ok: false, error: "Supermercado no encontrado." });
-
-  if (req.body?.name !== undefined) {
-    const name = String(req.body.name || "").trim();
-    if (!name) return res.status(400).json({ ok: false, error: "Nombre inválido." });
-    store.name = name;
-    store.canonicalName = normalizeStoreName(name);
-  }
-  if (req.body?.active !== undefined) store.active = Boolean(req.body.active);
-  if (req.body?.order !== undefined) {
-    const requestedOrder = Number(req.body.order);
-    store.order = Number.isFinite(requestedOrder) ? requestedOrder : null;
-  }
-
-  await store.save();
-  return res.json({ ok: true, store });
-});
-
-router.delete("/stores/master/:storeId", requireAuth, requireDiod, async (req, res) => {
-  const store = await Store.findOne({ _id: req.params.storeId, scope: "master", householdId: null });
-  if (!store) return res.status(404).json({ ok: false, error: "Supermercado no encontrado." });
-  store.active = false;
-  await store.save();
-  return res.json({ ok: true, store });
-});
-
-export default router;
+import express from "express";
+import { Category } from "../models/Category.js";
+import { Store } from "../models/Store.js";
+import { KitchenUser } from "../models/KitchenUser.js";
+import { requireAuth, requireDiod } from "../middleware.js";
+import { formatDateISO, getWeekStart, parseISODate } from "../utils/dates.js";
+import {
+  buildScopedFilter,
+  getEffectiveHouseholdId,
+  handleHouseholdError
+} from "../householdScope.js";
+import { ensureShoppingList, rebuildShoppingList, resolveShoppingItemIngredientData } from "../shoppingService.js";
+import { CATALOG_SCOPES } from "../utils/catalogScopes.js";
+import {
+  DEFAULT_CATEGORY_COLOR_BG,
+  DEFAULT_CATEGORY_COLOR_TEXT,
+  DEFAULT_CATEGORY_NAME,
+  DEFAULT_CATEGORY_SLUG,
+  ensureDefaultCategory
+} from "../utils/categoryMatching.js";
+
+const router = express.Router();
+
+function logShoppingError(context, error, extra = {}) {
+  console.error(`[kitchen][shopping] ${context}`, {
+    ...extra,
+    message: error?.message,
+    stack: error?.stack
+  });
+}
+
+
+function normalizeStoreName(value = "") {
+  return String(value).trim().toLowerCase();
+}
+
+function sortStores(stores = []) {
+  return [...stores].sort((a, b) => {
+    const orderA = Number.isFinite(a.order) ? a.order : Number.POSITIVE_INFINITY;
+    const orderB = Number.isFinite(b.order) ? b.order : Number.POSITIVE_INFINITY;
+    if (orderA !== orderB) return orderA - orderB;
+    return String(a.name || "").localeCompare(String(b.name || ""), "es", { sensitivity: "base" });
+  });
+}
+
+function buildStoreVisibilityFilter(effectiveHouseholdId, extraFilter = {}) {
+  return {
+    ...extraFilter,
+    $or: [
+      { scope: "master", householdId: null },
+      { scope: "household", householdId: effectiveHouseholdId }
+    ]
+  };
+}
+
+function buildCategoryVisibilityFilter(effectiveHouseholdId, extraFilter = {}) {
+  return {
+    ...extraFilter,
+    $or: [
+      { scope: CATALOG_SCOPES.MASTER, householdId: null },
+      { scope: CATALOG_SCOPES.HOUSEHOLD, householdId: effectiveHouseholdId },
+      { scope: CATALOG_SCOPES.OVERRIDE, householdId: effectiveHouseholdId }
+    ]
+  };
+}
+
+function toDateGroup(value) {
+  if (!value) return "sin-fecha";
+  return new Date(value).toISOString().slice(0, 10);
+}
+
+async function getShoppingPayload(weekStartDate, effectiveHouseholdId) {
+  const list = await ensureShoppingList(weekStartDate, effectiveHouseholdId);
+
+  const fallbackCategory = await ensureDefaultCategory({
+    Category,
+    householdId: effectiveHouseholdId
+  });
+
+  const resolved = await resolveShoppingItemIngredientData(
+    list.items.map((item) => item.toObject()),
+    effectiveHouseholdId,
+    { fallbackCategoryId: fallbackCategory?._id || null }
+  );
+  if (resolved.changed) {
+    list.items = resolved.resolvedItems;
+    await list.save();
+  }
+
+  const categories = await Category.find(buildCategoryVisibilityFilter(effectiveHouseholdId, { isArchived: { $ne: true } })).select(
+    "_id name slug colorBg colorText"
+  );
+  const stores = sortStores(
+    await Store.find(buildStoreVisibilityFilter(effectiveHouseholdId, { active: true }))
+      .select("_id name order scope householdId")
+      .lean()
+  );
+
+  const storeById = new Map(stores.map((store) => [String(store._id), store.name]));
+  const categoryById = new Map(categories.map((category) => [String(category._id), category]));
+  const purchaserIds = list.items
+    .filter((item) => item.purchasedBy)
+    .map((item) => String(item.purchasedBy));
+  const purchasers = purchaserIds.length
+    ? await KitchenUser.find(buildScopedFilter(effectiveHouseholdId, { _id: { $in: purchaserIds } })).select("_id displayName")
+    : [];
+  const purchaserById = new Map(purchasers.map((person) => [String(person._id), person.displayName]));
+
+  const pendingByCategory = list.items
+    .filter((item) => item.status === "pending")
+    .reduce((acc, item) => {
+      const key = item.categoryId ? String(item.categoryId) : "uncategorized";
+      const resolvedCategory = item.categoryId
+        ? categoryById.get(String(item.categoryId)) || null
+        : fallbackCategory || null;
+
+      if (!acc.has(key)) {
+        acc.set(key, {
+          categoryId: resolvedCategory?._id || item.categoryId || null,
+          categoryInfo: {
+            name: resolvedCategory?.name || DEFAULT_CATEGORY_NAME,
+            slug: resolvedCategory?.slug || DEFAULT_CATEGORY_SLUG,
+            colorBg: resolvedCategory?.colorBg || DEFAULT_CATEGORY_COLOR_BG,
+            colorText: resolvedCategory?.colorText || DEFAULT_CATEGORY_COLOR_TEXT
+          },
+          items: []
+        });
+      }
+      acc.get(key).items.push({
+        ...item.toObject(),
+        purchasedByName: item.purchasedBy ? purchaserById.get(String(item.purchasedBy)) || "Usuario" : null
+      });
+      return acc;
+    }, new Map());
+
+  const purchasedByStoreDay = list.items
+    .filter((item) => item.status === "purchased")
+    .reduce((acc, item) => {
+      const dateKey = toDateGroup(item.purchasedAt);
+      const storeKey = item.storeId ? String(item.storeId) : "no-store";
+      const key = `${dateKey}::${storeKey}`;
+      if (!acc.has(key)) {
+        acc.set(key, {
+          storeId: item.storeId || null,
+          storeName: item.storeId ? storeById.get(String(item.storeId)) || "Supermercado no definido" : "Supermercado no definido",
+          purchasedDate: dateKey,
+          startedAt: item.purchasedAt,
+          purchasedByName: item.purchasedBy ? purchaserById.get(String(item.purchasedBy)) || "Usuario" : "Usuario",
+          items: []
+        });
+      }
+      acc.get(key).items.push({
+        ...item.toObject(),
+        purchasedByName: item.purchasedBy ? purchaserById.get(String(item.purchasedBy)) || "Usuario" : null
+      });
+      return acc;
+    }, new Map());
+
+  return {
+    list,
+    stores,
+    pendingByCategory: Array.from(pendingByCategory.values()),
+    purchasedByStoreDay: Array.from(purchasedByStoreDay.values()).sort(
+      (a, b) => new Date(b.startedAt || 0).getTime() - new Date(a.startedAt || 0).getTime()
+    )
+  };
+}
+
+async function validateStoreSelection(storeId, effectiveHouseholdId) {
+  if (!storeId) return null;
+  const store = await Store.findOne(buildStoreVisibilityFilter(effectiveHouseholdId, { _id: storeId, active: true }))
+    .select("_id")
+    .lean();
+  return store ? store._id : null;
+}
+
+router.get("/:weekStart", requireAuth, async (req, res) => {
+  try {
+    const weekStart = parseISODate(req.params.weekStart);
+    if (!weekStart) return res.status(400).json({ ok: false, error: "Fecha inválida." });
+
+    const effectiveHouseholdId = getEffectiveHouseholdId(req.user);
+    const monday = getWeekStart(weekStart);
+    const payload = await getShoppingPayload(monday, effectiveHouseholdId);
+
+    res.json({ ok: true, weekStart: formatDateISO(monday), ...payload });
+  } catch (error) {
+    const handled = handleHouseholdError(res, error);
+    if (handled) return handled;
+    return res.status(500).json({ ok: false, error: "No se pudo cargar la lista de compra." });
+  }
+});
+
+router.post("/:weekStart/rebuild", requireAuth, async (req, res) => {
+  try {
+    const weekStart = parseISODate(req.params.weekStart);
+    if (!weekStart) return res.status(400).json({ ok: false, error: "Fecha inválida." });
+
+    const effectiveHouseholdId = getEffectiveHouseholdId(req.user);
+    const monday = getWeekStart(weekStart);
+    await rebuildShoppingList(monday, effectiveHouseholdId);
+    const payload = await getShoppingPayload(monday, effectiveHouseholdId);
+
+    res.json({ ok: true, ...payload });
+  } catch (error) {
+    const handled = handleHouseholdError(res, error);
+    if (handled) return handled;
+    logShoppingError("rebuild", error, { weekStart: req.params.weekStart, userId: String(req.kitchenUser?._id || "") });
+    if (error?.name === "ValidationError" || error?.name === "CastError") {
+      return res.status(400).json({ ok: false, error: "Datos inválidos al reconstruir la lista." });
+    }
+    return res.status(500).json({ ok: false, error: "No se pudo reconstruir la lista de compra." });
+  }
+});
+
+router.put("/:weekStart/item", requireAuth, async (req, res) => {
+  try {
+    const weekStart = parseISODate(req.params.weekStart);
+    if (!weekStart) return res.status(400).json({ ok: false, error: "Fecha inválida." });
+
+    const { canonicalName, status, ingredientId, storeId } = req.body;
+    if (!canonicalName && !ingredientId) {
+      return res.status(400).json({ ok: false, error: "Ingrediente inválido." });
+    }
+
+    const effectiveHouseholdId = getEffectiveHouseholdId(req.user);
+    const monday = getWeekStart(weekStart);
+    const list = await ensureShoppingList(monday, effectiveHouseholdId);
+
+    const item = list.items.find((current) => {
+      if (ingredientId && current.ingredientId) return String(current.ingredientId) === String(ingredientId);
+      return current.canonicalName === canonicalName;
+    });
+
+    if (!item) return res.status(404).json({ ok: false, error: "Ingrediente no encontrado en la lista." });
+
+    const normalizedStatus = status === "purchased" ? "purchased" : "pending";
+    item.status = normalizedStatus;
+    if (normalizedStatus === "purchased") {
+      const validatedStoreId = await validateStoreSelection(storeId, effectiveHouseholdId);
+      item.purchasedBy = req.kitchenUser._id;
+      item.purchasedAt = new Date();
+      item.storeId = validatedStoreId;
+    } else {
+      item.purchasedBy = null;
+      item.purchasedAt = null;
+      item.storeId = null;
+    }
+
+    await list.save();
+    const payload = await getShoppingPayload(monday, effectiveHouseholdId);
+    res.json({ ok: true, ...payload });
+  } catch (error) {
+    const handled = handleHouseholdError(res, error);
+    if (handled) return handled;
+    return res.status(500).json({ ok: false, error: "No se pudo actualizar la lista de compra." });
+  }
+});
+
+router.put("/:weekStart/item/store", requireAuth, async (req, res) => {
+  try {
+    const weekStart = parseISODate(req.params.weekStart);
+    if (!weekStart) return res.status(400).json({ ok: false, error: "Fecha inválida." });
+
+    const { canonicalName, ingredientId, storeId } = req.body;
+    if (!canonicalName && !ingredientId) {
+      return res.status(400).json({ ok: false, error: "Ingrediente inválido." });
+    }
+
+    const effectiveHouseholdId = getEffectiveHouseholdId(req.user);
+    const monday = getWeekStart(weekStart);
+    const list = await ensureShoppingList(monday, effectiveHouseholdId);
+
+    const item = list.items.find((current) => {
+      if (ingredientId && current.ingredientId) return String(current.ingredientId) === String(ingredientId);
+      return current.canonicalName === canonicalName;
+    });
+
+    if (!item || item.status !== "purchased") {
+      return res.status(404).json({ ok: false, error: "Ingrediente comprado no encontrado." });
+    }
+
+    item.storeId = await validateStoreSelection(storeId, effectiveHouseholdId);
+    await list.save();
+
+    const payload = await getShoppingPayload(monday, effectiveHouseholdId);
+    return res.json({ ok: true, ...payload });
+  } catch (error) {
+    const handled = handleHouseholdError(res, error);
+    if (handled) return handled;
+    return res.status(500).json({ ok: false, error: "No se pudo actualizar el supermercado." });
+  }
+});
+
+router.post("/:weekStart/purchased/assign-store", requireAuth, async (req, res) => {
+  try {
+    const weekStart = parseISODate(req.params.weekStart);
+    if (!weekStart) return res.status(400).json({ ok: false, error: "Fecha inválida." });
+
+    const { storeId } = req.body;
+    const effectiveHouseholdId = getEffectiveHouseholdId(req.user);
+    const monday = getWeekStart(weekStart);
+    const list = await ensureShoppingList(monday, effectiveHouseholdId);
+    const validatedStoreId = await validateStoreSelection(storeId, effectiveHouseholdId);
+
+    const today = new Date().toISOString().slice(0, 10);
+    let changed = false;
+    for (const item of list.items) {
+      if (item.status !== "purchased" || item.storeId || !item.purchasedAt) continue;
+      if (toDateGroup(item.purchasedAt) !== today) continue;
+      item.storeId = validatedStoreId;
+      changed = true;
+    }
+
+    if (changed) await list.save();
+
+    const payload = await getShoppingPayload(monday, effectiveHouseholdId);
+    return res.json({ ok: true, updated: changed, ...payload });
+  } catch (error) {
+    const handled = handleHouseholdError(res, error);
+    if (handled) return handled;
+    return res.status(500).json({ ok: false, error: "No se pudo asignar el supermercado." });
+  }
+});
+
+router.post("/stores", requireAuth, async (req, res) => {
+  try {
+    const effectiveHouseholdId = getEffectiveHouseholdId(req.user);
+    const name = String(req.body?.name || "").trim();
+    if (!name) return res.status(400).json({ ok: false, error: "Debes indicar un nombre." });
+    const canonicalName = normalizeStoreName(name);
+
+    const store = await Store.findOneAndUpdate(
+      { scope: "household", householdId: effectiveHouseholdId, canonicalName },
+      { $setOnInsert: { scope: "household", householdId: effectiveHouseholdId, name, canonicalName } },
+      { new: true, upsert: true }
+    );
+
+    return res.status(201).json({ ok: true, store });
+  } catch (error) {
+    const handled = handleHouseholdError(res, error);
+    if (handled) return handled;
+    return res.status(500).json({ ok: false, error: "No se pudo crear la tienda." });
+  }
+});
+
+router.get("/stores/master", requireAuth, requireDiod, async (req, res) => {
+  const stores = sortStores(
+    await Store.find({ scope: "master", householdId: null }).select("_id name canonicalName active order scope")
+  );
+  return res.json({ ok: true, stores });
+});
+
+router.post("/stores/master", requireAuth, requireDiod, async (req, res) => {
+  const name = String(req.body?.name || "").trim();
+  if (!name) return res.status(400).json({ ok: false, error: "Debes indicar un nombre." });
+  const canonicalName = normalizeStoreName(name);
+  const requestedOrder = Number(req.body?.order);
+
+  const store = await Store.findOneAndUpdate(
+    { scope: "master", householdId: null, canonicalName },
+    {
+      $set: {
+        name,
+        canonicalName,
+        active: req.body?.active !== false,
+        order: Number.isFinite(requestedOrder) ? requestedOrder : null,
+        scope: "master",
+        householdId: null
+      }
+    },
+    { new: true, upsert: true }
+  );
+  return res.status(201).json({ ok: true, store });
+});
+
+router.put("/stores/master/:storeId", requireAuth, requireDiod, async (req, res) => {
+  const store = await Store.findOne({ _id: req.params.storeId, scope: "master", householdId: null });
+  if (!store) return res.status(404).json({ ok: false, error: "Supermercado no encontrado." });
+
+  if (req.body?.name !== undefined) {
+    const name = String(req.body.name || "").trim();
+    if (!name) return res.status(400).json({ ok: false, error: "Nombre inválido." });
+    store.name = name;
+    store.canonicalName = normalizeStoreName(name);
+  }
+  if (req.body?.active !== undefined) store.active = Boolean(req.body.active);
+  if (req.body?.order !== undefined) {
+    const requestedOrder = Number(req.body.order);
+    store.order = Number.isFinite(requestedOrder) ? requestedOrder : null;
+  }
+
+  await store.save();
+  return res.json({ ok: true, store });
+});
+
+router.delete("/stores/master/:storeId", requireAuth, requireDiod, async (req, res) => {
+  const store = await Store.findOne({ _id: req.params.storeId, scope: "master", householdId: null });
+  if (!store) return res.status(404).json({ ok: false, error: "Supermercado no encontrado." });
+  store.active = false;
+  await store.save();
+  return res.json({ ok: true, store });
+});
+
+export default router;
diff --git a/backend/src/kitchen/routes/weeks.js b/backend/src/kitchen/routes/weeks.js
index 0f34aa7bec6a0a2a115bb248d438edd242de10dd..f9f97a17d1ab42b6972cc5f1e25cc8c152682878 100644
--- a/backend/src/kitchen/routes/weeks.js
+++ b/backend/src/kitchen/routes/weeks.js
@@ -1,40 +1,78 @@
 import express from "express";
+import mongoose from "mongoose";
 import { KitchenDish } from "../models/KitchenDish.js";
 import { KitchenUser } from "../models/KitchenUser.js";
 import { requireAuth, requireRole } from "../middleware.js";
 import { formatDateISO, getWeekStart, isSameDay, parseISODate } from "../utils/dates.js";
 import {
   buildScopedFilter,
   getEffectiveHouseholdId,
   handleHouseholdError
 } from "../householdScope.js";
 import { createOrGetWeekPlan, ensureWeekPlan, findWeekPlan } from "../weekPlanService.js";
 import { rebuildShoppingList } from "../shoppingService.js";
 
 const router = express.Router();
 
+function logKitchenError(context, error, extra = {}) {
+  console.error(`[kitchen][weeks] ${context}`, {
+    ...extra,
+    message: error?.message,
+    stack: error?.stack
+  });
+}
+
+function validateObjectId(value, fieldName) {
+  if (value === undefined || value === null || value === "") return null;
+  if (!mongoose.isValidObjectId(value)) {
+    return `${fieldName} no es un identificador válido.`;
+  }
+  return null;
+}
+
+function normalizeIngredientOverrides(ingredientOverrides = []) {
+  return ingredientOverrides.map((item) => ({
+    displayName: String(item?.displayName || "").trim(),
+    canonicalName: String(item?.canonicalName || "").trim(),
+    ...(item?.ingredientId ? { ingredientId: item.ingredientId } : {})
+  }));
+}
+
+async function rebuildShoppingListBestEffort({ monday, effectiveHouseholdId, context }) {
+  try {
+    await rebuildShoppingList(monday, effectiveHouseholdId);
+    return null;
+  } catch (error) {
+    logKitchenError(`${context}:rebuild-shopping-list`, error, {
+      weekStart: formatDateISO(monday),
+      householdId: String(effectiveHouseholdId)
+    });
+    return "El plan se guardó, pero no se pudo reconstruir la lista de compra.";
+  }
+}
+
 function isHouseholdAdmin(user) {
   return user?.globalRole === "diod" || user?.role === "owner" || user?.role === "admin";
 }
 
 function isSelfAssignment(req, userId) {
   if (!userId) return false;
   return String(userId) === String(req.kitchenUser?._id);
 }
 
 function hasAdministrativePlanChange(req, day, updates) {
   if (isHouseholdAdmin(req.kitchenUser)) return false;
 
   if (Object.prototype.hasOwnProperty.call(updates, "cookUserId")) {
     const requestedCook = updates.cookUserId || null;
     if (!requestedCook || !isSelfAssignment(req, requestedCook)) {
       return true;
     }
   }
 
   const clearsMainDish = Object.prototype.hasOwnProperty.call(updates, "mainDishId")
     && !updates.mainDishId
     && Boolean(day.mainDishId);
   const clearsSideDish = Object.prototype.hasOwnProperty.call(updates, "sideDishId")
     && !updates.sideDishId
     && Boolean(day.sideDishId);
@@ -54,134 +92,167 @@ router.get("/:weekStart", requireAuth, async (req, res) => {
     res.json({
       ok: true,
       weekStart: formatDateISO(monday),
       plan
     });
   } catch (error) {
     const handled = handleHouseholdError(res, error);
     if (handled) return handled;
     return res.status(500).json({ ok: false, error: "No se pudo cargar el plan semanal." });
   }
 });
 
 router.put("/:weekStart/day/:date", requireAuth, async (req, res) => {
   try {
     const weekStart = parseISODate(req.params.weekStart);
     const date = parseISODate(req.params.date);
     if (!weekStart || !date) return res.status(400).json({ ok: false, error: "Fecha inválida." });
 
     const effectiveHouseholdId = getEffectiveHouseholdId(req.user);
     const monday = getWeekStart(weekStart);
     const plan = await ensureWeekPlan(monday, effectiveHouseholdId);
 
     const day = plan.days.find((item) => isSameDay(item.date, date));
     if (!day) return res.status(404).json({ ok: false, error: "Día fuera de la semana." });
 
-    const { cookUserId, cookTiming, servings, mainDishId, sideDishId, ingredientOverrides } = req.body;
+    const { cookUserId, cookTiming, servings, mainDishId, sideDishId, ingredientOverrides } = req.body;
+
+    const invalidIdMessage =
+      validateObjectId(cookUserId, "cookUserId")
+      || validateObjectId(mainDishId, "mainDishId")
+      || validateObjectId(sideDishId, "sideDishId");
+    if (invalidIdMessage) {
+      return res.status(400).json({ ok: false, error: invalidIdMessage });
+    }
+
+    if (Array.isArray(ingredientOverrides)) {
+      const invalidOverride = ingredientOverrides.find((item) =>
+        item?.ingredientId && !mongoose.isValidObjectId(item.ingredientId)
+      );
+      if (invalidOverride) {
+        return res.status(400).json({ ok: false, error: "Algún ingredientId de ingredientes extra no es válido." });
+      }
+    }
 
     if (hasAdministrativePlanChange(req, day, req.body || {})) {
       return res.status(403).json({
         ok: false,
         error: "Solo owner/admin puede reasignar a otros usuarios o quitar platos del día."
       });
     }
 
     if (cookUserId) {
       const assignedUser = await KitchenUser.findOne(
         buildScopedFilter(effectiveHouseholdId, { _id: cookUserId })
       ).select("_id");
       if (!assignedUser) {
         return res.status(400).json({ ok: false, error: "La persona asignada no pertenece a este hogar." });
       }
     }
 
     if (mainDishId) {
       const mainDish = await KitchenDish.findOne(
         buildScopedFilter(effectiveHouseholdId, { _id: mainDishId, sidedish: { $ne: true } })
       ).select("_id");
       if (!mainDish) {
         return res.status(400).json({ ok: false, error: "El plato principal no pertenece a este hogar." });
       }
     }
 
     if (sideDishId) {
       const sideDish = await KitchenDish.findOne(
         buildScopedFilter(effectiveHouseholdId, { _id: sideDishId, sidedish: true })
       ).select("_id");
       if (!sideDish) {
         return res.status(400).json({ ok: false, error: "La guarnición no pertenece a este hogar." });
       }
     }
 
     if (cookUserId !== undefined) day.cookUserId = cookUserId || null;
     if (cookUserId === undefined && mainDishId && !day.cookUserId) {
       day.cookUserId = req.kitchenUser._id;
     }
     if (cookTiming) day.cookTiming = cookTiming === "same_day" ? "same_day" : "previous_day";
     if (servings) day.servings = Number(servings) || 4;
     if (mainDishId !== undefined) day.mainDishId = mainDishId || null;
     if (sideDishId !== undefined) day.sideDishId = sideDishId || null;
-    if (Array.isArray(ingredientOverrides)) day.ingredientOverrides = ingredientOverrides;
-
-    await plan.save();
-    await rebuildShoppingList(monday, effectiveHouseholdId);
-    return res.json({ ok: true, plan });
-  } catch (error) {
+    if (Array.isArray(ingredientOverrides)) day.ingredientOverrides = normalizeIngredientOverrides(ingredientOverrides);
+
+    await plan.save();
+    const warning = await rebuildShoppingListBestEffort({
+      monday,
+      effectiveHouseholdId,
+      context: "update-day"
+    });
+    return res.json({ ok: true, plan, ...(warning ? { warning } : {}) });
+  } catch (error) {
     const handled = handleHouseholdError(res, error);
     if (handled) return handled;
-    return res.status(500).json({ ok: false, error: "No se pudo actualizar el día del plan." });
-  }
+    logKitchenError("update-day", error, {
+      weekStart: req.params.weekStart,
+      date: req.params.date,
+      userId: String(req.kitchenUser?._id || "")
+    });
+    if (error?.name === "ValidationError" || error?.name === "CastError") {
+      return res.status(400).json({ ok: false, error: "Datos inválidos al actualizar el día del plan." });
+    }
+    return res.status(500).json({ ok: false, error: "No se pudo actualizar el día del plan." });
+  }
 });
 
 router.post("/:weekStart/copy-from/:otherWeekStart", requireAuth, requireRole("admin"), async (req, res) => {
   try {
     const weekStart = parseISODate(req.params.weekStart);
     const otherWeekStart = parseISODate(req.params.otherWeekStart);
     if (!weekStart || !otherWeekStart) {
       return res.status(400).json({ ok: false, error: "Fecha inválida." });
     }
 
     const effectiveHouseholdId = getEffectiveHouseholdId(req.user);
     const monday = getWeekStart(weekStart);
     const sourceMonday = getWeekStart(otherWeekStart);
 
     const sourcePlan = await ensureWeekPlan(sourceMonday, effectiveHouseholdId);
     const targetPlan = await ensureWeekPlan(monday, effectiveHouseholdId);
 
     targetPlan.days = sourcePlan.days.map((day) => ({
       date: new Date(day.date),
       cookUserId: day.cookUserId,
       cookTiming: day.cookTiming,
       servings: day.servings,
       mainDishId: day.mainDishId,
       sideDishId: day.sideDishId,
       ingredientOverrides: day.ingredientOverrides
     }));
 
-    await targetPlan.save();
-    await rebuildShoppingList(monday, effectiveHouseholdId);
-    return res.json({ ok: true, plan: targetPlan });
+    await targetPlan.save();
+    const warning = await rebuildShoppingListBestEffort({
+      monday,
+      effectiveHouseholdId,
+      context: "copy-week"
+    });
+    return res.json({ ok: true, plan: targetPlan, ...(warning ? { warning } : {}) });
   } catch (error) {
     const handled = handleHouseholdError(res, error);
     if (handled) return handled;
     return res.status(500).json({ ok: false, error: "No se pudo copiar el plan semanal." });
   }
 });
 
 router.post("/:weekStart", requireAuth, async (req, res) => {
   try {
     const weekStart = parseISODate(req.params.weekStart);
     if (!weekStart) return res.status(400).json({ ok: false, error: "Fecha de semana inválida." });
 
     const effectiveHouseholdId = getEffectiveHouseholdId(req.user);
     const monday = getWeekStart(weekStart);
     const { plan, created } = await createOrGetWeekPlan(monday, effectiveHouseholdId);
 
     return res.status(created ? 201 : 200).json({
       ok: true,
       weekStart: formatDateISO(monday),
       plan
     });
   } catch (error) {
     const handled = handleHouseholdError(res, error);
     if (handled) return handled;
     if (error?.code === "WEEK_PLAN_INDEX_CONFLICT") {
@@ -214,57 +285,69 @@ router.post("/:weekStart/day/:date/move", requireAuth, async (req, res) => {
     const sourceDay = plan.days.find((item) => isSameDay(item.date, sourceDate));
     const targetDay = plan.days.find((item) => isSameDay(item.date, targetDate));
 
     if (!sourceDay || !targetDay) {
       return res.status(404).json({ ok: false, error: "No encontramos los días de origen o destino en esa semana." });
     }
 
     targetDay.cookUserId = sourceDay.cookUserId || null;
     targetDay.cookTiming = sourceDay.cookTiming || "previous_day";
     targetDay.servings = sourceDay.servings || 4;
     targetDay.mainDishId = sourceDay.mainDishId || null;
     targetDay.sideDishId = sourceDay.sideDishId || null;
     targetDay.ingredientOverrides = Array.isArray(sourceDay.ingredientOverrides)
       ? sourceDay.ingredientOverrides.map((item) => ({
         displayName: item.displayName,
         canonicalName: item.canonicalName,
         ...(item.ingredientId ? { ingredientId: item.ingredientId } : {})
       }))
       : [];
 
     sourceDay.cookUserId = null;
     sourceDay.mainDishId = null;
     sourceDay.sideDishId = null;
     sourceDay.ingredientOverrides = [];
 
-    await plan.save();
-    await rebuildShoppingList(monday, effectiveHouseholdId);
-    return res.json({ ok: true, plan });
-  } catch (error) {
+    await plan.save();
+    const warning = await rebuildShoppingListBestEffort({
+      monday,
+      effectiveHouseholdId,
+      context: "move-day"
+    });
+    return res.json({ ok: true, plan, ...(warning ? { warning } : {}) });
+  } catch (error) {
     const handled = handleHouseholdError(res, error);
     if (handled) return handled;
-    return res.status(500).json({ ok: false, error: "No se pudo mover la asignación de día." });
-  }
-});
+    logKitchenError("move-day", error, {
+      weekStart: req.params.weekStart,
+      date: req.params.date,
+      userId: String(req.kitchenUser?._id || "")
+    });
+    if (error?.name === "ValidationError" || error?.name === "CastError") {
+      return res.status(400).json({ ok: false, error: "Datos inválidos al mover la asignación." });
+    }
+    return res.status(500).json({ ok: false, error: "No se pudo mover la asignación de día." });
+  }
+});
 
 router.get("/:weekStart/summary", requireAuth, async (req, res) => {
   try {
     const weekStart = parseISODate(req.params.weekStart);
     if (!weekStart) return res.status(400).json({ ok: false, error: "Fecha inválida." });
 
     const effectiveHouseholdId = getEffectiveHouseholdId(req.user);
     const monday = getWeekStart(weekStart);
     const plan = await ensureWeekPlan(monday, effectiveHouseholdId);
     const dishIds = plan.days.flatMap((day) => [day.mainDishId, day.sideDishId]).filter(Boolean);
     const dishes = await KitchenDish.find(
       buildScopedFilter(effectiveHouseholdId, { _id: { $in: dishIds } })
     );
 
     res.json({ ok: true, weekStart: formatDateISO(monday), plan, dishes });
   } catch (error) {
     const handled = handleHouseholdError(res, error);
     if (handled) return handled;
     return res.status(500).json({ ok: false, error: "No se pudo cargar el resumen semanal." });
   }
 });
 
 export default router;
diff --git a/backend/src/kitchen/shoppingService.js b/backend/src/kitchen/shoppingService.js
index b0be9e829e7df79c2b191d3399654574d0a19751..3b44702db06f9fdbdc9fd988303cd5bac852cb2c 100644
--- a/backend/src/kitchen/shoppingService.js
+++ b/backend/src/kitchen/shoppingService.js
@@ -1,129 +1,140 @@
 import { KitchenShoppingList } from "./models/KitchenShoppingList.js";
 import { KitchenWeekPlan } from "./models/KitchenWeekPlan.js";
 import { KitchenDish } from "./models/KitchenDish.js";
 import { KitchenIngredient } from "./models/KitchenIngredient.js";
+import { Category } from "./models/Category.js";
 import { buildScopedFilter } from "./householdScope.js";
 import { combineDayIngredients } from "./utils/ingredients.js";
-import { normalizeIngredientName } from "./utils/normalize.js";
-import { CATALOG_SCOPES } from "./utils/catalogScopes.js";
+import { normalizeIngredientName } from "./utils/normalize.js";
+import { CATALOG_SCOPES } from "./utils/catalogScopes.js";
+import { ensureDefaultCategory } from "./utils/categoryMatching.js";
+import mongoose from "mongoose";
 
 const INGREDIENT_SCOPE_PRIORITY = {
   [CATALOG_SCOPES.OVERRIDE]: 0,
   [CATALOG_SCOPES.HOUSEHOLD]: 1,
   [CATALOG_SCOPES.MASTER]: 2
 };
 
 function compareByScopePriority(a, b) {
   const left = INGREDIENT_SCOPE_PRIORITY[a.scope] ?? 99;
   const right = INGREDIENT_SCOPE_PRIORITY[b.scope] ?? 99;
   return left - right;
 }
 
 function buildIngredientVisibilityFilter(effectiveHouseholdId, extraFilter = {}) {
   return {
     ...extraFilter,
     isArchived: { $ne: true },
     $or: [
       { scope: CATALOG_SCOPES.MASTER },
       { scope: CATALOG_SCOPES.HOUSEHOLD, householdId: effectiveHouseholdId },
       { scope: CATALOG_SCOPES.OVERRIDE, householdId: effectiveHouseholdId }
     ]
   };
 }
 
 export async function ensureShoppingList(weekStartDate, effectiveHouseholdId) {
   const existing = await KitchenShoppingList.findOne(
     buildScopedFilter(effectiveHouseholdId, { weekStart: weekStartDate })
   );
   if (existing) return existing;
   return KitchenShoppingList.create({
     weekStart: weekStartDate,
     items: [],
     householdId: effectiveHouseholdId
   });
 }
 
-export async function resolveShoppingItemIngredientData(items, effectiveHouseholdId) {
-  const byId = new Map();
-  const byCanonical = new Map();
+export async function resolveShoppingItemIngredientData(items, effectiveHouseholdId, options = {}) {
+  const fallbackCategoryId = options.fallbackCategoryId || null;
+  const byId = new Map();
+  const byCanonical = new Map();
 
   for (const item of items) {
     if (item?.ingredientId) byId.set(String(item.ingredientId), true);
     const canonical = normalizeIngredientName(item?.canonicalName || item?.displayName || "");
     if (canonical) byCanonical.set(canonical, true);
   }
 
   const ingredientFilters = [];
-  const ids = Array.from(byId.keys());
+  const ids = Array.from(byId.keys()).filter((id) => mongoose.isValidObjectId(id));
   const canonicalNames = Array.from(byCanonical.keys());
   if (ids.length) ingredientFilters.push({ _id: { $in: ids } });
   if (canonicalNames.length) ingredientFilters.push({ canonicalName: { $in: canonicalNames } });
-  if (!ingredientFilters.length) return { changed: false, resolvedItems: items };
+  if (!ingredientFilters.length) {
+    const resolvedWithoutLookup = items.map((item) => {
+      if (item?.categoryId || !fallbackCategoryId) return item;
+      return { ...item, categoryId: fallbackCategoryId };
+    });
+    return { changed: resolvedWithoutLookup.some((item, index) => item !== items[index]), resolvedItems: resolvedWithoutLookup };
+  }
 
   const ingredientDocs = await KitchenIngredient.find(
     buildIngredientVisibilityFilter(effectiveHouseholdId, { $or: ingredientFilters })
   )
     .select("_id canonicalName categoryId name scope")
     .lean();
 
   const sortedIngredients = ingredientDocs.sort(compareByScopePriority);
   const ingredientById = new Map(sortedIngredients.map((doc) => [String(doc._id), doc]));
   const ingredientByCanonical = new Map();
   sortedIngredients.forEach((doc) => {
     if (doc.canonicalName && !ingredientByCanonical.has(doc.canonicalName)) {
       ingredientByCanonical.set(doc.canonicalName, doc);
     }
   });
 
   let changed = false;
   const resolvedItems = items.map((item) => {
     const normalizedCanonical = normalizeIngredientName(item?.canonicalName || item?.displayName || "");
     const byExistingId = item?.ingredientId ? ingredientById.get(String(item.ingredientId)) : null;
     const byName = normalizedCanonical ? ingredientByCanonical.get(normalizedCanonical) : null;
     const resolved = byExistingId || byName || null;
     if (!resolved) return item;
 
     const next = { ...item };
     if (!next.ingredientId || String(next.ingredientId) !== String(resolved._id)) {
       next.ingredientId = resolved._id;
       changed = true;
     }
     if (next.canonicalName !== resolved.canonicalName) {
       next.canonicalName = resolved.canonicalName;
       changed = true;
     }
     if (!next.displayName) {
       next.displayName = resolved.name;
       changed = true;
     }
-    if (!next.categoryId || String(next.categoryId) !== String(resolved.categoryId || "")) {
-      next.categoryId = resolved.categoryId || null;
-      changed = true;
-    }
-    return next;
-  });
+    const resolvedCategoryId = resolved.categoryId || fallbackCategoryId || null;
+    if (!next.categoryId || String(next.categoryId) !== String(resolvedCategoryId || "")) {
+      next.categoryId = resolvedCategoryId;
+      changed = true;
+    }
+    return next;
+  });
 
   return { changed, resolvedItems };
 }
 
 async function buildAggregatedFromWeek(weekStartDate, effectiveHouseholdId) {
   const plan = await KitchenWeekPlan.findOne(
     buildScopedFilter(effectiveHouseholdId, { weekStart: weekStartDate })
   );
   if (!plan) return [];
 
   const dishIds = plan.days.flatMap((day) => [day.mainDishId, day.sideDishId]).filter(Boolean);
   const dishes = await KitchenDish.find(buildScopedFilter(effectiveHouseholdId, { _id: { $in: dishIds } }));
   const dishMap = new Map(dishes.map((dish) => [dish._id.toString(), dish]));
 
   const merged = new Map();
   for (const day of plan.days) {
     const main = day.mainDishId ? dishMap.get(day.mainDishId.toString()) : null;
     const side = day.sideDishId ? dishMap.get(day.sideDishId.toString()) : null;
     const ingredients = combineDayIngredients({
       mainDish: main,
       sideDish: side,
       overrides: day.ingredientOverrides
     });
 
     for (const ingredient of ingredients) {
@@ -131,45 +142,50 @@ async function buildAggregatedFromWeek(weekStartDate, effectiveHouseholdId) {
       const key = ingredient.ingredientId ? String(ingredient.ingredientId) : normalizedCanonical;
       if (!key) continue;
       const current = merged.get(key) || {
         ingredientId: ingredient.ingredientId || null,
         categoryId: null,
         displayName: ingredient.displayName,
         canonicalName: normalizedCanonical,
         quantity: null,
         unit: null,
         occurrences: 0,
         fromDishes: []
       };
 
       current.occurrences += 1;
       const dayDishIds = [day.mainDishId, day.sideDishId].filter(Boolean).map(String);
       current.fromDishes = Array.from(new Set([...current.fromDishes.map(String), ...dayDishIds]));
       merged.set(key, current);
     }
   }
 
   const unresolved = await resolveShoppingItemIngredientData(Array.from(merged.values()), effectiveHouseholdId);
   return unresolved.resolvedItems;
 }
 
 export async function rebuildShoppingList(weekStartDate, effectiveHouseholdId) {
+  const fallbackCategory = await ensureDefaultCategory({ Category, householdId: effectiveHouseholdId });
   const list = await ensureShoppingList(weekStartDate, effectiveHouseholdId);
   const builtItems = await buildAggregatedFromWeek(weekStartDate, effectiveHouseholdId);
+  const resolvedBuiltItems = await resolveShoppingItemIngredientData(builtItems, effectiveHouseholdId, {
+    fallbackCategoryId: fallbackCategory?._id || null
+  });
 
   const previousMap = new Map(list.items.map((item) => [item.ingredientId ? String(item.ingredientId) : item.canonicalName, item]));
-  list.items = builtItems.map((item) => {
+  list.items = resolvedBuiltItems.resolvedItems.map((item) => {
     const previous = previousMap.get(item.ingredientId ? String(item.ingredientId) : item.canonicalName);
     const nextStatus = previous?.status === "purchased" ? "purchased" : "pending";
     return {
       ...item,
+      categoryId: item.categoryId || fallbackCategory?._id || null,
       fromDishes: item.fromDishes,
       status: nextStatus,
       purchasedBy: nextStatus === "purchased" ? previous?.purchasedBy || null : null,
       purchasedAt: nextStatus === "purchased" ? previous?.purchasedAt || null : null,
       storeId: nextStatus === "purchased" ? previous?.storeId || null : null
     };
   });
 
   await list.save();
   return list;
 }
diff --git a/frontend/src/kitchen/kitchen.css b/frontend/src/kitchen/kitchen.css
index 71962815364f401efcef8dc44f61c07de460b6a9..6b7413d6587844f453a0c77c08588548d493ec34 100644
--- a/frontend/src/kitchen/kitchen.css
+++ b/frontend/src/kitchen/kitchen.css
@@ -1,2947 +1,2955 @@
-*,
-*::before,
-*::after {
-  box-sizing: border-box;
-}
-
-html,
-body {
-  width: 100%;
-  max-width: 100%;
-  height: 100%;
-  margin: 0;
-  overflow-x: hidden;
-}
-
-#root {
-  width: 100%;
-  max-width: 100%;
-  height: 100%;
-  overflow-x: hidden;
-}
-
-@media (pointer: coarse) {
-  html,
-  body {
-    overflow: hidden;
-    overscroll-behavior: none;
-  }
-
-  #root {
-    height: 100dvh;
-    overflow-y: auto;
-    overscroll-behavior: none;
-    -webkit-overflow-scrolling: touch;
-    touch-action: pan-y;
-  }
-}
-
-@media (pointer: fine) {
-  body {
-    overflow-y: auto;
-  }
-
-  #root {
-    min-height: 100%;
-  }
-}
-
-:root {
-  color-scheme: light;
-  --hf-bg: #f8fafc;
-  --hf-bg-gradient: linear-gradient(
-    180deg,
-    rgba(238, 242, 255, 0.72) 0%,
-    rgba(240, 253, 244, 0.5) 42%,
-    rgba(248, 250, 252, 0.96) 100%
-  );
-  --hf-surface: #ffffff;
-  --hf-surface-soft: #eef2ff;
-  --hf-surface-mint: #f0fdf4;
-  --hf-surface-peach: #fff7ed;
-  --hf-text: #1e293b;
-  --hf-muted: #667085;
-  --hf-brand: #4338ca;
-  --hf-brand-strong: #4338ca;
-  --hf-border: #e4e7ec;
-  --hf-danger: #b42318;
-  --hf-radius-md: 24px;
-  --hf-radius-lg: 28px;
-  --hf-radius-xl: 32px;
-  --hf-shadow-soft: 0 10px 25px -5px rgba(0, 0, 0, 0.05);
-  --hf-shadow-glass: 0 10px 30px rgba(31, 41, 55, 0.1);
-  --hf-glass: rgba(255, 255, 255, 0.7);
-  --hf-glass-border: rgba(255, 255, 255, 0.9);
-}
-
-.kitchen-app {
-  font-family: "Inter", system-ui, sans-serif;
-  background-color: var(--hf-bg);
-  background-image: var(--hf-bg-gradient);
-  background-repeat: no-repeat;
-  background-size: 100% 100%;
-  min-height: 100vh;
-  min-height: 100dvh;
-  width: 100%;
-  max-width: 100%;
-  color: var(--hf-text);
-}
-
-@media (min-width: 768px) {
-  :root {
-    --hf-bg-gradient: linear-gradient(
-      180deg,
-      rgba(238, 242, 255, 0.66) 0%,
-      rgba(240, 253, 244, 0.44) 46%,
-      rgba(248, 250, 252, 0.98) 100%
-    );
-  }
-}
-
-@media (min-width: 1200px) {
-  :root {
-    --hf-bg-gradient: linear-gradient(
-      180deg,
-      rgba(238, 242, 255, 0.58) 0%,
-      rgba(240, 253, 244, 0.38) 50%,
-      rgba(248, 250, 252, 1) 100%
-    );
-  }
-}
-
-.kitchen-container {
-  max-width: 1100px;
-  margin: 0 auto;
-  padding: 24px;
-  width: 100%;
-}
-
-.kitchen-bottom-nav {
-  position: fixed;
-  bottom: 0;
-  left: 0;
-  right: 0;
-  background: #ffffff;
-  border-top: 1px solid #e4e7ec;
-  z-index: 25;
-  padding: 10px 12px calc(12px + env(safe-area-inset-bottom, 0px));
-  display: none;
-}
-
-.kitchen-bottom-nav-inner {
-  max-width: 720px;
-  margin: 0 auto;
-  display: grid;
-  grid-template-columns: repeat(4, minmax(0, 1fr));
-  gap: 8px;
-}
-
-.kitchen-bottom-nav-item {
-  display: flex;
-  flex-direction: column;
-  align-items: center;
-  gap: 4px;
-  padding: 8px 6px;
-  border-radius: 14px;
-  text-decoration: none;
-  color: #667085;
-  font-weight: 600;
-  font-size: 12px;
-  line-height: 1.1;
-  transition: background 0.2s ease, color 0.2s ease, transform 0.2s ease;
-}
-
-.kitchen-bottom-nav-item.active {
-  background: #eef2ff;
-  color: #4338ca;
-}
-
-.kitchen-bottom-nav-item:active {
-  transform: translateY(1px);
-}
-
-.kitchen-bottom-nav-icon {
-  width: 22px;
-  height: 22px;
-  stroke: currentColor;
-  stroke-width: 1.8;
-  fill: none;
-  stroke-linecap: round;
-  stroke-linejoin: round;
-}
-
-.kitchen-bottom-nav-label {
-  font-size: 12px;
-  text-align: center;
-  white-space: nowrap;
-}
-
-.kitchen-topbar {
-  position: sticky;
-  top: 0;
-  z-index: 20;
-  background: white;
-  border-bottom: 1px solid #e4e7ec;
-}
-
-.kitchen-topbar-inner {
-  max-width: 1100px;
-  margin: 0 auto;
-  padding: 16px 24px;
-  display: flex;
-  align-items: center;
-  justify-content: space-between;
-  gap: 16px;
-  min-height: 72px;
-}
-
-.kitchen-brand {
-  display: flex;
-  align-items: center;
-  gap: 12px;
-}
-
-.kitchen-brand-link {
-  display: inline-flex;
-  align-items: center;
-  font-weight: 700;
-  font-size: 20px;
-  color: #101828;
-  text-decoration: none;
-}
-
-.kitchen-brand-icon {
-  width: 30px;
-  height: 30px;
-  object-fit: contain;
-}
-
-.kitchen-brand-logo {
-  display: none;
-  height: 30px;
-  width: auto;
-  object-fit: contain;
-}
-
-.kitchen-nav-desktop,
-.kitchen-nav-mobile {
-  display: flex;
-  gap: 16px;
-}
-
-.kitchen-nav-desktop a,
-.kitchen-nav-mobile a {
-  text-decoration: none;
-  color: #1d2939;
-  font-weight: 600;
-  font-size: 14px;
-  padding: 6px 8px;
-  border-radius: 8px;
-}
-
-.kitchen-nav-desktop a.active,
-.kitchen-nav-mobile a.active {
-  background: #eef2ff;
-  color: #3730a3;
-}
-
-.kitchen-user {
-  display: flex;
-  align-items: center;
-  gap: 10px;
-}
-
-.kitchen-user-name {
-  font-size: 14px;
-  font-weight: 600;
-  color: #1d2939;
-}
-
-.kitchen-logout-button {
-  width: 44px;
-  height: 44px;
-  display: inline-flex;
-  align-items: center;
-  justify-content: center;
-  border-radius: 12px;
-  border: 1px solid transparent;
-  background: transparent;
-  color: #475467;
-  cursor: pointer;
-  transition: background 0.2s ease, color 0.2s ease, border-color 0.2s ease;
-}
-
-.kitchen-logout-button:hover {
-  background: #f2f4f7;
-  color: #111827;
-}
-
-.kitchen-logout-button:focus-visible {
-  outline: 2px solid #6366f1;
-  outline-offset: 2px;
-}
-
-.kitchen-logout-icon {
-  width: 20px;
-  height: 20px;
-  stroke: currentColor;
-  stroke-width: 1.8;
-  fill: none;
-  stroke-linecap: round;
-  stroke-linejoin: round;
-}
-
-.kitchen-user-placeholder {
-  width: 160px;
-  min-height: 40px;
-}
-
-.kitchen-nav-toggle {
-  display: none;
-  flex-direction: column;
-  justify-content: center;
-  gap: 4px;
-  width: 36px;
-  height: 36px;
-  border-radius: 10px;
-  border: 1px solid #d0d5dd;
-  background: white;
-  cursor: pointer;
-  padding: 8px;
-}
-
-.kitchen-nav-toggle span {
-  display: block;
-  height: 2px;
-  background: #1d2939;
-  border-radius: 999px;
-}
-
-.kitchen-drawer-backdrop {
-  position: fixed;
-  inset: 0;
-  background: rgba(16, 24, 40, 0.4);
-  border: none;
-  z-index: 30;
-}
-
-.kitchen-drawer {
-  position: fixed;
-  top: 0;
-  left: 0;
-  width: min(300px, 80vw);
-  height: 100%;
-  background: white;
-  z-index: 31;
-  padding: 20px;
-  display: flex;
-  flex-direction: column;
-  gap: 16px;
-  box-shadow: 0 20px 40px rgba(15, 23, 42, 0.2);
-}
-
-.kitchen-drawer-header {
-  display: flex;
-  align-items: center;
-  justify-content: space-between;
-  font-weight: 600;
-}
-
-.kitchen-drawer-close {
-  border: none;
-  background: transparent;
-  color: #1d2939;
-  font-weight: 600;
-  cursor: pointer;
-}
-
-.kitchen-nav-mobile {
-  flex-direction: column;
-  gap: 8px;
-}
-
-.kitchen-drawer-user {
-  display: flex;
-  flex-direction: column;
-  gap: 12px;
-}
-
-.kitchen-card {
-  background: white;
-  border-radius: 16px;
-  padding: 24px;
-  box-shadow: 0 10px 30px rgba(15, 23, 42, 0.08);
-  display: flex;
-  flex-direction: column;
-  gap: 16px;
-  box-sizing: border-box;
-  min-width: 0;
-}
-
-.kitchen-grid {
-  display: grid;
-  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
-  gap: 20px;
-  align-items: stretch;
-}
-
-.kitchen-week-carousel {
-  position: relative;
-}
-
-.kitchen-week-days {
-  display: grid;
-  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
-  gap: 20px;
-  align-items: stretch;
-}
-
-.kitchen-week-carousel-arrow {
-  position: absolute;
-  top: 50%;
-  transform: translateY(-50%);
-  border: 1px solid #e2e8f0;
-  background: #fff;
-  color: #1f2937;
-  width: 36px;
-  height: 36px;
-  border-radius: 999px;
-  display: flex;
-  align-items: center;
-  justify-content: center;
-  box-shadow: 0 6px 16px rgba(15, 23, 42, 0.12);
-  cursor: pointer;
-  z-index: 2;
-}
-
-.kitchen-week-carousel-arrow.is-left {
-  left: -6px;
-}
-
-.kitchen-week-carousel-arrow.is-right {
-  right: -6px;
-}
-
-.kitchen-week-carousel-arrow-icon {
-  width: 18px;
-  height: 18px;
-  stroke: currentColor;
-  stroke-width: 2;
-  fill: none;
-}
-
-.kitchen-week-carousel-arrow-icon.is-next {
-  transform: rotate(180deg);
-}
-
-.kitchen-week-carousel-dots {
-  display: none;
-  justify-content: center;
-  gap: 6px;
-  margin-top: 12px;
-}
-
-.kitchen-week-carousel-dot {
-  width: 8px;
-  height: 8px;
-  border-radius: 999px;
-  border: none;
-  padding: 0;
-  background: #d0d5dd;
-}
-
-.kitchen-week-carousel-dot.is-active {
-  background: #6366f1;
-}
-
-.kitchen-dishes-page {
-  display: flex;
-  flex-direction: column;
-  gap: 20px;
-}
-
-.kitchen-dishes-header {
-  display: flex;
-  flex-wrap: wrap;
-  gap: 16px;
-  align-items: center;
-  justify-content: space-between;
-}
-
-.kitchen-dishes-header h2 {
-  margin: 0;
-  font-size: 24px;
-}
-
-.kitchen-dishes-header .kitchen-muted {
-  margin-top: 4px;
-}
-
-.kitchen-dishes-search {
-  display: flex;
-}
-
-.kitchen-dishes-tabs {
-  display: inline-flex;
-  gap: 8px;
-  padding: 6px;
-  border-radius: 12px;
-  background: #f1f5f9;
-  align-self: flex-start;
-}
-
-.kitchen-tab-button {
-  border: none;
-  background: transparent;
-  padding: 8px 16px;
-  border-radius: 10px;
-  font-weight: 600;
-  color: #475569;
-  cursor: pointer;
-  transition: background 0.2s ease, color 0.2s ease, box-shadow 0.2s ease;
-}
-
-.kitchen-tab-button.is-active {
-  background: white;
-  color: #1e293b;
-  box-shadow: 0 4px 12px rgba(15, 23, 42, 0.12);
-}
-
-.kitchen-tab-button:focus-visible {
-  outline: 3px solid rgba(79, 70, 229, 0.35);
-  outline-offset: 2px;
-}
-
-.kitchen-dishes-grid {
-  display: grid;
-  grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
-  gap: 16px;
-}
-
-.kitchen-dish-card {
-  background: white;
-  border-radius: 14px;
-  padding: 16px;
-  box-shadow: 0 6px 20px rgba(15, 23, 42, 0.08);
-  display: flex;
-  align-items: flex-start;
-  justify-content: space-between;
-  gap: 16px;
-  min-height: 96px;
-}
-
-.kitchen-dish-card.is-sidedish {
-  background: #f8fafc;
-  border: 1px solid #e2e8f0;
-}
-
-.kitchen-dish-title-row {
-  display: flex;
-  flex-wrap: wrap;
-  align-items: center;
-  gap: 8px;
-}
-
-.kitchen-dish-name {
-  margin: 0 0 6px;
-  font-size: 16px;
-}
-
-.kitchen-dish-badge {
-  display: inline-flex;
-  align-items: center;
-  padding: 2px 10px;
-  border-radius: 999px;
-  font-size: 11px;
-  font-weight: 600;
-  color: #1d4ed8;
-  background: #dbeafe;
-}
-
-.kitchen-dish-ingredients-text {
-  margin: 0;
-  color: #667085;
-  font-size: 13px;
-  line-height: 1.4;
-  display: -webkit-box;
-  -webkit-line-clamp: 2;
-  -webkit-box-orient: vertical;
-  overflow: hidden;
-}
-
-.kitchen-ingredient-card {
-  gap: 12px;
-}
-
-.kitchen-ingredient-canonical {
-  margin: 6px 0 0;
-  color: #667085;
-  font-size: 13px;
-}
-
-.kitchen-ingredient-tags {
-  display: flex;
-  flex-wrap: wrap;
-  gap: 8px;
-  margin-top: 8px;
-}
-
-.kitchen-ingredient-selected-category {
-  display: flex;
-  align-items: center;
-  gap: 8px;
-  margin-top: 8px;
-}
-
-.kitchen-dish-actions {
-  display: flex;
-  gap: 8px;
-  align-items: center;
-}
-
-.kitchen-icon-button {
-  border: 1px solid #e2e8f0;
-  background: white;
-  width: 44px;
-  height: 44px;
-  border-radius: 12px;
-  display: inline-flex;
-  align-items: center;
-  justify-content: center;
-  color: #344054;
-  cursor: pointer;
-  transition: border 0.2s ease, color 0.2s ease, box-shadow 0.2s ease;
-}
-
-.kitchen-icon-button svg {
-  width: 20px;
-  height: 20px;
-}
-
-.kitchen-icon-button:hover {
-  border-color: #c7d2fe;
-  color: #4f46e5;
-  box-shadow: 0 6px 12px rgba(79, 70, 229, 0.15);
-}
-
-.kitchen-icon-button.assign:hover {
-  border-color: #bbf7d0;
-  color: #15803d;
-  box-shadow: 0 6px 12px rgba(21, 128, 61, 0.12);
-}
-
-.kitchen-icon-button.danger:hover {
-  border-color: #fecaca;
-  color: #b42318;
-  box-shadow: 0 6px 12px rgba(180, 35, 24, 0.15);
-}
-
-.kitchen-modal-backdrop {
-  position: fixed;
-  inset: 0;
-  background: rgba(15, 23, 42, 0.4);
-  display: flex;
-  align-items: center;
-  justify-content: center;
-  padding: 20px;
-  z-index: 40;
-}
-
-.kitchen-modal {
-  width: min(640px, 100%);
-  max-height: min(90vh, 780px);
-  background: white;
-  border-radius: 18px;
-  padding: 24px;
-  box-shadow: 0 24px 60px rgba(15, 23, 42, 0.2);
-  display: flex;
-  flex-direction: column;
-  gap: 20px;
-  overflow: hidden;
-}
-
-.kitchen-modal .kitchen-form {
-  overflow-y: auto;
-  padding-right: 4px;
-}
-
-.kitchen-modal-header {
-  display: flex;
-  align-items: flex-start;
-  justify-content: space-between;
-  gap: 12px;
-}
-
-.kitchen-modal-header h3 {
-  margin: 0;
-  font-size: 20px;
-}
-
-.kitchen-modal-actions {
-  display: flex;
-  flex-direction: column;
-  gap: 12px;
-  align-items: center;
-  justify-content: center;
-  padding-top: 4px;
-}
-
-.kitchen-assign-modal .kitchen-modal-header p {
-  margin: 6px 0 0;
-}
-
-.kitchen-assign-body {
-  display: flex;
-  flex-direction: column;
-  gap: 16px;
-}
-
-.kitchen-assign-week-header {
-  display: grid;
-  grid-template-columns: 40px 1fr 40px;
-  align-items: center;
-  gap: 12px;
-  width: 100%;
-}
-
-.kitchen-assign-week-label {
-  text-align: center;
-  font-size: 13px;
-  font-weight: 600;
-  color: #0f172a;
-}
-
-.kitchen-assign-week-nav {
-  border: 1px solid #e2e8f0;
-  background: #ffffff;
-  color: #475569;
-  width: 40px;
-  height: 40px;
-  border-radius: 10px;
-  display: inline-flex;
-  align-items: center;
-  justify-content: center;
-  cursor: pointer;
-  transition: border-color 0.2s ease, background 0.2s ease, color 0.2s ease;
-}
-
-.kitchen-assign-week-nav:disabled {
-  cursor: not-allowed;
-  opacity: 0.45;
-}
-
-.kitchen-assign-week-icon {
-  width: 16px;
-  height: 16px;
-  stroke: currentColor;
-  stroke-width: 2;
-  fill: none;
-  stroke-linecap: round;
-  stroke-linejoin: round;
-}
-
-.kitchen-assign-week-icon.is-next {
-  transform: rotate(180deg);
-}
-
-.kitchen-assign-days {
-  display: grid;
-  grid-template-columns: repeat(7, minmax(0, 1fr));
-  gap: 8px;
-}
-
-.kitchen-assign-day {
-  border: 1px solid #e2e8f0;
-  background: #f8fafc;
-  border-radius: 12px;
-  padding: 10px 6px;
-  display: flex;
-  flex-direction: column;
-  align-items: center;
-  gap: 4px;
-  font-size: 12px;
-  color: #0f172a;
-  cursor: pointer;
-  transition: border-color 0.2s ease, background 0.2s ease, color 0.2s ease;
-}
-
-.kitchen-assign-day.is-selected {
-  border-color: #4f46e5;
-  background: #eef2ff;
-  color: #312e81;
-  box-shadow: 0 8px 16px rgba(79, 70, 229, 0.12);
-}
-
-.kitchen-assign-day.is-occupied {
-  border-color: #cbd5f5;
-}
-
-.kitchen-assign-day:disabled {
-  opacity: 0.45;
-  cursor: not-allowed;
-  background: #f1f5f9;
-}
-
-.kitchen-assign-day-label {
-  font-size: 11px;
-  text-transform: uppercase;
-  letter-spacing: 0.08em;
-}
-
-.kitchen-assign-day-number {
-  font-size: 15px;
-  font-weight: 700;
-}
-
-.kitchen-assign-day-status {
-  font-size: 10px;
-  text-transform: uppercase;
-  letter-spacing: 0.08em;
-  color: #64748b;
-  text-align: center;
-}
-
-.kitchen-assign-day-detail {
-  display: block;
-  font-size: 11px;
-  letter-spacing: normal;
-  text-transform: none;
-  color: #475569;
-}
-
-.kitchen-dishes-loading {
-  font-weight: 600;
-  text-align: center;
-}
-
-.kitchen-button {
-  background: #4f46e5;
-  border: none;
-  color: white;
-  padding: 12px 18px;
-  border-radius: 10px;
-  cursor: pointer;
-  font-weight: 600;
-  font-size: 15px;
-  min-height: 48px;
-  transition: background 0.2s ease, transform 0.2s ease, box-shadow 0.2s ease;
-}
-
-.kitchen-button.is-small {
-  padding: 6px 12px;
-  font-size: 13px;
-  min-height: 32px;
-}
-
-.kitchen-button:hover {
-  background: #4338ca;
-}
-
-.kitchen-button:active {
-  transform: translateY(1px);
-}
-
-.kitchen-button:focus-visible {
-  outline: 3px solid rgba(79, 70, 229, 0.35);
-  outline-offset: 2px;
-}
-
-.kitchen-button.secondary {
-  background: #e2e8f0;
-  color: #0f172a;
-}
-
-.kitchen-button.ghost {
-  background: transparent;
-  border: 1px solid #cbd5f5;
-  color: #1e293b;
-}
-
-.kitchen-input,
-.kitchen-select,
-.kitchen-textarea {
-  width: 100%;
-  padding: 10px 12px;
-  border-radius: 10px;
-  border: 1px solid #d0d5dd;
-  background: white;
-  font-size: 14px;
-  box-sizing: border-box;
-  min-width: 0;
-}
-
-.kitchen-label {
-  display: block;
-  font-weight: 600;
-  margin-bottom: 6px;
-  color: #344054;
-}
-
-.kitchen-field {
-  display: flex;
-  flex-direction: column;
-  gap: 6px;
-}
-
-.kitchen-toggle-field {
-  gap: 0;
-}
-
-.kitchen-toggle-row {
-  display: flex;
-  align-items: center;
-  justify-content: space-between;
-  gap: 12px;
-}
-
-.kitchen-toggle {
-  position: relative;
-  display: inline-flex;
-  align-items: center;
-}
-
-.kitchen-toggle-input {
-  position: absolute;
-  opacity: 0;
-  width: 0;
-  height: 0;
-}
-
-.kitchen-toggle-track {
-  width: 46px;
-  height: 26px;
-  border-radius: 999px;
-  background: #e4e7ec;
-  position: relative;
-  transition: background 0.2s ease;
-}
-
-.kitchen-toggle-track::after {
-  content: "";
-  position: absolute;
-  top: 3px;
-  left: 3px;
-  width: 20px;
-  height: 20px;
-  border-radius: 50%;
-  background: #ffffff;
-  box-shadow: 0 2px 6px rgba(15, 23, 42, 0.2);
-  transition: transform 0.2s ease;
-}
-
-.kitchen-toggle-input:checked + .kitchen-toggle-track {
-  background: #4f46e5;
-}
-
-.kitchen-toggle-input:checked + .kitchen-toggle-track::after {
-  transform: translateX(20px);
-}
-
-.kitchen-toggle-input:focus-visible + .kitchen-toggle-track {
-  outline: 3px solid rgba(79, 70, 229, 0.35);
-  outline-offset: 2px;
-}
-
-.kitchen-pill {
-  display: inline-flex;
-  align-items: center;
-  gap: 6px;
-  padding: 4px 10px;
-  border-radius: 999px;
-  background: #eef2ff;
-  color: #4338ca;
-  font-size: 12px;
-  font-weight: 600;
-}
-
-.kitchen-empty {
-  text-align: center;
-  padding: 32px;
-  color: #475467;
-}
-
-.kitchen-muted {
-  color: #667085;
-  font-size: 14px;
-}
-
-.kitchen-actions {
-  display: flex;
-  flex-direction: column;
-  gap: 12px;
-  margin-top: 20px;
-  width: 100%;
-}
-
-.kitchen-actions-inline {
-  display: flex;
-  gap: 8px;
-  align-items: center;
-}
-
-.kitchen-actions-inline .kitchen-select {
-  flex: 1;
-}
-
-.kitchen-assignee-picker {
-  position: relative;
-  display: flex;
-  flex-direction: column;
-  gap: 6px;
-}
-
-.kitchen-assignee-button {
-  width: 100%;
-  border: 1px solid #d0d5dd;
-  border-radius: 12px;
-  background: #ffffff;
-  padding: 8px 12px;
-  display: inline-flex;
-  align-items: center;
-  gap: 10px;
-  font-size: 14px;
-  font-weight: 600;
-  color: #101828;
-  min-height: 48px;
-  cursor: pointer;
-  transition: border 0.2s ease, box-shadow 0.2s ease;
-}
-
-.kitchen-assignee-button:hover {
-  border-color: #c7d2fe;
-}
-
-.kitchen-assignee-button:focus-visible {
-  outline: 3px solid rgba(79, 70, 229, 0.35);
-  outline-offset: 2px;
-}
-
-.kitchen-assignee-avatar {
-  width: 28px;
-  height: 28px;
-  border-radius: 50%;
-  display: inline-flex;
-  align-items: center;
-  justify-content: center;
-  font-size: 12px;
-  font-weight: 700;
-}
-
-.kitchen-assignee-name {
-  flex: 1;
-  text-align: left;
-}
-
-.kitchen-week-header {
-  display: flex;
-  align-items: flex-start;
-  justify-content: center;
-  gap: 16px;
-  margin-bottom: 20px;
-}
-
-.kitchen-week-header-main {
-  display: flex;
-  flex-direction: column;
-  gap: 4px;
-}
-
-.kitchen-week-header-actions {
-  display: flex;
-  flex-direction: column;
-  gap: 12px;
-  width: min(420px, 100%);
-  align-items: center;
-}
-
-.kitchen-week-mobile-frame {
-  width: 100%;
-  display: flex;
-  flex-direction: column;
-  align-items: stretch;
-}
-
-.kitchen-week-nav {
-  display: grid;
-  grid-template-columns: 44px minmax(200px, 260px) 44px;
-  align-items: center;
-  justify-content: center;
-  gap: 12px;
-  width: 100%;
-}
-
-.kitchen-week-picker {
-  width: 100%;
-  display: flex;
-  align-items: center;
-  justify-content: center;
-}
-
-.kitchen-week-arrow {
-  display: inline-flex;
-  align-items: center;
-  justify-content: center;
-  width: 44px;
-  height: 44px;
-  border-radius: 12px;
-  border: 1px solid #d0d5dd;
-  background: #ffffff;
-  color: #344054;
-  cursor: pointer;
-  transition: background 0.2s ease, border-color 0.2s ease, color 0.2s ease;
-}
-
-.kitchen-week-picker .kitchen-input {
-  min-height: 44px;
-  height: 44px;
-  text-align: center;
-  width: 100%;
-}
-
-.kitchen-week-arrow-icon {
-  width: 18px;
-  height: 18px;
-  stroke: currentColor;
-  stroke-width: 2;
-  fill: none;
-  stroke-linecap: round;
-  stroke-linejoin: round;
-}
-
-.kitchen-week-arrow-icon.is-next {
-  transform: rotate(180deg);
-}
-
-.kitchen-week-arrow:hover {
-  background: #f8fafc;
-  border-color: #c7ced6;
-  color: #1d2939;
-}
-
-.kitchen-week-arrow:focus-visible {
-  outline: 2px solid #6366f1;
-  outline-offset: 2px;
-}
-
-.kitchen-title {
-  margin: 0;
-  font-size: 22px;
-  font-weight: 700;
-  color: #0f172a;
-}
-
-.kitchen-week-subtitle {
-  margin: 0;
-}
-
-.kitchen-weekdays-strip {
-  padding: 20px 22px;
-  border: 1px solid #eaecf0;
-  box-shadow: none;
-  gap: 16px;
-  margin-bottom: 0;
-}
-
-.kitchen-week-controls {
-  display: flex;
-  flex-direction: column;
-  gap: 20px;
-  margin-bottom: 24px;
-}
-
-.kitchen-weekdays-carousel {
-  position: relative;
-  display: flex;
-  align-items: center;
-  width: 100%;
-  max-width: 100%;
-}
-
-.kitchen-weekdays-carousel.is-carousel::before,
-.kitchen-weekdays-carousel.is-carousel::after {
-  content: "";
-  position: absolute;
-  top: 0;
-  bottom: 0;
-  width: 32px;
-  pointer-events: none;
-  z-index: 1;
-}
-
-.kitchen-weekdays-carousel.is-carousel::before {
-  left: 0;
-  background: linear-gradient(90deg, #ffffff 0%, rgba(255, 255, 255, 0) 100%);
-}
-
-.kitchen-weekdays-carousel.is-carousel::after {
-  right: 0;
-  background: linear-gradient(270deg, #ffffff 0%, rgba(255, 255, 255, 0) 100%);
-}
-
-.kitchen-weekdays-arrow {
-  width: 40px;
-  height: 40px;
-  border-radius: 12px;
-  border: 1px solid #e4e7ec;
-  background: #ffffff;
-  color: #344054;
-  display: inline-flex;
-  align-items: center;
-  justify-content: center;
-  cursor: pointer;
-  transition: border-color 0.2s ease, background 0.2s ease;
-  position: absolute;
-  top: 50%;
-  transform: translateY(-50%);
-  z-index: 2;
-}
-
-.kitchen-weekdays-arrow:hover {
-  background: #f8fafc;
-  border-color: #d0d5dd;
-}
-
-.kitchen-weekdays-arrow.is-left {
-  left: -8px;
-}
-
-.kitchen-weekdays-arrow.is-right {
-  right: -8px;
-}
-
-.kitchen-weekdays-arrow-icon {
-  width: 18px;
-  height: 18px;
-  stroke: currentColor;
-  stroke-width: 2;
-  fill: none;
-  stroke-linecap: round;
-  stroke-linejoin: round;
-}
-
-.kitchen-weekdays-arrow-icon.is-next {
-  transform: rotate(180deg);
-}
-
-.kitchen-weekdays-list {
-  display: flex;
-  gap: 12px;
-  align-items: center;
-  justify-content: center;
-  width: 100%;
-  padding-bottom: 4px;
-}
-
-.kitchen-weekdays-list.is-carousel {
-  overflow-x: auto;
-  scroll-snap-type: x mandatory;
-  -webkit-overflow-scrolling: touch;
-  scrollbar-width: none;
-  justify-content: flex-start;
-  padding: 4px 32px;
-  max-width: 100%;
-}
-
-.kitchen-weekdays-list.is-carousel::-webkit-scrollbar {
-  display: none;
-}
-
-.kitchen-weekdays-item {
-  min-width: 64px;
-  min-height: 80px;
-  padding: 8px 6px;
-  border-radius: 14px;
-  border: 1px solid transparent;
-  background: transparent;
-  display: flex;
-  flex-direction: column;
-  align-items: center;
-  gap: 6px;
-  cursor: pointer;
-  scroll-snap-align: center;
-  transition: border-color 0.2s ease, background 0.2s ease, transform 0.2s ease;
-}
-
-.kitchen-weekdays-item:focus-visible {
-  outline: 2px solid #6366f1;
-  outline-offset: 2px;
-}
-
-.kitchen-weekdays-item.is-selected {
-  border-color: #c7d2fe;
-  background: #f8f9ff;
-}
-
-.kitchen-weekdays-circle {
-  width: 52px;
-  height: 52px;
-  border-radius: 999px;
-  display: flex;
-  align-items: center;
-  justify-content: center;
-  font-weight: 700;
-  font-size: 14px;
-  letter-spacing: 0.04em;
-  text-transform: uppercase;
-  background: var(--weekday-bg);
-  color: var(--weekday-text);
-  border: 1px solid var(--weekday-border);
-  box-sizing: border-box;
-}
-
-.kitchen-weekdays-label {
-  font-size: 12px;
-  font-weight: 600;
-  color: #475467;
-  text-transform: uppercase;
-}
-
-.kitchen-day-card {
-  min-height: 100%;
-}
-
-.kitchen-day-card.is-empty {
-  min-height: auto;
-  background: #f8f9ff;
-  border: 1px solid #e4e7ff;
-  box-shadow: 0 10px 30px rgba(99, 102, 241, 0.06);
-}
-
-.kitchen-day-card.is-selected {
-  border: 1px solid #c7d2fe;
-  box-shadow: 0 0 0 1px rgba(99, 102, 241, 0.05);
-}
-
-.kitchen-day-header {
-  display: flex;
-  flex-direction: column;
-  gap: 6px;
-}
-
-.kitchen-day-cta {
-  display: flex;
-  justify-content: flex-end;
-  align-items: center;
-  gap: 8px;
-}
-
-.kitchen-day-edit-actions {
-  display: inline-flex;
-  gap: 8px;
-}
-
-.kitchen-day-title {
-  margin: 0;
-  font-size: 18px;
-  font-weight: 700;
-  text-transform: capitalize;
-}
-
-.kitchen-day-meta {
-  display: flex;
-  flex-direction: column;
-  gap: 4px;
-  font-size: 13px;
-  color: #667085;
-}
-
-.kitchen-day-status {
-  display: flex;
-  flex-wrap: wrap;
-  gap: 6px;
-}
-
-.kitchen-day-view {
-  display: flex;
-  flex-direction: column;
-  gap: 12px;
-}
-
-.kitchen-day-empty {
-  display: flex;
-  flex-direction: column;
-  flex: 1;
-  min-height: 120px;
-}
-
-.kitchen-day-empty-spacer {
-  flex: 1;
-}
-
-.kitchen-day-empty-button {
-  margin-top: auto;
-  align-self: center;
-  width: 100%;
-}
-
-.kitchen-day-info {
-  display: flex;
-  flex-direction: column;
-  gap: 4px;
-}
-
-.kitchen-day-info-label {
-  font-size: 12px;
-  color: #667085;
-  font-weight: 600;
-  text-transform: uppercase;
-  letter-spacing: 0.04em;
-}
-
-.kitchen-day-info-value {
-  font-size: 16px;
-  font-weight: 600;
-  color: #101828;
-}
-
-.kitchen-day-ingredients {
-  display: flex;
-  flex-direction: column;
-  gap: 6px;
-}
-
-.kitchen-day-ingredient-pills {
-  display: flex;
-  flex-wrap: wrap;
-  gap: 8px;
-}
-
-.kitchen-ingredient-pill {
-  display: inline-flex;
-  align-items: center;
-  gap: 6px;
-  padding: 4px 10px;
-  border-radius: 999px;
-  font-size: 12px;
-  font-weight: 600;
-  background: #f8fafc;
-  border: 1px solid #e2e8f0;
-  color: #1f2937;
-}
-
-.kitchen-ingredient-pill.is-extra {
-  background: #fef3f2;
-  border-color: #fecaca;
-  color: #991b1b;
-}
-
-.kitchen-status-pill {
-  display: inline-flex;
-  align-items: center;
-  padding: 2px 8px;
-  border-radius: 999px;
-  font-size: 11px;
-  font-weight: 600;
-  letter-spacing: 0.01em;
-  border: 1px solid transparent;
-  color: #344054;
-  background: #f2f4f7;
-}
-
-.kitchen-status-pill.assigned {
-  color: #1d4ed8;
-  background: #eff6ff;
-  border-color: #dbeafe;
-}
-
-.kitchen-status-pill.planned {
-  color: #1f2937;
-  background: #f8fafc;
-  border-color: #e2e8f0;
-}
-
-.kitchen-status-pill.active {
-  color: #027a48;
-  background: #ecfdf3;
-  border-color: #abefc6;
-}
-
-.kitchen-status-pill.inactive {
-  color: #b42318;
-  background: #fef3f2;
-  border-color: #fecaca;
-}
-
-.kitchen-inline-error {
-  margin: 4px 0 0;
-  font-size: 13px;
-  color: #b42318;
-}
-
-.kitchen-inline-warning {
-  padding: 10px 12px;
-  border-radius: 12px;
-  border: 1px solid #f9dbaf;
-  background: #fff7ed;
-  color: #9a3412;
-  font-weight: 600;
-  font-size: 14px;
-}
-
-.kitchen-ingredient-picker {
-  display: flex;
-  flex-direction: column;
-  gap: 16px;
-}
-
-.kitchen-ingredient-picker .kitchen-input {
-  font-size: 16px;
-  padding: 12px 14px;
-  border-radius: 14px;
-}
-
-.kitchen-ingredient-search {
-  gap: 8px;
-}
-
-.kitchen-chip-list {
-  display: flex;
-  flex-wrap: wrap;
-  gap: 10px 12px;
-  align-items: center;
-  margin-bottom: 8px;
-}
-
-.kitchen-chip-item {
-  display: inline-flex;
-  align-items: center;
-  gap: 8px;
-}
-
-.kitchen-chip {
-  display: inline-flex;
-  align-items: center;
-  gap: 8px;
-  padding: 8px 12px;
-  border-radius: 999px;
-  font-size: 15px;
-  font-weight: 600;
-  border: 1px solid transparent;
-  box-shadow: 0 6px 16px rgba(15, 23, 42, 0.08);
-}
-
-.kitchen-chip-label {
-  line-height: 1.2;
-}
-
-.kitchen-chip.is-pending {
-  border-color: rgba(15, 23, 42, 0.12);
-}
-
-.kitchen-chip-remove {
-  border: none;
-  background: rgba(255, 255, 255, 0.6);
-  color: inherit;
-  width: 22px;
-  height: 22px;
-  border-radius: 999px;
-  display: inline-flex;
-  align-items: center;
-  justify-content: center;
-  cursor: pointer;
-  font-size: 12px;
-  line-height: 1;
-}
-
-.kitchen-chip-action {
-  border: none;
-  background: #ffffff;
-  color: #1d2939;
-  padding: 6px 10px;
-  border-radius: 999px;
-  font-size: 13px;
-  font-weight: 600;
-  box-shadow: 0 6px 16px rgba(15, 23, 42, 0.08);
-  cursor: pointer;
-}
-
-.kitchen-suggestion-list {
-  margin-top: 6px;
-  background: white;
-  border-radius: 16px;
-  border: 1px solid #e4e7ec;
-  box-shadow: 0 12px 30px rgba(15, 23, 42, 0.12);
-  padding: 6px;
-  display: flex;
-  flex-direction: column;
-  gap: 4px;
-}
-
-.kitchen-suggestion-list.is-scrollable {
-  max-height: 240px;
-  overflow-y: auto;
-}
-
-.kitchen-suggestion {
-  border: none;
-  background: transparent;
-  text-align: left;
-  padding: 10px 12px;
-  border-radius: 12px;
-  font-size: 15px;
-  font-weight: 600;
-  color: #101828;
-  cursor: pointer;
-}
-
-.kitchen-suggestion.is-assignee {
-  display: inline-flex;
-  align-items: center;
-  gap: 10px;
-}
-
-.kitchen-suggestion.is-create {
-  color: #4338ca;
-}
-
-.kitchen-suggestion-empty {
-  padding: 8px 10px;
-}
-
-.kitchen-suggestion:hover,
-.kitchen-suggestion:focus-visible {
-  background: #f2f4f7;
-  outline: none;
-}
-
-.kitchen-inline-panel {
-  margin-top: 8px;
-  border-radius: 16px;
-  border: 1px solid #e4e7ec;
-  background: #ffffff;
-  padding: 16px;
-  display: flex;
-  flex-direction: column;
-  gap: 16px;
-  box-shadow: 0 12px 30px rgba(15, 23, 42, 0.08);
-}
-
-.kitchen-inline-header {
-  display: flex;
-  flex-direction: column;
-  gap: 4px;
-  font-size: 16px;
-}
-
-.kitchen-category-list {
-  display: flex;
-  flex-wrap: wrap;
-  gap: 10px;
-  margin-top: 6px;
-}
-
-.kitchen-category-option {
-  border: none;
-  background: transparent;
-  padding: 0;
-  position: relative;
-  cursor: pointer;
-}
-
-.kitchen-category-option .kitchen-chip {
-  padding-right: 26px;
-}
-
-.kitchen-category-option.selected .kitchen-chip {
-  border-color: rgba(15, 23, 42, 0.25);
-  box-shadow: 0 10px 24px rgba(15, 23, 42, 0.14);
-}
-
-.kitchen-category-check {
-  position: absolute;
-  top: -6px;
-  right: -4px;
-  width: 18px;
-  height: 18px;
-  border-radius: 999px;
-  background: #0f172a;
-  color: white;
-  font-size: 11px;
-  display: inline-flex;
-  align-items: center;
-  justify-content: center;
-}
-
-.kitchen-inline-actions {
-  display: flex;
-  flex-wrap: wrap;
-  gap: 10px;
-}
-
-.kitchen-context-modal-backdrop {
-  position: fixed;
-  inset: 0;
-  background: rgba(15, 23, 42, 0.35);
-  display: flex;
-  align-items: center;
-  justify-content: center;
-  padding: 20px;
-  z-index: 60;
-}
-
-.kitchen-context-modal-backdrop.inner {
-  background: rgba(15, 23, 42, 0.2);
-  z-index: 70;
-}
-
-.kitchen-context-modal {
-  width: min(420px, 100%);
-  max-height: min(80vh, 560px);
-  background: #ffffff;
-  border-radius: 18px;
-  padding: 20px;
-  box-shadow: 0 20px 48px rgba(15, 23, 42, 0.18);
-  display: flex;
-  flex-direction: column;
-  gap: 16px;
-  overflow: hidden;
-}
-
-.kitchen-context-modal.small {
-  width: min(380px, 100%);
-}
-
-.kitchen-context-modal-header {
-  display: flex;
-  justify-content: space-between;
-  gap: 12px;
-}
-
-.kitchen-context-modal-header h4 {
-  margin: 0;
-  font-size: 18px;
-}
-
-.kitchen-context-modal-body {
-  display: flex;
-  flex-direction: column;
-  gap: 14px;
-  overflow-y: auto;
-  padding-right: 2px;
-}
-
-.kitchen-context-modal-actions {
-  display: flex;
-  flex-wrap: wrap;
-  gap: 12px;
-  justify-content: center;
-}
-
-.kitchen-color-grid {
-  display: flex;
-  flex-wrap: wrap;
-  gap: 10px;
-}
-
-.kitchen-color-option {
-  border: 1px solid transparent;
-  border-radius: 12px;
-  padding: 8px 12px;
-  background: #f2f4f7;
-  color: #101828;
-  font-weight: 600;
-  cursor: pointer;
-  min-height: 44px;
-}
-
-.kitchen-color-option.swatch {
-  width: 44px;
-  padding: 0;
-  display: inline-flex;
-  align-items: center;
-  justify-content: center;
-  font-weight: 700;
-}
-
-.kitchen-color-option.selected {
-  border-color: rgba(15, 23, 42, 0.3);
-  box-shadow: 0 8px 18px rgba(15, 23, 42, 0.15);
-}
-
-.kitchen-day-feedback {
-  display: flex;
-  flex-direction: column;
-  gap: 4px;
-  margin-top: 12px;
-  font-size: 13px;
-  color: #667085;
-}
-
-.kitchen-day-feedback-text.saving {
-  color: #475467;
-}
-
-.kitchen-day-feedback-text.saved {
-  color: #027a48;
-}
-
-.kitchen-day-feedback-text.error {
-  color: #b42318;
-}
-
-.kitchen-toolbar {
-  display: flex;
-  flex-wrap: wrap;
-  gap: 12px;
-  align-items: center;
-  justify-content: space-between;
-  margin-top: 16px;
-}
-
-.kitchen-alert {
-  border-radius: 12px;
-  padding: 10px 12px;
-  font-weight: 600;
-  font-size: 14px;
-}
-
-.kitchen-alert.success {
-  background: #ecfdf3;
-  color: #027a48;
-  border: 1px solid #a6f4c5;
-}
-
-.kitchen-alert.error {
-  background: #fef3f2;
-  color: #b42318;
-  border: 1px solid #fecdca;
-}
-
-.kitchen-form {
-  display: flex;
-  flex-direction: column;
-  gap: 20px;
-}
-
-.kitchen-dish-form-card {
-  width: 100%;
-  max-width: 560px;
-  margin: 0 auto;
-}
-
-.kitchen-dish-ingredients {
-  gap: 10px;
-}
-
-.kitchen-table {
-  width: 100%;
-  border-collapse: collapse;
-}
-
-.kitchen-table th,
-.kitchen-table td {
-  text-align: left;
-  padding: 10px 8px;
-  border-bottom: 1px solid #eef2f6;
-  font-size: 14px;
-}
-
-@media (max-width: 600px) {
-  .kitchen-container {
-    padding: 16px;
-    padding-bottom: calc(96px + env(safe-area-inset-bottom, 0px));
-  }
-
-  .kitchen-grid {
-    grid-template-columns: 1fr;
-    gap: 16px;
-  }
-
-  .kitchen-week-mobile-frame {
-    width: calc(100% - 32px);
-    max-width: 420px;
-    margin: 0 auto;
-    gap: 16px;
-  }
-
-  .kitchen-week-carousel {
-    margin: 0;
-    width: 100%;
-  }
-
-  .kitchen-week-carousel-arrow {
-    display: none;
-  }
-
-  .kitchen-assign-day.is-occupied .kitchen-assign-day-status {
-    display: none;
-  }
-
-  .kitchen-week-days {
-    display: flex;
-    grid-template-columns: none;
-    overflow-x: auto;
-    scroll-snap-type: x mandatory;
-    scroll-behavior: smooth;
-    -webkit-overflow-scrolling: touch;
-    width: 100%;
-    gap: 0;
-    padding: 0 0 4px;
-    scroll-padding-inline: 0;
-  }
-
-  .kitchen-week-days::-webkit-scrollbar {
-    display: none;
-  }
-
-  .kitchen-week-days .kitchen-day-card {
-    flex: 0 0 100%;
-    scroll-snap-align: start;
-  }
-
-  .kitchen-week-carousel-dots {
-    display: flex;
-    width: 100%;
-  }
-
-  .kitchen-week-header {
-    flex-direction: column;
-    margin-bottom: 0;
-  }
-
-  .kitchen-week-header-actions {
-    width: 100%;
-    align-items: stretch;
-  }
-
-  .kitchen-week-nav {
-    grid-template-columns: 44px 1fr 44px;
-  }
-
-  .kitchen-week-controls {
-    gap: 12px;
-    margin-bottom: 16px;
-  }
-
-  .kitchen-weekdays-strip {
-    order: 0;
-  }
-
-  .kitchen-week-mobile-frame {
-    order: 1;
-  }
-
-  .kitchen-week-picker {
-    width: 100%;
-  }
-
-  .kitchen-week-picker .kitchen-label {
-    display: none;
-  }
-
-  .kitchen-week-picker .kitchen-input {
-    font-size: 15px;
-  }
-
-  .kitchen-weekdays-strip {
-    padding: 12px;
-  }
-
-  .kitchen-weekdays-arrow {
-    display: none;
-  }
-
-  .kitchen-weekdays-list {
-    gap: 8px;
-  }
-
-  .kitchen-weekdays-item {
-    min-width: 56px;
-    min-height: 72px;
-    padding: 6px 4px;
-  }
-
-  .kitchen-weekdays-circle {
-    width: 44px;
-    height: 44px;
-    font-size: 12px;
-  }
-
-  .kitchen-weekdays-label {
-    font-size: 11px;
-  }
-
-  .kitchen-topbar {
-    display: none;
-  }
-
-  .kitchen-nav-desktop {
-    display: none;
-  }
-
-  .kitchen-user {
-    display: none;
-  }
-
-  .kitchen-user-placeholder {
-    display: none;
-  }
-
-  .kitchen-nav-toggle {
-    display: none;
-  }
-
-  .kitchen-drawer,
-  .kitchen-drawer-backdrop {
-    display: none;
-  }
-
-  .kitchen-dishes-header {
-    align-items: flex-start;
-  }
-
-  .kitchen-dishes-header .kitchen-button {
-    width: 100%;
-  }
-
-  .kitchen-dish-card {
-    flex-direction: column;
-    align-items: flex-start;
-  }
-
-  .kitchen-dish-actions {
-    width: 100%;
-    justify-content: flex-end;
-  }
-
-  .kitchen-modal {
-    padding: 20px;
-    max-height: 92vh;
-  }
-
-  .kitchen-context-modal-backdrop {
-    align-items: flex-end;
-  }
-
-  .kitchen-context-modal {
-    width: 100%;
-    border-radius: 18px 18px 0 0;
-    max-height: 85vh;
-  }
-
-  .kitchen-bottom-nav {
-    display: block;
-  }
-
-  .kitchen-bottom-nav-label {
-    font-size: 11px;
-  }
-}
-
-@media (max-width: 360px) {
-  .kitchen-bottom-nav-label {
-    font-size: 10px;
-  }
-}
-
-@media (min-width: 900px) {
-  .kitchen-day-empty-button {
-    max-width: 280px;
-  }
-
-  .kitchen-modal-actions {
-    flex-direction: row;
-  }
-}
-
-
-.kitchen-ui-card {
-  background: var(--hf-surface);
-  border-radius: var(--hf-radius-lg);
-  padding: 24px;
-  box-shadow: var(--hf-shadow-soft);
-  display: flex;
-  flex-direction: column;
-  gap: 16px;
-}
-
-.kitchen-ui-button {
-  border: none;
-  border-radius: 999px;
-  background: var(--hf-brand);
-  color: #fff;
-  padding: 12px 16px;
-  font-weight: 700;
-  cursor: pointer;
-}
-
-.kitchen-ui-button:disabled {
-  opacity: 0.65;
-  cursor: not-allowed;
-}
-
-.kitchen-ui-button-secondary {
-  background: var(--hf-surface-soft);
-  color: var(--hf-text);
-  border: 1px solid var(--hf-border);
-}
-
-.kitchen-ui-button-ghost {
-  background: transparent;
-  border: 1px solid var(--hf-border);
-  color: var(--hf-text);
-}
-
-.kitchen-ui-input-group {
-  display: grid;
-  gap: 6px;
-}
-
-.kitchen-ui-input {
-  border: 1px solid var(--hf-border);
-  border-radius: var(--hf-radius-md);
-  padding: 11px 12px;
-  font-size: 14px;
-  background: #fff;
-}
-
-.kitchen-ui-input:focus-visible {
-  outline: 2px solid color-mix(in srgb, var(--hf-brand) 35%, white);
-  outline-offset: 1px;
-}
-
-.kitchen-ui-badge {
-  border-radius: 999px;
-  padding: 4px 10px;
-  font-size: 12px;
-  font-weight: 600;
-}
-
-.kitchen-ui-badge-default { background: #eef2ff; color: #3730a3; }
-.kitchen-ui-badge-success { background: var(--hf-surface-mint); color: #0f7a3d; }
-.kitchen-ui-badge-warning { background: var(--hf-surface-peach); color: #9a580a; }
-
-.kitchen-ui-header,
-.kitchen-ui-bottom-nav {
-  backdrop-filter: blur(12px);
-  -webkit-backdrop-filter: blur(12px);
-  background: var(--hf-glass);
-}
-
-.kitchen-ui-header {
-  position: sticky;
-  top: 0;
-  z-index: 20;
-  border-bottom: 1px solid var(--hf-glass-border);
-}
-
-.kitchen-ui-header-inner {
-  max-width: 1100px;
-  margin: 0 auto;
-  padding: 16px 24px;
-  display: flex;
-  justify-content: space-between;
-  align-items: center;
-  gap: 16px;
-}
-
-.kitchen-ui-bottom-nav {
-  position: fixed;
-  left: 0;
-  right: 0;
-  bottom: 0;
-  z-index: 25;
-  padding: 10px 12px calc(12px + env(safe-area-inset-bottom, 0px));
-  border-top: 1px solid var(--hf-glass-border);
-  display: none;
-}
-
-.kitchen-login-wrap {
-  max-width: 560px;
-  min-height: 100vh;
-  min-height: 100dvh;
-  display: grid;
-  place-items: center;
-  padding-top: 24px;
-  padding-bottom: 24px;
-}
-
-.kitchen-login-card {
-  width: min(100%, 460px);
-  border-radius: 30px;
-  padding: clamp(22px, 5vw, 34px);
-  background: rgba(248, 250, 252, 0.88);
-  border: 1px solid rgba(228, 231, 236, 0.72);
-  box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.05);
-}
-
-.kitchen-login-badge {
-  display: grid;
-  place-items: center;
-  margin-top: 4px;
-}
-
-.kitchen-login-brand {
-  margin: 0;
-  text-align: center;
-  color: #4338ca;
-  font-size: 1rem;
-  font-weight: 700;
-  letter-spacing: 0.02em;
-}
-
-.kitchen-login-badge-icon {
-  width: 88px;
-  height: 88px;
-  border-radius: 999px;
-  display: grid;
-  place-items: center;
-  background: #f8fafc;
-  box-shadow: 0 0 0 10px rgba(255, 255, 255, 0.9), 0 0 30px rgba(67, 56, 202, 0.14);
-}
-
-.kitchen-login-icon {
-  width: 40px;
-  height: 40px;
-  object-fit: contain;
-}
-
-@media (min-width: 768px) {
-  .kitchen-brand-icon {
-    display: none;
-  }
-
-  .kitchen-brand-logo {
-    display: block;
-  }
-}
-
-.kitchen-login-title {
-  margin: 8px 0 0;
-  text-align: center;
-  font-size: clamp(2rem, 7vw, 2.8rem);
-  font-weight: 700;
-  letter-spacing: -0.02em;
-}
-
-.kitchen-login-subtitle {
-  margin: 0;
-  text-align: center;
-  color: #98a2b3;
-  font-size: clamp(0.95rem, 3vw, 1.1rem);
-}
-
-.kitchen-login-form {
-  margin-top: 10px;
-  display: grid;
-  gap: 14px;
-}
-
-.kitchen-login-fields {
-  display: grid;
-  gap: 14px;
-  border-radius: 30px;
-  background: rgba(255, 255, 255, 0.62);
-  border: 1px solid rgba(228, 231, 236, 0.6);
-  padding: clamp(16px, 5vw, 24px);
-}
-
-.kitchen-login-label {
-  font-size: 0.78rem;
-  color: #98a2b3;
-  font-weight: 700;
-  letter-spacing: 0.06em;
-}
-
-.kitchen-login-input-wrap {
-  position: relative;
-  display: flex;
-  align-items: center;
-}
-
-.kitchen-login-input-icon {
-  width: 18px;
-  height: 18px;
-  color: #98a2b3;
-}
-
-.kitchen-login-input-wrap > .kitchen-login-input-icon {
-  position: absolute;
-  left: 16px;
-  top: 50%;
-  transform: translateY(-50%);
-  pointer-events: none;
-}
-
-.kitchen-ui-input.kitchen-login-input {
-  width: 100%;
-  padding: 15px 16px;
-  padding-left: 52px;
-  border-radius: 999px;
-  border-color: transparent;
-  background: #f8fafc;
-  color: #334155;
-  font-size: 16px;
-  line-height: 1.3;
-  font-weight: 500;
-}
-
-.kitchen-ui-input.kitchen-login-input::placeholder {
-  color: #94a3b8;
-  font-weight: 400;
-}
-
-.kitchen-login-input:focus-visible {
-  border-color: #4338ca;
-  outline: 2px solid rgba(67, 56, 202, 0.2);
-  outline-offset: 1px;
-}
-
-.kitchen-ui-input.kitchen-login-password-input {
-  padding-right: 52px;
-}
-
-.kitchen-login-eye {
-  position: absolute;
-  right: 16px;
-  top: 50%;
-  transform: translateY(-50%);
-  border: none;
-  background: transparent;
-  padding: 6px;
-  border-radius: 999px;
-  display: grid;
-  place-items: center;
-}
-
-.kitchen-login-forgot-row {
-  display: flex;
-  justify-content: flex-end;
-}
-
-.kitchen-login-link {
-  border: none;
-  background: transparent;
-  color: #4338ca;
-  font-weight: 600;
-  font-size: 0.95rem;
-  padding: 0;
-  cursor: pointer;
-}
-
-.kitchen-login-submit {
-  min-height: 54px;
-  font-size: 1.08rem;
-}
-
-.kitchen-login-divider {
-  display: flex;
-  align-items: center;
-  justify-content: center;
-  color: #98a2b3;
-  font-size: 0.78rem;
-  font-weight: 700;
-  letter-spacing: 0.08em;
-  gap: 10px;
-}
-
-.kitchen-login-divider::before,
-.kitchen-login-divider::after {
-  content: "";
-  height: 1px;
-  flex: 1;
-  background: #e4e7ec;
-}
-
-.kitchen-login-socials {
-  display: grid;
-  grid-template-columns: repeat(2, minmax(0, 1fr));
-  gap: 10px;
-}
-
-.kitchen-login-social-button {
-  border-radius: 999px;
-  border: 1px solid var(--hf-border);
-  min-height: 46px;
-  background: rgba(255, 255, 255, 0.8);
-  color: #344054;
-  font-weight: 600;
-  font-size: 1rem;
-  display: inline-flex;
-  align-items: center;
-  justify-content: center;
-  gap: 10px;
-}
-
-.kitchen-login-social-icon {
-  width: 18px;
-  height: 18px;
-  line-height: 1;
-  display: inline-flex;
-  align-items: center;
-  justify-content: center;
-  flex-shrink: 0;
-}
-
-.kitchen-login-social-svg {
-  width: 100%;
-  height: 100%;
-}
-
-.kitchen-login-social-svg-apple {
-  color: #111827;
-}
-
-.kitchen-login-footer {
-  margin: 0;
-  text-align: center;
-  color: #98a2b3;
-  font-size: 1rem;
-}
-
-.kitchen-login-error {
-  color: var(--hf-danger);
-  text-align: center;
-}
-
-.kitchen-ui-bottom-nav-inner {
-  max-width: 720px;
-  margin: 0 auto;
-  display: grid;
-  grid-template-columns: repeat(4, minmax(0, 1fr));
-  gap: 8px;
-}
-
-.kitchen-ui-bottom-nav-item {
-  display: flex;
-  flex-direction: column;
-  align-items: center;
-  color: var(--hf-muted);
-  gap: 4px;
-  border-radius: 14px;
-  padding: 8px 6px;
-  text-decoration: none;
-  font-size: 12px;
-  font-weight: 600;
-}
-
-.kitchen-ui-bottom-nav-item.active {
-  background: #eef2ff;
-  color: var(--hf-brand-strong);
-}
-
-.kitchen-ui-avatar-stack { display: flex; }
-.kitchen-ui-avatar {
-  width: 30px;
-  height: 30px;
-  border-radius: 999px;
-  display: grid;
-  place-items: center;
-  background: #eef2ff;
-  border: 2px solid white;
-  margin-left: -8px;
-  font-size: 12px;
-  font-weight: 700;
-}
-
-.kitchen-ui-avatar:first-child { margin-left: 0; }
-
-.kitchen-ui-fab {
-  position: fixed;
-  bottom: 82px;
-  right: 20px;
-  width: 56px;
-  height: 56px;
-  border-radius: 999px;
-  border: none;
-  background: var(--hf-brand);
-  color: #fff;
-  box-shadow: var(--hf-shadow-glass);
-}
-
-.kitchen-ui-sheet-backdrop {
-  position: fixed;
-  inset: 0;
-  background: rgba(16, 24, 40, 0.45);
-  z-index: 45;
-  display: grid;
-  place-items: end center;
-}
-
-.kitchen-ui-sheet {
-  width: min(720px, 100%);
-  background: #fff;
-  border-radius: var(--hf-radius-xl) var(--hf-radius-xl) 0 0;
-  padding: 24px;
-}
-
-.kitchen-ui-sheet-actions { margin-top: 16px; display: flex; gap: 12px; justify-content: flex-end; }
-
-@media (max-width: 900px) {
-  .kitchen-ui-bottom-nav { display: block; }
-}
-
-/* Neo-Soft 2026 global harmonization */
-.kitchen-container {
-  width: min(1120px, 100%);
-  padding: 20px;
-  margin: 0 auto;
-  max-width: 100%;
-}
-
-.kitchen-ui-card,
-.kitchen-card,
-.kitchen-dish-card,
-.kitchen-inline-panel,
-.kitchen-modal,
-.kitchen-context-modal,
-.kitchen-day-card,
-.kitchen-weekdays-strip {
-  border-radius: var(--hf-radius-lg);
-  box-shadow: var(--hf-shadow-soft);
-  border: 1px solid var(--hf-border);
-  background: var(--hf-surface);
-}
-
-.kitchen-day-card.is-empty,
-.kitchen-dish-card.is-sidedish,
-.kitchen-ui-button-secondary,
-.kitchen-button.secondary,
-.kitchen-status-pill.planned,
-.kitchen-tab-button.is-active {
-  background: var(--hf-surface-soft);
-}
-
-.kitchen-ui-button,
-.kitchen-button,
-.kitchen-assignee-button,
-.kitchen-week-arrow,
-.kitchen-weekdays-arrow,
-.kitchen-assign-week-nav,
-.kitchen-color-option,
-.kitchen-chip-action {
-  border-radius: 999px;
-  min-height: 44px;
-  transition: transform 180ms ease, box-shadow 180ms ease, background 180ms ease, color 180ms ease;
-}
-
-.kitchen-ui-button,
-.kitchen-button {
-  background: var(--hf-brand);
-  color: #fff;
-  box-shadow: var(--hf-shadow-soft);
-}
-
-.kitchen-ui-button:hover,
-.kitchen-button:hover {
-  background: var(--hf-brand-strong);
-  transform: translateY(-1px);
-}
-
-.kitchen-ui-button-secondary,
-.kitchen-button.secondary {
-  border: 1px solid var(--hf-border);
-  color: var(--hf-text);
-}
-
-.kitchen-ui-button-ghost,
-.kitchen-button.ghost {
-  background: transparent;
-  border: 1px solid var(--hf-border);
-  color: var(--hf-text);
-}
-
-.kitchen-ui-input,
-.kitchen-input,
-.kitchen-select,
-.kitchen-textarea {
-  border-radius: var(--hf-radius-md);
-  border: 1px solid var(--hf-border);
-  min-height: 48px;
-  padding: 11px 14px;
-}
-
-.kitchen-topbar,
-.kitchen-bottom-nav,
-.kitchen-ui-header,
-.kitchen-ui-bottom-nav {
-  background: var(--hf-glass);
-  border-color: var(--hf-glass-border);
-  backdrop-filter: blur(12px);
-  -webkit-backdrop-filter: blur(12px);
-}
-
-.kitchen-brand-link,
-.kitchen-title,
-.kitchen-login-title,
-.kitchen-day-title,
-.kitchen-dishes-header h2 {
-  color: var(--hf-text);
-}
-
-.kitchen-toolbar-search {
-  max-width: 340px;
-}
-
-.kitchen-block-gap {
-  margin-bottom: 16px;
-}
-
-.kitchen-title-no-margin {
-  margin-top: 0;
-  margin-bottom: 6px;
-}
-
-.kitchen-form-compact {
-  gap: 12px;
-}
-
-.kitchen-table th,
-.kitchen-table td {
-  border-bottom: 1px solid var(--hf-border);
-}
-
-@media (min-width: 900px) {
-  .kitchen-grid {
-    grid-template-columns: repeat(2, minmax(0, 1fr));
-  }
-}
-
-/* Semana Neo-Soft 2026 redesign */
-.kitchen-ui-header {
-  background: #eef2ff;
-  border-bottom: 1px solid #dbe3ff;
-}
-
-.kitchen-ui-header-inner {
-  min-height: 88px;
-  padding: 20px 24px;
-}
-
-.kitchen-brand-icon {
-  width: 36px;
-  height: 36px;
-}
-
-.kitchen-nav-desktop {
-  gap: 10px;
-}
-
-.kitchen-nav-desktop a {
-  border-radius: 14px;
-  padding: 11px 18px;
-  font-size: 14px;
-  background: transparent;
-}
-
-.kitchen-nav-desktop a.active {
-  background: #dfe4ff;
-  color: #3730a3;
-}
-
-.kitchen-user { position: relative; }
-
-.kitchen-user-chip {
-  display: inline-flex;
-  align-items: center;
-  gap: 10px;
-  border: 1px solid #dbe3ff;
-  background: #ffffff;
-  border-radius: 999px;
-  padding: 7px 14px 7px 8px;
-  cursor: pointer;
-  box-shadow: 0 4px 14px rgba(79, 70, 229, 0.12);
-}
-
-.kitchen-user-chip:hover { background: #f8faff; }
-
-.kitchen-user-avatar {
-  width: 34px;
-  height: 34px;
-  border-radius: 999px;
-  display: grid;
-  place-items: center;
-  background: #dfe4ff;
-  color: #3730a3;
-  font-weight: 700;
-  font-size: 12px;
-}
-
-.kitchen-user-name { font-weight: 600; font-size: 14px; }
-.kitchen-user-chevron,
-.kitchen-user-menu-icon {
-  width: 16px;
-  height: 16px;
-  stroke: currentColor;
-  stroke-width: 1.8;
-  fill: none;
-}
-
-.kitchen-user-menu {
-  position: absolute;
-  right: 0;
-  top: calc(100% + 10px);
-  min-width: 220px;
-  background: rgba(255, 255, 255, 0.96);
-  border: 1px solid #e6e9f8;
-  box-shadow: 0 16px 30px rgba(30, 41, 59, 0.14);
-  border-radius: 20px;
-  padding: 8px;
-  display: grid;
-  gap: 4px;
-  z-index: 30;
-}
-
-.kitchen-user-menu button {
-  border: none;
-  background: transparent;
-  border-radius: 14px;
-  padding: 10px 12px;
-  display: flex;
-  align-items: center;
-  gap: 10px;
-  font-weight: 600;
-  color: #334155;
-  cursor: pointer;
-}
-
-.kitchen-user-menu button:hover { background: #eef2ff; }
-
-.kitchen-weekdays-item {
-  min-width: 72px;
-  min-height: 92px;
-  border-radius: 20px;
-}
-
-.kitchen-weekdays-circle {
-  border-radius: 20px;
-}
-
-.kitchen-day-card {
-  background: var(--day-card-bg, #fff);
-  color: var(--day-card-text, var(--hf-text));
-}
-
-.kitchen-day-title,
-.kitchen-day-info-value,
-.kitchen-day-info-label {
-  color: inherit;
-}
-
-.kitchen-day-empty-button {
-  border-radius: 18px;
-  min-height: 50px;
-}
-
-.kitchen-week-mobile-frame { gap: 22px; }
-
-.kitchen-ui-bottom-nav {
-  background: #eef2ff;
-  border-top: 1px solid #dbe3ff;
-}
-
-@media (max-width: 900px) {
-  .kitchen-ui-header { display: none; }
-  .kitchen-container {
-    padding: 14px 14px 88px;
-  }
-}
-
-.kitchen-user-menu-household {
-  display: flex;
-  flex-direction: column;
-  gap: 6px;
-  padding: 8px 10px;
-}
-
-.kitchen-user-menu-household span {
-  font-size: 12px;
-  color: #64748b;
-}
-
-
-.shopping-header-card {
-  margin-bottom: 16px;
-}
-
-.shopping-header-row {
-  display: flex;
-  justify-content: space-between;
-  align-items: center;
-  gap: 12px;
-}
-
-.shopping-week-nav {
-  margin-top: 12px;
-  display: flex;
-  align-items: center;
-  gap: 10px;
-}
-
-.shopping-week-nav .kitchen-input {
-  max-width: 180px;
-}
-
-.shopping-week-arrow {
-  width: 34px;
-  height: 34px;
-  border-radius: 10px;
-  border: 1px solid var(--hf-border);
-  background: #fff;
-  color: var(--hf-text);
-  display: inline-flex;
-  align-items: center;
-  justify-content: center;
-  cursor: pointer;
-}
-
-.shopping-week-arrow-icon {
-  width: 18px;
-  height: 18px;
-}
-
-.shopping-week-arrow-icon.is-next {
-  transform: rotate(180deg);
-}
-
-.shopping-refresh-icon {
-  border: 1px solid var(--hf-border);
-  background: white;
-  border-radius: 10px;
-  width: 34px;
-  height: 34px;
-  cursor: pointer;
-}
-
-.shopping-toolbar {
-  margin-top: 12px;
-  display: grid;
-  grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
-  gap: 10px;
-}
-
-.shopping-tabs {
-  margin-top: 12px;
-  display: flex;
-  gap: 8px;
-}
-
-.shopping-tab {
-  border: 1px solid var(--hf-border);
-  background: #fff;
-  border-radius: 999px;
-  padding: 8px 12px;
-  cursor: pointer;
-}
-
-.shopping-tab.active {
-  background: var(--hf-surface-soft);
-  border-color: var(--hf-brand);
-}
-
-.shopping-categories {
-  display: grid;
-  gap: 14px;
-}
-
-.shopping-category-card {
-  background: color-mix(in srgb, var(--category-bg, #f8fafc) 65%, #fff);
-  border: 1px solid color-mix(in srgb, var(--category-text, #64748b) 16%, #fff);
-}
-
-.shopping-category-head {
-  display: flex;
-  align-items: center;
-  justify-content: space-between;
-  gap: 10px;
-  margin-bottom: 10px;
-}
-
-.shopping-category-head h4 {
-  color: var(--category-text, var(--hf-text));
-  letter-spacing: 0.04em;
-}
-
-.shopping-category-count {
-  border-radius: 999px;
-  padding: 4px 10px;
-  font-size: 12px;
-  font-weight: 700;
-  color: #fff;
-  background: color-mix(in srgb, var(--category-text, #475569) 75%, #1e293b);
-}
-
-.shopping-items-list {
-  display: grid;
-  gap: 9px;
-}
-
-.shopping-item {
-  display: flex;
-  align-items: center;
-  gap: 10px;
-  padding: 10px;
-  border-radius: 14px;
-  background: color-mix(in srgb, var(--category-bg, #f8fafc) 45%, white);
-  transition: transform 220ms ease, opacity 220ms ease, background 220ms ease;
-}
-
-.shopping-item.is-leaving {
-  opacity: 0;
-  transform: translateX(8px) scale(0.98);
-}
-
-.shopping-item.is-entering {
-  animation: shoppingEnter 360ms ease;
-}
-
-.shopping-item-text {
-  display: flex;
-  flex-direction: column;
-  gap: 2px;
-}
-
-.shopping-item.purchased .shopping-item-text {
-  text-decoration: line-through;
-  color: var(--hf-muted);
-}
-
-.shopping-check {
-  width: 28px;
-  height: 28px;
-  border-radius: 999px;
-  border: 2px solid color-mix(in srgb, var(--category-text, #64748b) 32%, #fff);
-  background: transparent;
-  display: inline-flex;
-  align-items: center;
-  justify-content: center;
-  cursor: pointer;
-  transition: transform 200ms ease, background 200ms ease, border-color 200ms ease;
-}
-
-.shopping-check:hover {
-  transform: scale(1.06);
-}
-
-.shopping-check-dot {
-  color: #fff;
-  font-size: 14px;
-  line-height: 1;
-  opacity: 0;
-  transform: scale(0.6);
-  transition: opacity 200ms ease, transform 220ms cubic-bezier(.2,.85,.3,1.3);
-}
-
-.shopping-check.is-checked {
-  background: var(--hf-brand);
-  border-color: var(--hf-brand);
-}
-
-.shopping-check.is-checked .shopping-check-dot {
-  opacity: 1;
-  transform: scale(1);
-}
-
-@keyframes shoppingEnter {
-  0% {
-    opacity: 0;
-    transform: translateY(6px) scale(0.98);
-  }
-  70% {
-    opacity: 1;
-    transform: translateY(0) scale(1.01);
-  }
-  100% {
-    transform: translateY(0) scale(1);
-  }
-}
+*,
+*::before,
+*::after {
+  box-sizing: border-box;
+}
+
+html,
+body {
+  width: 100%;
+  max-width: 100%;
+  height: 100%;
+  margin: 0;
+  overflow-x: hidden;
+}
+
+#root {
+  width: 100%;
+  max-width: 100%;
+  height: 100%;
+  overflow-x: hidden;
+}
+
+@media (pointer: coarse) {
+  html,
+  body {
+    overflow: hidden;
+    overscroll-behavior: none;
+  }
+
+  #root {
+    height: 100dvh;
+    overflow-y: auto;
+    overscroll-behavior: none;
+    -webkit-overflow-scrolling: touch;
+    touch-action: pan-y;
+  }
+}
+
+@media (pointer: fine) {
+  body {
+    overflow-y: auto;
+  }
+
+  #root {
+    min-height: 100%;
+  }
+}
+
+:root {
+  color-scheme: light;
+  --hf-bg: #f8fafc;
+  --hf-bg-gradient: linear-gradient(
+    180deg,
+    rgba(238, 242, 255, 0.72) 0%,
+    rgba(240, 253, 244, 0.5) 42%,
+    rgba(248, 250, 252, 0.96) 100%
+  );
+  --hf-surface: #ffffff;
+  --hf-surface-soft: #eef2ff;
+  --hf-surface-mint: #f0fdf4;
+  --hf-surface-peach: #fff7ed;
+  --hf-text: #1e293b;
+  --hf-muted: #667085;
+  --hf-brand: #4338ca;
+  --hf-brand-strong: #4338ca;
+  --hf-border: #e4e7ec;
+  --hf-danger: #b42318;
+  --hf-radius-md: 24px;
+  --hf-radius-lg: 28px;
+  --hf-radius-xl: 32px;
+  --hf-shadow-soft: 0 10px 25px -5px rgba(0, 0, 0, 0.05);
+  --hf-shadow-glass: 0 10px 30px rgba(31, 41, 55, 0.1);
+  --hf-glass: rgba(255, 255, 255, 0.7);
+  --hf-glass-border: rgba(255, 255, 255, 0.9);
+}
+
+.kitchen-app {
+  font-family: "Inter", system-ui, sans-serif;
+  background-color: var(--hf-bg);
+  background-image: var(--hf-bg-gradient);
+  background-repeat: no-repeat;
+  background-size: 100% 100%;
+  min-height: 100vh;
+  min-height: 100dvh;
+  width: 100%;
+  max-width: 100%;
+  color: var(--hf-text);
+}
+
+@media (min-width: 768px) {
+  :root {
+    --hf-bg-gradient: linear-gradient(
+      180deg,
+      rgba(238, 242, 255, 0.66) 0%,
+      rgba(240, 253, 244, 0.44) 46%,
+      rgba(248, 250, 252, 0.98) 100%
+    );
+  }
+}
+
+@media (min-width: 1200px) {
+  :root {
+    --hf-bg-gradient: linear-gradient(
+      180deg,
+      rgba(238, 242, 255, 0.58) 0%,
+      rgba(240, 253, 244, 0.38) 50%,
+      rgba(248, 250, 252, 1) 100%
+    );
+  }
+}
+
+.kitchen-container {
+  max-width: 1100px;
+  margin: 0 auto;
+  padding: 24px;
+  width: 100%;
+}
+
+.kitchen-bottom-nav {
+  position: fixed;
+  bottom: 0;
+  left: 0;
+  right: 0;
+  background: #ffffff;
+  border-top: 1px solid #e4e7ec;
+  z-index: 25;
+  padding: 10px 12px calc(12px + env(safe-area-inset-bottom, 0px));
+  display: none;
+}
+
+.kitchen-bottom-nav-inner {
+  max-width: 720px;
+  margin: 0 auto;
+  display: grid;
+  grid-template-columns: repeat(4, minmax(0, 1fr));
+  gap: 8px;
+}
+
+.kitchen-bottom-nav-item {
+  display: flex;
+  flex-direction: column;
+  align-items: center;
+  gap: 4px;
+  padding: 8px 6px;
+  border-radius: 14px;
+  text-decoration: none;
+  color: #667085;
+  font-weight: 600;
+  font-size: 12px;
+  line-height: 1.1;
+  transition: background 0.2s ease, color 0.2s ease, transform 0.2s ease;
+}
+
+.kitchen-bottom-nav-item.active {
+  background: #eef2ff;
+  color: #4338ca;
+}
+
+.kitchen-bottom-nav-item:active {
+  transform: translateY(1px);
+}
+
+.kitchen-bottom-nav-icon {
+  width: 22px;
+  height: 22px;
+  stroke: currentColor;
+  stroke-width: 1.8;
+  fill: none;
+  stroke-linecap: round;
+  stroke-linejoin: round;
+}
+
+.kitchen-bottom-nav-label {
+  font-size: 12px;
+  text-align: center;
+  white-space: nowrap;
+}
+
+.kitchen-topbar {
+  position: sticky;
+  top: 0;
+  z-index: 20;
+  background: white;
+  border-bottom: 1px solid #e4e7ec;
+}
+
+.kitchen-topbar-inner {
+  max-width: 1100px;
+  margin: 0 auto;
+  padding: 16px 24px;
+  display: flex;
+  align-items: center;
+  justify-content: space-between;
+  gap: 16px;
+  min-height: 72px;
+}
+
+.kitchen-brand {
+  display: flex;
+  align-items: center;
+  gap: 12px;
+}
+
+.kitchen-brand-link {
+  display: inline-flex;
+  align-items: center;
+  font-weight: 700;
+  font-size: 20px;
+  color: #101828;
+  text-decoration: none;
+}
+
+.kitchen-brand-icon {
+  width: 30px;
+  height: 30px;
+  object-fit: contain;
+}
+
+.kitchen-brand-logo {
+  display: none;
+  height: 30px;
+  width: auto;
+  object-fit: contain;
+}
+
+.kitchen-nav-desktop,
+.kitchen-nav-mobile {
+  display: flex;
+  gap: 16px;
+}
+
+.kitchen-nav-desktop a,
+.kitchen-nav-mobile a {
+  text-decoration: none;
+  color: #1d2939;
+  font-weight: 600;
+  font-size: 14px;
+  padding: 6px 8px;
+  border-radius: 8px;
+}
+
+.kitchen-nav-desktop a.active,
+.kitchen-nav-mobile a.active {
+  background: #eef2ff;
+  color: #3730a3;
+}
+
+.kitchen-user {
+  display: flex;
+  align-items: center;
+  gap: 10px;
+}
+
+.kitchen-user-name {
+  font-size: 14px;
+  font-weight: 600;
+  color: #1d2939;
+}
+
+.kitchen-logout-button {
+  width: 44px;
+  height: 44px;
+  display: inline-flex;
+  align-items: center;
+  justify-content: center;
+  border-radius: 12px;
+  border: 1px solid transparent;
+  background: transparent;
+  color: #475467;
+  cursor: pointer;
+  transition: background 0.2s ease, color 0.2s ease, border-color 0.2s ease;
+}
+
+.kitchen-logout-button:hover {
+  background: #f2f4f7;
+  color: #111827;
+}
+
+.kitchen-logout-button:focus-visible {
+  outline: 2px solid #6366f1;
+  outline-offset: 2px;
+}
+
+.kitchen-logout-icon {
+  width: 20px;
+  height: 20px;
+  stroke: currentColor;
+  stroke-width: 1.8;
+  fill: none;
+  stroke-linecap: round;
+  stroke-linejoin: round;
+}
+
+.kitchen-user-placeholder {
+  width: 160px;
+  min-height: 40px;
+}
+
+.kitchen-nav-toggle {
+  display: none;
+  flex-direction: column;
+  justify-content: center;
+  gap: 4px;
+  width: 36px;
+  height: 36px;
+  border-radius: 10px;
+  border: 1px solid #d0d5dd;
+  background: white;
+  cursor: pointer;
+  padding: 8px;
+}
+
+.kitchen-nav-toggle span {
+  display: block;
+  height: 2px;
+  background: #1d2939;
+  border-radius: 999px;
+}
+
+.kitchen-drawer-backdrop {
+  position: fixed;
+  inset: 0;
+  background: rgba(16, 24, 40, 0.4);
+  border: none;
+  z-index: 30;
+}
+
+.kitchen-drawer {
+  position: fixed;
+  top: 0;
+  left: 0;
+  width: min(300px, 80vw);
+  height: 100%;
+  background: white;
+  z-index: 31;
+  padding: 20px;
+  display: flex;
+  flex-direction: column;
+  gap: 16px;
+  box-shadow: 0 20px 40px rgba(15, 23, 42, 0.2);
+}
+
+.kitchen-drawer-header {
+  display: flex;
+  align-items: center;
+  justify-content: space-between;
+  font-weight: 600;
+}
+
+.kitchen-drawer-close {
+  border: none;
+  background: transparent;
+  color: #1d2939;
+  font-weight: 600;
+  cursor: pointer;
+}
+
+.kitchen-nav-mobile {
+  flex-direction: column;
+  gap: 8px;
+}
+
+.kitchen-drawer-user {
+  display: flex;
+  flex-direction: column;
+  gap: 12px;
+}
+
+.kitchen-card {
+  background: white;
+  border-radius: 16px;
+  padding: 24px;
+  box-shadow: 0 10px 30px rgba(15, 23, 42, 0.08);
+  display: flex;
+  flex-direction: column;
+  gap: 16px;
+  box-sizing: border-box;
+  min-width: 0;
+}
+
+.kitchen-grid {
+  display: grid;
+  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
+  gap: 20px;
+  align-items: stretch;
+}
+
+.kitchen-week-carousel {
+  position: relative;
+}
+
+.kitchen-week-days {
+  display: grid;
+  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
+  gap: 20px;
+  align-items: stretch;
+}
+
+.kitchen-week-carousel-arrow {
+  position: absolute;
+  top: 50%;
+  transform: translateY(-50%);
+  border: 1px solid #e2e8f0;
+  background: #fff;
+  color: #1f2937;
+  width: 36px;
+  height: 36px;
+  border-radius: 999px;
+  display: flex;
+  align-items: center;
+  justify-content: center;
+  box-shadow: 0 6px 16px rgba(15, 23, 42, 0.12);
+  cursor: pointer;
+  z-index: 2;
+}
+
+.kitchen-week-carousel-arrow.is-left {
+  left: -6px;
+}
+
+.kitchen-week-carousel-arrow.is-right {
+  right: -6px;
+}
+
+.kitchen-week-carousel-arrow-icon {
+  width: 18px;
+  height: 18px;
+  stroke: currentColor;
+  stroke-width: 2;
+  fill: none;
+}
+
+.kitchen-week-carousel-arrow-icon.is-next {
+  transform: rotate(180deg);
+}
+
+.kitchen-week-carousel-dots {
+  display: none;
+  justify-content: center;
+  gap: 6px;
+  margin-top: 12px;
+}
+
+.kitchen-week-carousel-dot {
+  width: 8px;
+  height: 8px;
+  border-radius: 999px;
+  border: none;
+  padding: 0;
+  background: #d0d5dd;
+}
+
+.kitchen-week-carousel-dot.is-active {
+  background: #6366f1;
+}
+
+.kitchen-dishes-page {
+  display: flex;
+  flex-direction: column;
+  gap: 20px;
+}
+
+.kitchen-dishes-header {
+  display: flex;
+  flex-wrap: wrap;
+  gap: 16px;
+  align-items: center;
+  justify-content: space-between;
+}
+
+.kitchen-dishes-header h2 {
+  margin: 0;
+  font-size: 24px;
+}
+
+.kitchen-dishes-header .kitchen-muted {
+  margin-top: 4px;
+}
+
+.kitchen-dishes-search {
+  display: flex;
+}
+
+.kitchen-dishes-tabs {
+  display: inline-flex;
+  gap: 8px;
+  padding: 6px;
+  border-radius: 12px;
+  background: #f1f5f9;
+  align-self: flex-start;
+}
+
+.kitchen-tab-button {
+  border: none;
+  background: transparent;
+  padding: 8px 16px;
+  border-radius: 10px;
+  font-weight: 600;
+  color: #475569;
+  cursor: pointer;
+  transition: background 0.2s ease, color 0.2s ease, box-shadow 0.2s ease;
+}
+
+.kitchen-tab-button.is-active {
+  background: white;
+  color: #1e293b;
+  box-shadow: 0 4px 12px rgba(15, 23, 42, 0.12);
+}
+
+.kitchen-tab-button:focus-visible {
+  outline: 3px solid rgba(79, 70, 229, 0.35);
+  outline-offset: 2px;
+}
+
+.kitchen-dishes-grid {
+  display: grid;
+  grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
+  gap: 16px;
+}
+
+.kitchen-dish-card {
+  background: white;
+  border-radius: 14px;
+  padding: 16px;
+  box-shadow: 0 6px 20px rgba(15, 23, 42, 0.08);
+  display: flex;
+  align-items: flex-start;
+  justify-content: space-between;
+  gap: 16px;
+  min-height: 96px;
+}
+
+.kitchen-dish-card.is-sidedish {
+  background: #f8fafc;
+  border: 1px solid #e2e8f0;
+}
+
+.kitchen-dish-title-row {
+  display: flex;
+  flex-wrap: wrap;
+  align-items: center;
+  gap: 8px;
+}
+
+.kitchen-dish-name {
+  margin: 0 0 6px;
+  font-size: 16px;
+}
+
+.kitchen-dish-badge {
+  display: inline-flex;
+  align-items: center;
+  padding: 2px 10px;
+  border-radius: 999px;
+  font-size: 11px;
+  font-weight: 600;
+  color: #1d4ed8;
+  background: #dbeafe;
+}
+
+.kitchen-dish-ingredients-text {
+  margin: 0;
+  color: #667085;
+  font-size: 13px;
+  line-height: 1.4;
+  display: -webkit-box;
+  -webkit-line-clamp: 2;
+  -webkit-box-orient: vertical;
+  overflow: hidden;
+}
+
+.kitchen-ingredient-card {
+  gap: 12px;
+}
+
+.kitchen-ingredient-canonical {
+  margin: 6px 0 0;
+  color: #667085;
+  font-size: 13px;
+}
+
+.kitchen-ingredient-tags {
+  display: flex;
+  flex-wrap: wrap;
+  gap: 8px;
+  margin-top: 8px;
+}
+
+.kitchen-ingredient-selected-category {
+  display: flex;
+  align-items: center;
+  gap: 8px;
+  margin-top: 8px;
+}
+
+.kitchen-dish-actions {
+  display: flex;
+  gap: 8px;
+  align-items: center;
+}
+
+.kitchen-icon-button {
+  border: 1px solid #e2e8f0;
+  background: white;
+  width: 44px;
+  height: 44px;
+  border-radius: 12px;
+  display: inline-flex;
+  align-items: center;
+  justify-content: center;
+  color: #344054;
+  cursor: pointer;
+  transition: border 0.2s ease, color 0.2s ease, box-shadow 0.2s ease;
+}
+
+.kitchen-icon-button svg {
+  width: 20px;
+  height: 20px;
+}
+
+.kitchen-icon-button:hover {
+  border-color: #c7d2fe;
+  color: #4f46e5;
+  box-shadow: 0 6px 12px rgba(79, 70, 229, 0.15);
+}
+
+.kitchen-icon-button.assign:hover {
+  border-color: #bbf7d0;
+  color: #15803d;
+  box-shadow: 0 6px 12px rgba(21, 128, 61, 0.12);
+}
+
+.kitchen-icon-button.danger:hover {
+  border-color: #fecaca;
+  color: #b42318;
+  box-shadow: 0 6px 12px rgba(180, 35, 24, 0.15);
+}
+
+.kitchen-modal-backdrop {
+  position: fixed;
+  inset: 0;
+  background: rgba(15, 23, 42, 0.4);
+  display: flex;
+  align-items: center;
+  justify-content: center;
+  padding: 20px;
+  z-index: 40;
+}
+
+.kitchen-modal {
+  width: min(640px, 100%);
+  max-height: min(90vh, 780px);
+  background: white;
+  border-radius: 18px;
+  padding: 24px;
+  box-shadow: 0 24px 60px rgba(15, 23, 42, 0.2);
+  display: flex;
+  flex-direction: column;
+  gap: 20px;
+  overflow: hidden;
+}
+
+.kitchen-modal .kitchen-form {
+  overflow-y: auto;
+  padding-right: 4px;
+}
+
+.kitchen-modal-header {
+  display: flex;
+  align-items: flex-start;
+  justify-content: space-between;
+  gap: 12px;
+}
+
+.kitchen-modal-header h3 {
+  margin: 0;
+  font-size: 20px;
+}
+
+.kitchen-modal-actions {
+  display: flex;
+  flex-direction: column;
+  gap: 12px;
+  align-items: center;
+  justify-content: center;
+  padding-top: 4px;
+}
+
+.kitchen-assign-modal .kitchen-modal-header p {
+  margin: 6px 0 0;
+}
+
+.kitchen-assign-body {
+  display: flex;
+  flex-direction: column;
+  gap: 16px;
+}
+
+.kitchen-assign-week-header {
+  display: grid;
+  grid-template-columns: 40px 1fr 40px;
+  align-items: center;
+  gap: 12px;
+  width: 100%;
+}
+
+.kitchen-assign-week-label {
+  text-align: center;
+  font-size: 13px;
+  font-weight: 600;
+  color: #0f172a;
+}
+
+.kitchen-assign-week-nav {
+  border: 1px solid #e2e8f0;
+  background: #ffffff;
+  color: #475569;
+  width: 40px;
+  height: 40px;
+  border-radius: 10px;
+  display: inline-flex;
+  align-items: center;
+  justify-content: center;
+  cursor: pointer;
+  transition: border-color 0.2s ease, background 0.2s ease, color 0.2s ease;
+}
+
+.kitchen-assign-week-nav:disabled {
+  cursor: not-allowed;
+  opacity: 0.45;
+}
+
+.kitchen-assign-week-icon {
+  width: 16px;
+  height: 16px;
+  stroke: currentColor;
+  stroke-width: 2;
+  fill: none;
+  stroke-linecap: round;
+  stroke-linejoin: round;
+}
+
+.kitchen-assign-week-icon.is-next {
+  transform: rotate(180deg);
+}
+
+.kitchen-assign-days {
+  display: grid;
+  grid-template-columns: repeat(7, minmax(0, 1fr));
+  gap: 8px;
+}
+
+.kitchen-assign-day {
+  border: 1px solid #e2e8f0;
+  background: #f8fafc;
+  border-radius: 12px;
+  padding: 10px 6px;
+  display: flex;
+  flex-direction: column;
+  align-items: center;
+  gap: 4px;
+  font-size: 12px;
+  color: #0f172a;
+  cursor: pointer;
+  transition: border-color 0.2s ease, background 0.2s ease, color 0.2s ease;
+}
+
+.kitchen-assign-day.is-selected {
+  border-color: #4f46e5;
+  background: #eef2ff;
+  color: #312e81;
+  box-shadow: 0 8px 16px rgba(79, 70, 229, 0.12);
+}
+
+.kitchen-assign-day.is-occupied {
+  border-color: #cbd5f5;
+}
+
+.kitchen-assign-day:disabled {
+  opacity: 0.45;
+  cursor: not-allowed;
+  background: #f1f5f9;
+}
+
+.kitchen-assign-day-label {
+  font-size: 11px;
+  text-transform: uppercase;
+  letter-spacing: 0.08em;
+}
+
+.kitchen-assign-day-number {
+  font-size: 15px;
+  font-weight: 700;
+}
+
+.kitchen-assign-day-status {
+  font-size: 10px;
+  text-transform: uppercase;
+  letter-spacing: 0.08em;
+  color: #64748b;
+  text-align: center;
+}
+
+.kitchen-assign-day-detail {
+  display: block;
+  font-size: 11px;
+  letter-spacing: normal;
+  text-transform: none;
+  color: #475569;
+}
+
+.kitchen-dishes-loading {
+  font-weight: 600;
+  text-align: center;
+}
+
+.kitchen-button {
+  background: #4f46e5;
+  border: none;
+  color: white;
+  padding: 12px 18px;
+  border-radius: 10px;
+  cursor: pointer;
+  font-weight: 600;
+  font-size: 15px;
+  min-height: 48px;
+  transition: background 0.2s ease, transform 0.2s ease, box-shadow 0.2s ease;
+}
+
+.kitchen-button.is-small {
+  padding: 6px 12px;
+  font-size: 13px;
+  min-height: 32px;
+}
+
+.kitchen-button:hover {
+  background: #4338ca;
+}
+
+.kitchen-button:active {
+  transform: translateY(1px);
+}
+
+.kitchen-button:focus-visible {
+  outline: 3px solid rgba(79, 70, 229, 0.35);
+  outline-offset: 2px;
+}
+
+.kitchen-button.secondary {
+  background: #e2e8f0;
+  color: #0f172a;
+}
+
+.kitchen-button.ghost {
+  background: transparent;
+  border: 1px solid #cbd5f5;
+  color: #1e293b;
+}
+
+.kitchen-input,
+.kitchen-select,
+.kitchen-textarea {
+  width: 100%;
+  padding: 10px 12px;
+  border-radius: 10px;
+  border: 1px solid #d0d5dd;
+  background: white;
+  font-size: 14px;
+  box-sizing: border-box;
+  min-width: 0;
+}
+
+.kitchen-label {
+  display: block;
+  font-weight: 600;
+  margin-bottom: 6px;
+  color: #344054;
+}
+
+.kitchen-field {
+  display: flex;
+  flex-direction: column;
+  gap: 6px;
+}
+
+.kitchen-toggle-field {
+  gap: 0;
+}
+
+.kitchen-toggle-row {
+  display: flex;
+  align-items: center;
+  justify-content: space-between;
+  gap: 12px;
+}
+
+.kitchen-toggle {
+  position: relative;
+  display: inline-flex;
+  align-items: center;
+}
+
+.kitchen-toggle-input {
+  position: absolute;
+  opacity: 0;
+  width: 0;
+  height: 0;
+}
+
+.kitchen-toggle-track {
+  width: 46px;
+  height: 26px;
+  border-radius: 999px;
+  background: #e4e7ec;
+  position: relative;
+  transition: background 0.2s ease;
+}
+
+.kitchen-toggle-track::after {
+  content: "";
+  position: absolute;
+  top: 3px;
+  left: 3px;
+  width: 20px;
+  height: 20px;
+  border-radius: 50%;
+  background: #ffffff;
+  box-shadow: 0 2px 6px rgba(15, 23, 42, 0.2);
+  transition: transform 0.2s ease;
+}
+
+.kitchen-toggle-input:checked + .kitchen-toggle-track {
+  background: #4f46e5;
+}
+
+.kitchen-toggle-input:checked + .kitchen-toggle-track::after {
+  transform: translateX(20px);
+}
+
+.kitchen-toggle-input:focus-visible + .kitchen-toggle-track {
+  outline: 3px solid rgba(79, 70, 229, 0.35);
+  outline-offset: 2px;
+}
+
+.kitchen-pill {
+  display: inline-flex;
+  align-items: center;
+  gap: 6px;
+  padding: 4px 10px;
+  border-radius: 999px;
+  background: #eef2ff;
+  color: #4338ca;
+  font-size: 12px;
+  font-weight: 600;
+}
+
+.kitchen-empty {
+  text-align: center;
+  padding: 32px;
+  color: #475467;
+}
+
+.kitchen-muted {
+  color: #667085;
+  font-size: 14px;
+}
+
+.kitchen-actions {
+  display: flex;
+  flex-direction: column;
+  gap: 12px;
+  margin-top: 20px;
+  width: 100%;
+}
+
+.kitchen-actions-inline {
+  display: flex;
+  gap: 8px;
+  align-items: center;
+}
+
+.kitchen-actions-inline .kitchen-select {
+  flex: 1;
+}
+
+.kitchen-assignee-picker {
+  position: relative;
+  display: flex;
+  flex-direction: column;
+  gap: 6px;
+}
+
+.kitchen-assignee-button {
+  width: 100%;
+  border: 1px solid #d0d5dd;
+  border-radius: 12px;
+  background: #ffffff;
+  padding: 8px 12px;
+  display: inline-flex;
+  align-items: center;
+  gap: 10px;
+  font-size: 14px;
+  font-weight: 600;
+  color: #101828;
+  min-height: 48px;
+  cursor: pointer;
+  transition: border 0.2s ease, box-shadow 0.2s ease;
+}
+
+.kitchen-assignee-button:hover {
+  border-color: #c7d2fe;
+}
+
+.kitchen-assignee-button:focus-visible {
+  outline: 3px solid rgba(79, 70, 229, 0.35);
+  outline-offset: 2px;
+}
+
+.kitchen-assignee-avatar {
+  width: 28px;
+  height: 28px;
+  border-radius: 50%;
+  display: inline-flex;
+  align-items: center;
+  justify-content: center;
+  font-size: 12px;
+  font-weight: 700;
+}
+
+.kitchen-assignee-name {
+  flex: 1;
+  text-align: left;
+}
+
+.kitchen-week-header {
+  display: flex;
+  align-items: flex-start;
+  justify-content: center;
+  gap: 16px;
+  margin-bottom: 20px;
+}
+
+.kitchen-week-header-main {
+  display: flex;
+  flex-direction: column;
+  gap: 4px;
+}
+
+.kitchen-week-header-actions {
+  display: flex;
+  flex-direction: column;
+  gap: 12px;
+  width: min(420px, 100%);
+  align-items: center;
+}
+
+.kitchen-week-mobile-frame {
+  width: 100%;
+  display: flex;
+  flex-direction: column;
+  align-items: stretch;
+}
+
+.kitchen-week-nav {
+  display: grid;
+  grid-template-columns: 44px minmax(200px, 260px) 44px;
+  align-items: center;
+  justify-content: center;
+  gap: 12px;
+  width: 100%;
+}
+
+.kitchen-week-picker {
+  width: 100%;
+  display: flex;
+  align-items: center;
+  justify-content: center;
+}
+
+.kitchen-week-arrow {
+  display: inline-flex;
+  align-items: center;
+  justify-content: center;
+  width: 44px;
+  height: 44px;
+  border-radius: 12px;
+  border: 1px solid #d0d5dd;
+  background: #ffffff;
+  color: #344054;
+  cursor: pointer;
+  transition: background 0.2s ease, border-color 0.2s ease, color 0.2s ease;
+}
+
+.kitchen-week-picker .kitchen-input {
+  min-height: 44px;
+  height: 44px;
+  text-align: center;
+  width: 100%;
+}
+
+.kitchen-week-arrow-icon {
+  width: 18px;
+  height: 18px;
+  stroke: currentColor;
+  stroke-width: 2;
+  fill: none;
+  stroke-linecap: round;
+  stroke-linejoin: round;
+}
+
+.kitchen-week-arrow-icon.is-next {
+  transform: rotate(180deg);
+}
+
+.kitchen-week-arrow:hover {
+  background: #f8fafc;
+  border-color: #c7ced6;
+  color: #1d2939;
+}
+
+.kitchen-week-arrow:focus-visible {
+  outline: 2px solid #6366f1;
+  outline-offset: 2px;
+}
+
+.kitchen-title {
+  margin: 0;
+  font-size: 22px;
+  font-weight: 700;
+  color: #0f172a;
+}
+
+.kitchen-week-subtitle {
+  margin: 0;
+}
+
+.kitchen-weekdays-strip {
+  padding: 20px 22px;
+  border: 1px solid #eaecf0;
+  box-shadow: none;
+  gap: 16px;
+  margin-bottom: 0;
+}
+
+.kitchen-week-controls {
+  display: flex;
+  flex-direction: column;
+  gap: 20px;
+  margin-bottom: 24px;
+}
+
+.kitchen-weekdays-carousel {
+  position: relative;
+  display: flex;
+  align-items: center;
+  width: 100%;
+  max-width: 100%;
+}
+
+.kitchen-weekdays-carousel.is-carousel::before,
+.kitchen-weekdays-carousel.is-carousel::after {
+  content: "";
+  position: absolute;
+  top: 0;
+  bottom: 0;
+  width: 32px;
+  pointer-events: none;
+  z-index: 1;
+}
+
+.kitchen-weekdays-carousel.is-carousel::before {
+  left: 0;
+  background: linear-gradient(90deg, #ffffff 0%, rgba(255, 255, 255, 0) 100%);
+}
+
+.kitchen-weekdays-carousel.is-carousel::after {
+  right: 0;
+  background: linear-gradient(270deg, #ffffff 0%, rgba(255, 255, 255, 0) 100%);
+}
+
+.kitchen-weekdays-arrow {
+  width: 40px;
+  height: 40px;
+  border-radius: 12px;
+  border: 1px solid #e4e7ec;
+  background: #ffffff;
+  color: #344054;
+  display: inline-flex;
+  align-items: center;
+  justify-content: center;
+  cursor: pointer;
+  transition: border-color 0.2s ease, background 0.2s ease;
+  position: absolute;
+  top: 50%;
+  transform: translateY(-50%);
+  z-index: 2;
+}
+
+.kitchen-weekdays-arrow:hover {
+  background: #f8fafc;
+  border-color: #d0d5dd;
+}
+
+.kitchen-weekdays-arrow.is-left {
+  left: -8px;
+}
+
+.kitchen-weekdays-arrow.is-right {
+  right: -8px;
+}
+
+.kitchen-weekdays-arrow-icon {
+  width: 18px;
+  height: 18px;
+  stroke: currentColor;
+  stroke-width: 2;
+  fill: none;
+  stroke-linecap: round;
+  stroke-linejoin: round;
+}
+
+.kitchen-weekdays-arrow-icon.is-next {
+  transform: rotate(180deg);
+}
+
+.kitchen-weekdays-list {
+  display: flex;
+  gap: 12px;
+  align-items: center;
+  justify-content: center;
+  width: 100%;
+  padding-bottom: 4px;
+}
+
+.kitchen-weekdays-list.is-carousel {
+  overflow-x: auto;
+  scroll-snap-type: x mandatory;
+  -webkit-overflow-scrolling: touch;
+  scrollbar-width: none;
+  justify-content: flex-start;
+  padding: 4px 32px;
+  max-width: 100%;
+}
+
+.kitchen-weekdays-list.is-carousel::-webkit-scrollbar {
+  display: none;
+}
+
+.kitchen-weekdays-item {
+  min-width: 64px;
+  min-height: 80px;
+  padding: 8px 6px;
+  border-radius: 14px;
+  border: 1px solid transparent;
+  background: transparent;
+  display: flex;
+  flex-direction: column;
+  align-items: center;
+  gap: 6px;
+  cursor: pointer;
+  scroll-snap-align: center;
+  transition: border-color 0.2s ease, background 0.2s ease, transform 0.2s ease;
+}
+
+.kitchen-weekdays-item:focus-visible {
+  outline: 2px solid #6366f1;
+  outline-offset: 2px;
+}
+
+.kitchen-weekdays-item.is-selected {
+  border-color: #c7d2fe;
+  background: #f8f9ff;
+}
+
+.kitchen-weekdays-circle {
+  width: 52px;
+  height: 52px;
+  border-radius: 999px;
+  display: flex;
+  align-items: center;
+  justify-content: center;
+  font-weight: 700;
+  font-size: 14px;
+  letter-spacing: 0.04em;
+  text-transform: uppercase;
+  background: var(--weekday-bg);
+  color: var(--weekday-text);
+  border: 1px solid var(--weekday-border);
+  box-sizing: border-box;
+}
+
+.kitchen-weekdays-label {
+  font-size: 12px;
+  font-weight: 600;
+  color: #475467;
+  text-transform: uppercase;
+}
+
+.kitchen-day-card {
+  min-height: 100%;
+}
+
+.kitchen-day-card.is-empty {
+  min-height: auto;
+  background: #f8f9ff;
+  border: 1px solid #e4e7ff;
+  box-shadow: 0 10px 30px rgba(99, 102, 241, 0.06);
+}
+
+.kitchen-day-card.is-selected {
+  border: 1px solid #c7d2fe;
+  box-shadow: 0 0 0 1px rgba(99, 102, 241, 0.05);
+}
+
+.kitchen-day-header {
+  display: flex;
+  flex-direction: column;
+  gap: 6px;
+}
+
+.kitchen-day-cta {
+  display: flex;
+  justify-content: flex-end;
+  align-items: center;
+  gap: 8px;
+}
+
+.kitchen-day-edit-actions {
+  display: inline-flex;
+  gap: 8px;
+}
+
+.kitchen-day-title {
+  margin: 0;
+  font-size: 18px;
+  font-weight: 700;
+  text-transform: capitalize;
+}
+
+.kitchen-day-meta {
+  display: flex;
+  flex-direction: column;
+  gap: 4px;
+  font-size: 13px;
+  color: #667085;
+}
+
+.kitchen-day-status {
+  display: flex;
+  flex-wrap: wrap;
+  gap: 6px;
+}
+
+.kitchen-day-view {
+  display: flex;
+  flex-direction: column;
+  gap: 12px;
+}
+
+.kitchen-day-empty {
+  display: flex;
+  flex-direction: column;
+  flex: 1;
+  min-height: 120px;
+}
+
+.kitchen-day-empty-spacer {
+  flex: 1;
+}
+
+.kitchen-day-empty-button {
+  margin-top: auto;
+  align-self: center;
+  width: 100%;
+}
+
+.kitchen-day-info {
+  display: flex;
+  flex-direction: column;
+  gap: 4px;
+}
+
+.kitchen-day-info-label {
+  font-size: 12px;
+  color: #667085;
+  font-weight: 600;
+  text-transform: uppercase;
+  letter-spacing: 0.04em;
+}
+
+.kitchen-day-info-value {
+  font-size: 16px;
+  font-weight: 600;
+  color: #101828;
+}
+
+.kitchen-day-ingredients {
+  display: flex;
+  flex-direction: column;
+  gap: 6px;
+}
+
+.kitchen-day-ingredient-pills {
+  display: flex;
+  flex-wrap: wrap;
+  gap: 8px;
+}
+
+.kitchen-ingredient-pill {
+  display: inline-flex;
+  align-items: center;
+  gap: 6px;
+  padding: 4px 10px;
+  border-radius: 999px;
+  font-size: 12px;
+  font-weight: 600;
+  background: #f8fafc;
+  border: 1px solid #e2e8f0;
+  color: #1f2937;
+}
+
+.kitchen-ingredient-pill.is-extra {
+  background: #fef3f2;
+  border-color: #fecaca;
+  color: #991b1b;
+}
+
+.kitchen-status-pill {
+  display: inline-flex;
+  align-items: center;
+  padding: 2px 8px;
+  border-radius: 999px;
+  font-size: 11px;
+  font-weight: 600;
+  letter-spacing: 0.01em;
+  border: 1px solid transparent;
+  color: #344054;
+  background: #f2f4f7;
+}
+
+.kitchen-status-pill.assigned {
+  color: #1d4ed8;
+  background: #eff6ff;
+  border-color: #dbeafe;
+}
+
+.kitchen-status-pill.planned {
+  color: #1f2937;
+  background: #f8fafc;
+  border-color: #e2e8f0;
+}
+
+.kitchen-status-pill.active {
+  color: #027a48;
+  background: #ecfdf3;
+  border-color: #abefc6;
+}
+
+.kitchen-status-pill.inactive {
+  color: #b42318;
+  background: #fef3f2;
+  border-color: #fecaca;
+}
+
+.kitchen-inline-error {
+  margin: 4px 0 0;
+  font-size: 13px;
+  color: #b42318;
+}
+
+.kitchen-inline-warning {
+  padding: 10px 12px;
+  border-radius: 12px;
+  border: 1px solid #f9dbaf;
+  background: #fff7ed;
+  color: #9a3412;
+  font-weight: 600;
+  font-size: 14px;
+}
+
+.kitchen-ingredient-picker {
+  display: flex;
+  flex-direction: column;
+  gap: 16px;
+}
+
+.kitchen-ingredient-picker .kitchen-input {
+  font-size: 16px;
+  padding: 12px 14px;
+  border-radius: 14px;
+}
+
+.kitchen-ingredient-search {
+  gap: 8px;
+}
+
+.kitchen-chip-list {
+  display: flex;
+  flex-wrap: wrap;
+  gap: 10px 12px;
+  align-items: center;
+  margin-bottom: 8px;
+}
+
+.kitchen-chip-item {
+  display: inline-flex;
+  align-items: center;
+  gap: 8px;
+}
+
+.kitchen-chip {
+  display: inline-flex;
+  align-items: center;
+  gap: 8px;
+  padding: 8px 12px;
+  border-radius: 999px;
+  font-size: 15px;
+  font-weight: 600;
+  border: 1px solid transparent;
+  box-shadow: 0 6px 16px rgba(15, 23, 42, 0.08);
+}
+
+.kitchen-chip-label {
+  line-height: 1.2;
+}
+
+.kitchen-chip.is-pending {
+  border-color: rgba(15, 23, 42, 0.12);
+}
+
+.kitchen-chip-remove {
+  border: none;
+  background: rgba(255, 255, 255, 0.6);
+  color: inherit;
+  width: 22px;
+  height: 22px;
+  border-radius: 999px;
+  display: inline-flex;
+  align-items: center;
+  justify-content: center;
+  cursor: pointer;
+  font-size: 12px;
+  line-height: 1;
+}
+
+.kitchen-chip-action {
+  border: none;
+  background: #ffffff;
+  color: #1d2939;
+  padding: 6px 10px;
+  border-radius: 999px;
+  font-size: 13px;
+  font-weight: 600;
+  box-shadow: 0 6px 16px rgba(15, 23, 42, 0.08);
+  cursor: pointer;
+}
+
+.kitchen-suggestion-list {
+  margin-top: 6px;
+  background: white;
+  border-radius: 16px;
+  border: 1px solid #e4e7ec;
+  box-shadow: 0 12px 30px rgba(15, 23, 42, 0.12);
+  padding: 6px;
+  display: flex;
+  flex-direction: column;
+  gap: 4px;
+}
+
+.kitchen-suggestion-list.is-scrollable {
+  max-height: 240px;
+  overflow-y: auto;
+}
+
+.kitchen-suggestion {
+  border: none;
+  background: transparent;
+  text-align: left;
+  padding: 10px 12px;
+  border-radius: 12px;
+  font-size: 15px;
+  font-weight: 600;
+  color: #101828;
+  cursor: pointer;
+}
+
+.kitchen-suggestion.is-assignee {
+  display: inline-flex;
+  align-items: center;
+  gap: 10px;
+}
+
+.kitchen-suggestion.is-create {
+  color: #4338ca;
+}
+
+.kitchen-suggestion-empty {
+  padding: 8px 10px;
+}
+
+.kitchen-suggestion:hover,
+.kitchen-suggestion:focus-visible {
+  background: #f2f4f7;
+  outline: none;
+}
+
+.kitchen-inline-panel {
+  margin-top: 8px;
+  border-radius: 16px;
+  border: 1px solid #e4e7ec;
+  background: #ffffff;
+  padding: 16px;
+  display: flex;
+  flex-direction: column;
+  gap: 16px;
+  box-shadow: 0 12px 30px rgba(15, 23, 42, 0.08);
+}
+
+.kitchen-inline-header {
+  display: flex;
+  flex-direction: column;
+  gap: 4px;
+  font-size: 16px;
+}
+
+.kitchen-category-list {
+  display: flex;
+  flex-wrap: wrap;
+  gap: 10px;
+  margin-top: 6px;
+}
+
+.kitchen-category-option {
+  border: none;
+  background: transparent;
+  padding: 0;
+  position: relative;
+  cursor: pointer;
+}
+
+.kitchen-category-option .kitchen-chip {
+  padding-right: 26px;
+}
+
+.kitchen-category-option.selected .kitchen-chip {
+  border-color: rgba(15, 23, 42, 0.25);
+  box-shadow: 0 10px 24px rgba(15, 23, 42, 0.14);
+}
+
+.kitchen-category-check {
+  position: absolute;
+  top: -6px;
+  right: -4px;
+  width: 18px;
+  height: 18px;
+  border-radius: 999px;
+  background: #0f172a;
+  color: white;
+  font-size: 11px;
+  display: inline-flex;
+  align-items: center;
+  justify-content: center;
+}
+
+.kitchen-inline-actions {
+  display: flex;
+  flex-wrap: wrap;
+  gap: 10px;
+}
+
+.kitchen-context-modal-backdrop {
+  position: fixed;
+  inset: 0;
+  background: rgba(15, 23, 42, 0.35);
+  display: flex;
+  align-items: center;
+  justify-content: center;
+  padding: 20px;
+  z-index: 60;
+}
+
+.kitchen-context-modal-backdrop.inner {
+  background: rgba(15, 23, 42, 0.2);
+  z-index: 70;
+}
+
+.kitchen-context-modal {
+  width: min(420px, 100%);
+  max-height: min(80vh, 560px);
+  background: #ffffff;
+  border-radius: 18px;
+  padding: 20px;
+  box-shadow: 0 20px 48px rgba(15, 23, 42, 0.18);
+  display: flex;
+  flex-direction: column;
+  gap: 16px;
+  overflow: hidden;
+}
+
+.kitchen-context-modal.small {
+  width: min(380px, 100%);
+}
+
+.kitchen-context-modal-header {
+  display: flex;
+  justify-content: space-between;
+  gap: 12px;
+}
+
+.kitchen-context-modal-header h4 {
+  margin: 0;
+  font-size: 18px;
+}
+
+.kitchen-context-modal-body {
+  display: flex;
+  flex-direction: column;
+  gap: 14px;
+  overflow-y: auto;
+  padding-right: 2px;
+}
+
+.kitchen-context-modal-actions {
+  display: flex;
+  flex-wrap: wrap;
+  gap: 12px;
+  justify-content: center;
+}
+
+.kitchen-color-grid {
+  display: flex;
+  flex-wrap: wrap;
+  gap: 10px;
+}
+
+.kitchen-color-option {
+  border: 1px solid transparent;
+  border-radius: 12px;
+  padding: 8px 12px;
+  background: #f2f4f7;
+  color: #101828;
+  font-weight: 600;
+  cursor: pointer;
+  min-height: 44px;
+}
+
+.kitchen-color-option.swatch {
+  width: 44px;
+  padding: 0;
+  display: inline-flex;
+  align-items: center;
+  justify-content: center;
+  font-weight: 700;
+}
+
+.kitchen-color-option.selected {
+  border-color: rgba(15, 23, 42, 0.3);
+  box-shadow: 0 8px 18px rgba(15, 23, 42, 0.15);
+}
+
+.kitchen-day-feedback {
+  display: flex;
+  flex-direction: column;
+  gap: 4px;
+  margin-top: 12px;
+  font-size: 13px;
+  color: #667085;
+}
+
+.kitchen-day-feedback-text.saving {
+  color: #475467;
+}
+
+.kitchen-day-feedback-text.saved {
+  color: #027a48;
+}
+
+.kitchen-day-feedback-text.error {
+  color: #b42318;
+}
+
+.kitchen-toolbar {
+  display: flex;
+  flex-wrap: wrap;
+  gap: 12px;
+  align-items: center;
+  justify-content: space-between;
+  margin-top: 16px;
+}
+
+.kitchen-alert {
+  border-radius: 12px;
+  padding: 10px 12px;
+  font-weight: 600;
+  font-size: 14px;
+}
+
+.kitchen-alert.success {
+  background: #ecfdf3;
+  color: #027a48;
+  border: 1px solid #a6f4c5;
+}
+
+.kitchen-alert.error {
+  background: #fef3f2;
+  color: #b42318;
+  border: 1px solid #fecdca;
+}
+
+.kitchen-form {
+  display: flex;
+  flex-direction: column;
+  gap: 20px;
+}
+
+.kitchen-dish-form-card {
+  width: 100%;
+  max-width: 560px;
+  margin: 0 auto;
+}
+
+.kitchen-dish-ingredients {
+  gap: 10px;
+}
+
+.kitchen-table {
+  width: 100%;
+  border-collapse: collapse;
+}
+
+.kitchen-table th,
+.kitchen-table td {
+  text-align: left;
+  padding: 10px 8px;
+  border-bottom: 1px solid #eef2f6;
+  font-size: 14px;
+}
+
+@media (max-width: 600px) {
+  .kitchen-container {
+    padding: 16px;
+    padding-bottom: calc(96px + env(safe-area-inset-bottom, 0px));
+  }
+
+  .kitchen-grid {
+    grid-template-columns: 1fr;
+    gap: 16px;
+  }
+
+  .kitchen-week-mobile-frame {
+    width: calc(100% - 32px);
+    max-width: 420px;
+    margin: 0 auto;
+    gap: 16px;
+  }
+
+  .kitchen-week-carousel {
+    margin: 0;
+    width: 100%;
+  }
+
+  .kitchen-week-carousel-arrow {
+    display: none;
+  }
+
+  .kitchen-assign-day.is-occupied .kitchen-assign-day-status {
+    display: none;
+  }
+
+  .kitchen-week-days {
+    display: flex;
+    grid-template-columns: none;
+    overflow-x: auto;
+    scroll-snap-type: x mandatory;
+    scroll-behavior: smooth;
+    -webkit-overflow-scrolling: touch;
+    width: 100%;
+    gap: 0;
+    padding: 0 0 4px;
+    scroll-padding-inline: 0;
+  }
+
+  .kitchen-week-days::-webkit-scrollbar {
+    display: none;
+  }
+
+  .kitchen-week-days .kitchen-day-card {
+    flex: 0 0 100%;
+    scroll-snap-align: start;
+  }
+
+  .kitchen-week-carousel-dots {
+    display: flex;
+    width: 100%;
+  }
+
+  .kitchen-week-header {
+    flex-direction: column;
+    margin-bottom: 0;
+  }
+
+  .kitchen-week-header-actions {
+    width: 100%;
+    align-items: stretch;
+  }
+
+  .kitchen-week-nav {
+    grid-template-columns: 44px 1fr 44px;
+  }
+
+  .kitchen-week-controls {
+    gap: 12px;
+    margin-bottom: 16px;
+  }
+
+  .kitchen-weekdays-strip {
+    order: 0;
+  }
+
+  .kitchen-week-mobile-frame {
+    order: 1;
+  }
+
+  .kitchen-week-picker {
+    width: 100%;
+  }
+
+  .kitchen-week-picker .kitchen-label {
+    display: none;
+  }
+
+  .kitchen-week-picker .kitchen-input {
+    font-size: 15px;
+  }
+
+  .kitchen-weekdays-strip {
+    padding: 12px;
+  }
+
+  .kitchen-weekdays-arrow {
+    display: none;
+  }
+
+  .kitchen-weekdays-list {
+    gap: 8px;
+  }
+
+  .kitchen-weekdays-item {
+    min-width: 56px;
+    min-height: 72px;
+    padding: 6px 4px;
+  }
+
+  .kitchen-weekdays-circle {
+    width: 44px;
+    height: 44px;
+    font-size: 12px;
+  }
+
+  .kitchen-weekdays-label {
+    font-size: 11px;
+  }
+
+  .kitchen-topbar {
+    display: none;
+  }
+
+  .kitchen-nav-desktop {
+    display: none;
+  }
+
+  .kitchen-user {
+    display: none;
+  }
+
+  .kitchen-user-placeholder {
+    display: none;
+  }
+
+  .kitchen-nav-toggle {
+    display: none;
+  }
+
+  .kitchen-drawer,
+  .kitchen-drawer-backdrop {
+    display: none;
+  }
+
+  .kitchen-dishes-header {
+    align-items: flex-start;
+  }
+
+  .kitchen-dishes-header .kitchen-button {
+    width: 100%;
+  }
+
+  .kitchen-dish-card {
+    flex-direction: column;
+    align-items: flex-start;
+  }
+
+  .kitchen-dish-actions {
+    width: 100%;
+    justify-content: flex-end;
+  }
+
+  .kitchen-modal {
+    padding: 20px;
+    max-height: 92vh;
+  }
+
+  .kitchen-context-modal-backdrop {
+    align-items: flex-end;
+  }
+
+  .kitchen-context-modal {
+    width: 100%;
+    border-radius: 18px 18px 0 0;
+    max-height: 85vh;
+  }
+
+  .kitchen-bottom-nav {
+    display: block;
+  }
+
+  .kitchen-bottom-nav-label {
+    font-size: 11px;
+  }
+}
+
+@media (max-width: 360px) {
+  .kitchen-bottom-nav-label {
+    font-size: 10px;
+  }
+}
+
+@media (min-width: 900px) {
+  .kitchen-day-empty-button {
+    max-width: 280px;
+  }
+
+  .kitchen-modal-actions {
+    flex-direction: row;
+  }
+}
+
+
+.kitchen-ui-card {
+  background: var(--hf-surface);
+  border-radius: var(--hf-radius-lg);
+  padding: 24px;
+  box-shadow: var(--hf-shadow-soft);
+  display: flex;
+  flex-direction: column;
+  gap: 16px;
+}
+
+.kitchen-ui-button {
+  border: none;
+  border-radius: 999px;
+  background: var(--hf-brand);
+  color: #fff;
+  padding: 12px 16px;
+  font-weight: 700;
+  cursor: pointer;
+}
+
+.kitchen-ui-button:disabled {
+  opacity: 0.65;
+  cursor: not-allowed;
+}
+
+.kitchen-ui-button-secondary {
+  background: var(--hf-surface-soft);
+  color: var(--hf-text);
+  border: 1px solid var(--hf-border);
+}
+
+.kitchen-ui-button-ghost {
+  background: transparent;
+  border: 1px solid var(--hf-border);
+  color: var(--hf-text);
+}
+
+.kitchen-ui-input-group {
+  display: grid;
+  gap: 6px;
+}
+
+.kitchen-ui-input {
+  border: 1px solid var(--hf-border);
+  border-radius: var(--hf-radius-md);
+  padding: 11px 12px;
+  font-size: 14px;
+  background: #fff;
+}
+
+.kitchen-ui-input:focus-visible {
+  outline: 2px solid color-mix(in srgb, var(--hf-brand) 35%, white);
+  outline-offset: 1px;
+}
+
+.kitchen-ui-badge {
+  border-radius: 999px;
+  padding: 4px 10px;
+  font-size: 12px;
+  font-weight: 600;
+}
+
+.kitchen-ui-badge-default { background: #eef2ff; color: #3730a3; }
+.kitchen-ui-badge-success { background: var(--hf-surface-mint); color: #0f7a3d; }
+.kitchen-ui-badge-warning { background: var(--hf-surface-peach); color: #9a580a; }
+
+.kitchen-ui-header,
+.kitchen-ui-bottom-nav {
+  backdrop-filter: blur(12px);
+  -webkit-backdrop-filter: blur(12px);
+  background: var(--hf-glass);
+}
+
+.kitchen-ui-header {
+  position: sticky;
+  top: 0;
+  z-index: 20;
+  border-bottom: 1px solid var(--hf-glass-border);
+}
+
+.kitchen-ui-header-inner {
+  max-width: 1100px;
+  margin: 0 auto;
+  padding: 16px 24px;
+  display: flex;
+  justify-content: space-between;
+  align-items: center;
+  gap: 16px;
+}
+
+.kitchen-ui-bottom-nav {
+  position: fixed;
+  left: 0;
+  right: 0;
+  bottom: 0;
+  z-index: 25;
+  padding: 10px 12px calc(12px + env(safe-area-inset-bottom, 0px));
+  border-top: 1px solid var(--hf-glass-border);
+  display: none;
+}
+
+.kitchen-login-wrap {
+  max-width: 560px;
+  min-height: 100vh;
+  min-height: 100dvh;
+  display: grid;
+  place-items: center;
+  padding-top: 24px;
+  padding-bottom: 24px;
+}
+
+.kitchen-login-card {
+  width: min(100%, 460px);
+  border-radius: 30px;
+  padding: clamp(22px, 5vw, 34px);
+  background: rgba(248, 250, 252, 0.88);
+  border: 1px solid rgba(228, 231, 236, 0.72);
+  box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.05);
+}
+
+.kitchen-login-badge {
+  display: grid;
+  place-items: center;
+  margin-top: 4px;
+}
+
+.kitchen-login-brand {
+  margin: 0;
+  text-align: center;
+  color: #4338ca;
+  font-size: 1rem;
+  font-weight: 700;
+  letter-spacing: 0.02em;
+}
+
+.kitchen-login-badge-icon {
+  width: 88px;
+  height: 88px;
+  border-radius: 999px;
+  display: grid;
+  place-items: center;
+  background: #f8fafc;
+  box-shadow: 0 0 0 10px rgba(255, 255, 255, 0.9), 0 0 30px rgba(67, 56, 202, 0.14);
+}
+
+.kitchen-login-icon {
+  width: 40px;
+  height: 40px;
+  object-fit: contain;
+}
+
+@media (min-width: 768px) {
+  .kitchen-brand-icon {
+    display: none;
+  }
+
+  .kitchen-brand-logo {
+    display: block;
+  }
+}
+
+.kitchen-login-title {
+  margin: 8px 0 0;
+  text-align: center;
+  font-size: clamp(2rem, 7vw, 2.8rem);
+  font-weight: 700;
+  letter-spacing: -0.02em;
+}
+
+.kitchen-login-subtitle {
+  margin: 0;
+  text-align: center;
+  color: #98a2b3;
+  font-size: clamp(0.95rem, 3vw, 1.1rem);
+}
+
+.kitchen-login-form {
+  margin-top: 10px;
+  display: grid;
+  gap: 14px;
+}
+
+.kitchen-login-fields {
+  display: grid;
+  gap: 14px;
+  border-radius: 30px;
+  background: rgba(255, 255, 255, 0.62);
+  border: 1px solid rgba(228, 231, 236, 0.6);
+  padding: clamp(16px, 5vw, 24px);
+}
+
+.kitchen-login-label {
+  font-size: 0.78rem;
+  color: #98a2b3;
+  font-weight: 700;
+  letter-spacing: 0.06em;
+}
+
+.kitchen-login-input-wrap {
+  position: relative;
+  display: flex;
+  align-items: center;
+}
+
+.kitchen-login-input-icon {
+  width: 18px;
+  height: 18px;
+  color: #98a2b3;
+}
+
+.kitchen-login-input-wrap > .kitchen-login-input-icon {
+  position: absolute;
+  left: 16px;
+  top: 50%;
+  transform: translateY(-50%);
+  pointer-events: none;
+}
+
+.kitchen-ui-input.kitchen-login-input {
+  width: 100%;
+  padding: 15px 16px;
+  padding-left: 52px;
+  border-radius: 999px;
+  border-color: transparent;
+  background: #f8fafc;
+  color: #334155;
+  font-size: 16px;
+  line-height: 1.3;
+  font-weight: 500;
+}
+
+.kitchen-ui-input.kitchen-login-input::placeholder {
+  color: #94a3b8;
+  font-weight: 400;
+}
+
+.kitchen-login-input:focus-visible {
+  border-color: #4338ca;
+  outline: 2px solid rgba(67, 56, 202, 0.2);
+  outline-offset: 1px;
+}
+
+.kitchen-ui-input.kitchen-login-password-input {
+  padding-right: 52px;
+}
+
+.kitchen-login-eye {
+  position: absolute;
+  right: 16px;
+  top: 50%;
+  transform: translateY(-50%);
+  border: none;
+  background: transparent;
+  padding: 6px;
+  border-radius: 999px;
+  display: grid;
+  place-items: center;
+}
+
+.kitchen-login-forgot-row {
+  display: flex;
+  justify-content: flex-end;
+}
+
+.kitchen-login-link {
+  border: none;
+  background: transparent;
+  color: #4338ca;
+  font-weight: 600;
+  font-size: 0.95rem;
+  padding: 0;
+  cursor: pointer;
+}
+
+.kitchen-login-submit {
+  min-height: 54px;
+  font-size: 1.08rem;
+}
+
+.kitchen-login-divider {
+  display: flex;
+  align-items: center;
+  justify-content: center;
+  color: #98a2b3;
+  font-size: 0.78rem;
+  font-weight: 700;
+  letter-spacing: 0.08em;
+  gap: 10px;
+}
+
+.kitchen-login-divider::before,
+.kitchen-login-divider::after {
+  content: "";
+  height: 1px;
+  flex: 1;
+  background: #e4e7ec;
+}
+
+.kitchen-login-socials {
+  display: grid;
+  grid-template-columns: repeat(2, minmax(0, 1fr));
+  gap: 10px;
+}
+
+.kitchen-login-social-button {
+  border-radius: 999px;
+  border: 1px solid var(--hf-border);
+  min-height: 46px;
+  background: rgba(255, 255, 255, 0.8);
+  color: #344054;
+  font-weight: 600;
+  font-size: 1rem;
+  display: inline-flex;
+  align-items: center;
+  justify-content: center;
+  gap: 10px;
+}
+
+.kitchen-login-social-icon {
+  width: 18px;
+  height: 18px;
+  line-height: 1;
+  display: inline-flex;
+  align-items: center;
+  justify-content: center;
+  flex-shrink: 0;
+}
+
+.kitchen-login-social-svg {
+  width: 100%;
+  height: 100%;
+}
+
+.kitchen-login-social-svg-apple {
+  color: #111827;
+}
+
+.kitchen-login-footer {
+  margin: 0;
+  text-align: center;
+  color: #98a2b3;
+  font-size: 1rem;
+}
+
+.kitchen-login-error {
+  color: var(--hf-danger);
+  text-align: center;
+}
+
+.kitchen-ui-bottom-nav-inner {
+  max-width: 720px;
+  margin: 0 auto;
+  display: grid;
+  grid-template-columns: repeat(4, minmax(0, 1fr));
+  gap: 8px;
+}
+
+.kitchen-ui-bottom-nav-item {
+  display: flex;
+  flex-direction: column;
+  align-items: center;
+  color: var(--hf-muted);
+  gap: 4px;
+  border-radius: 14px;
+  padding: 8px 6px;
+  text-decoration: none;
+  font-size: 12px;
+  font-weight: 600;
+}
+
+.kitchen-ui-bottom-nav-item.active {
+  background: #eef2ff;
+  color: var(--hf-brand-strong);
+}
+
+.kitchen-ui-avatar-stack { display: flex; }
+.kitchen-ui-avatar {
+  width: 30px;
+  height: 30px;
+  border-radius: 999px;
+  display: grid;
+  place-items: center;
+  background: #eef2ff;
+  border: 2px solid white;
+  margin-left: -8px;
+  font-size: 12px;
+  font-weight: 700;
+}
+
+.kitchen-ui-avatar:first-child { margin-left: 0; }
+
+.kitchen-ui-fab {
+  position: fixed;
+  bottom: 82px;
+  right: 20px;
+  width: 56px;
+  height: 56px;
+  border-radius: 999px;
+  border: none;
+  background: var(--hf-brand);
+  color: #fff;
+  box-shadow: var(--hf-shadow-glass);
+}
+
+.kitchen-ui-sheet-backdrop {
+  position: fixed;
+  inset: 0;
+  background: rgba(16, 24, 40, 0.45);
+  z-index: 45;
+  display: grid;
+  place-items: end center;
+}
+
+.kitchen-ui-sheet {
+  width: min(720px, 100%);
+  background: #fff;
+  border-radius: var(--hf-radius-xl) var(--hf-radius-xl) 0 0;
+  padding: 24px;
+}
+
+.kitchen-ui-sheet-actions { margin-top: 16px; display: flex; gap: 12px; justify-content: flex-end; }
+
+@media (max-width: 900px) {
+  .kitchen-ui-bottom-nav { display: block; }
+}
+
+/* Neo-Soft 2026 global harmonization */
+.kitchen-container {
+  width: min(1120px, 100%);
+  padding: 20px;
+  margin: 0 auto;
+  max-width: 100%;
+}
+
+.kitchen-ui-card,
+.kitchen-card,
+.kitchen-dish-card,
+.kitchen-inline-panel,
+.kitchen-modal,
+.kitchen-context-modal,
+.kitchen-day-card,
+.kitchen-weekdays-strip {
+  border-radius: var(--hf-radius-lg);
+  box-shadow: var(--hf-shadow-soft);
+  border: 1px solid var(--hf-border);
+  background: var(--hf-surface);
+}
+
+.kitchen-day-card.is-empty,
+.kitchen-dish-card.is-sidedish,
+.kitchen-ui-button-secondary,
+.kitchen-button.secondary,
+.kitchen-status-pill.planned,
+.kitchen-tab-button.is-active {
+  background: var(--hf-surface-soft);
+}
+
+.kitchen-ui-button,
+.kitchen-button,
+.kitchen-assignee-button,
+.kitchen-week-arrow,
+.kitchen-weekdays-arrow,
+.kitchen-assign-week-nav,
+.kitchen-color-option,
+.kitchen-chip-action {
+  border-radius: 999px;
+  min-height: 44px;
+  transition: transform 180ms ease, box-shadow 180ms ease, background 180ms ease, color 180ms ease;
+}
+
+.kitchen-ui-button,
+.kitchen-button {
+  background: var(--hf-brand);
+  color: #fff;
+  box-shadow: var(--hf-shadow-soft);
+}
+
+.kitchen-ui-button:hover,
+.kitchen-button:hover {
+  background: var(--hf-brand-strong);
+  transform: translateY(-1px);
+}
+
+.kitchen-ui-button-secondary,
+.kitchen-button.secondary {
+  border: 1px solid var(--hf-border);
+  color: var(--hf-text);
+}
+
+.kitchen-ui-button-ghost,
+.kitchen-button.ghost {
+  background: transparent;
+  border: 1px solid var(--hf-border);
+  color: var(--hf-text);
+}
+
+.kitchen-ui-input,
+.kitchen-input,
+.kitchen-select,
+.kitchen-textarea {
+  border-radius: var(--hf-radius-md);
+  border: 1px solid var(--hf-border);
+  min-height: 48px;
+  padding: 11px 14px;
+}
+
+.kitchen-topbar,
+.kitchen-bottom-nav,
+.kitchen-ui-header,
+.kitchen-ui-bottom-nav {
+  background: var(--hf-glass);
+  border-color: var(--hf-glass-border);
+  backdrop-filter: blur(12px);
+  -webkit-backdrop-filter: blur(12px);
+}
+
+.kitchen-brand-link,
+.kitchen-title,
+.kitchen-login-title,
+.kitchen-day-title,
+.kitchen-dishes-header h2 {
+  color: var(--hf-text);
+}
+
+.kitchen-toolbar-search {
+  max-width: 340px;
+}
+
+.kitchen-block-gap {
+  margin-bottom: 16px;
+}
+
+.kitchen-title-no-margin {
+  margin-top: 0;
+  margin-bottom: 6px;
+}
+
+.kitchen-form-compact {
+  gap: 12px;
+}
+
+.kitchen-table th,
+.kitchen-table td {
+  border-bottom: 1px solid var(--hf-border);
+}
+
+@media (min-width: 900px) {
+  .kitchen-grid {
+    grid-template-columns: repeat(2, minmax(0, 1fr));
+  }
+}
+
+/* Semana Neo-Soft 2026 redesign */
+.kitchen-ui-header {
+  background: #eef2ff;
+  border-bottom: 1px solid #dbe3ff;
+}
+
+.kitchen-ui-header-inner {
+  min-height: 88px;
+  padding: 20px 24px;
+}
+
+.kitchen-brand-icon {
+  width: 36px;
+  height: 36px;
+}
+
+.kitchen-nav-desktop {
+  gap: 10px;
+}
+
+.kitchen-nav-desktop a {
+  border-radius: 14px;
+  padding: 11px 18px;
+  font-size: 14px;
+  background: transparent;
+}
+
+.kitchen-nav-desktop a.active {
+  background: #dfe4ff;
+  color: #3730a3;
+}
+
+.kitchen-user { position: relative; }
+
+.kitchen-user-chip {
+  display: inline-flex;
+  align-items: center;
+  gap: 10px;
+  border: 1px solid #dbe3ff;
+  background: #ffffff;
+  border-radius: 999px;
+  padding: 7px 14px 7px 8px;
+  cursor: pointer;
+  box-shadow: 0 4px 14px rgba(79, 70, 229, 0.12);
+}
+
+.kitchen-user-chip:hover { background: #f8faff; }
+
+.kitchen-user-avatar {
+  width: 34px;
+  height: 34px;
+  border-radius: 999px;
+  display: grid;
+  place-items: center;
+  background: #dfe4ff;
+  color: #3730a3;
+  font-weight: 700;
+  font-size: 12px;
+}
+
+.kitchen-user-name { font-weight: 600; font-size: 14px; }
+.kitchen-user-chevron,
+.kitchen-user-menu-icon {
+  width: 16px;
+  height: 16px;
+  stroke: currentColor;
+  stroke-width: 1.8;
+  fill: none;
+}
+
+.kitchen-user-menu {
+  position: absolute;
+  right: 0;
+  top: calc(100% + 10px);
+  min-width: 220px;
+  background: rgba(255, 255, 255, 0.96);
+  border: 1px solid #e6e9f8;
+  box-shadow: 0 16px 30px rgba(30, 41, 59, 0.14);
+  border-radius: 20px;
+  padding: 8px;
+  display: grid;
+  gap: 4px;
+  z-index: 30;
+}
+
+.kitchen-user-menu button {
+  border: none;
+  background: transparent;
+  border-radius: 14px;
+  padding: 10px 12px;
+  display: flex;
+  align-items: center;
+  gap: 10px;
+  font-weight: 600;
+  color: #334155;
+  cursor: pointer;
+}
+
+.kitchen-user-menu button:hover { background: #eef2ff; }
+
+.kitchen-weekdays-item {
+  min-width: 72px;
+  min-height: 92px;
+  border-radius: 20px;
+}
+
+.kitchen-weekdays-circle {
+  border-radius: 20px;
+}
+
+.kitchen-day-card {
+  background: var(--day-card-bg, #fff);
+  color: var(--day-card-text, var(--hf-text));
+}
+
+.kitchen-day-title,
+.kitchen-day-info-value,
+.kitchen-day-info-label {
+  color: inherit;
+}
+
+.kitchen-day-empty-button {
+  border-radius: 18px;
+  min-height: 50px;
+}
+
+.kitchen-week-mobile-frame { gap: 22px; }
+
+.kitchen-ui-bottom-nav {
+  background: #eef2ff;
+  border-top: 1px solid #dbe3ff;
+}
+
+@media (max-width: 900px) {
+  .kitchen-ui-header { display: none; }
+  .kitchen-container {
+    padding: 14px 14px 88px;
+  }
+}
+
+.kitchen-user-menu-household {
+  display: flex;
+  flex-direction: column;
+  gap: 6px;
+  padding: 8px 10px;
+}
+
+.kitchen-user-menu-household span {
+  font-size: 12px;
+  color: #64748b;
+}
+
+
+.shopping-header-card {
+  margin-bottom: 16px;
+}
+
+.shopping-header-row {
+  display: flex;
+  justify-content: space-between;
+  align-items: center;
+  gap: 12px;
+}
+
+.shopping-week-nav {
+  margin-top: 12px;
+  display: flex;
+  align-items: center;
+  gap: 10px;
+}
+
+.shopping-week-nav .kitchen-input {
+  max-width: 180px;
+}
+
+.shopping-week-arrow {
+  width: 34px;
+  height: 34px;
+  border-radius: 10px;
+  border: 1px solid var(--hf-border);
+  background: #fff;
+  color: var(--hf-text);
+  display: inline-flex;
+  align-items: center;
+  justify-content: center;
+  cursor: pointer;
+}
+
+.shopping-week-arrow-icon {
+  width: 18px;
+  height: 18px;
+}
+
+.shopping-week-arrow-icon.is-next {
+  transform: rotate(180deg);
+}
+
+.shopping-refresh-icon {
+  border: 1px solid var(--hf-border);
+  background: white;
+  border-radius: 10px;
+  width: 34px;
+  height: 34px;
+  cursor: pointer;
+}
+
+.shopping-toolbar {
+  margin-top: 12px;
+  display: grid;
+  grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
+  gap: 10px;
+}
+
+.shopping-tabs {
+  margin-top: 12px;
+  display: flex;
+  gap: 8px;
+}
+
+.shopping-tab {
+  border: 1px solid var(--hf-border);
+  background: #fff;
+  border-radius: 999px;
+  padding: 8px 12px;
+  cursor: pointer;
+}
+
+.shopping-tab.active {
+  background: var(--hf-surface-soft);
+  border-color: var(--hf-brand);
+}
+
+.shopping-categories {
+  display: grid;
+  gap: 14px;
+}
+
+.shopping-category-card {
+  background: color-mix(in srgb, var(--category-bg, #f8fafc) 65%, #fff);
+  border: 1px solid color-mix(in srgb, var(--category-text, #64748b) 16%, #fff);
+}
+
+.shopping-category-head {
+  display: flex;
+  align-items: center;
+  justify-content: space-between;
+  gap: 10px;
+  margin-bottom: 10px;
+}
+
+.shopping-category-head h4 {
+  color: var(--category-text, var(--hf-text));
+  letter-spacing: 0.04em;
+}
+
+.shopping-category-count {
+  border-radius: 999px;
+  padding: 4px 10px;
+  font-size: 12px;
+  font-weight: 700;
+  color: #fff;
+  background: color-mix(in srgb, var(--category-text, #475569) 75%, #1e293b);
+}
+
+.shopping-items-list {
+  display: grid;
+  gap: 9px;
+}
+
+.shopping-item {
+  display: flex;
+  align-items: center;
+  gap: 10px;
+  padding: 10px;
+  border-radius: 14px;
+  background: color-mix(in srgb, var(--category-bg, #f8fafc) 45%, white);
+  transition: transform 220ms ease, opacity 220ms ease, background 220ms ease;
+}
+
+.shopping-item.is-leaving {
+  opacity: 0;
+  transform: translateX(8px) scale(0.98);
+}
+
+.shopping-item.is-entering {
+  animation: shoppingEnter 360ms ease;
+}
+
+.shopping-item-text {
+  display: flex;
+  flex-direction: column;
+  gap: 2px;
+}
+
+.shopping-item.purchased .shopping-item-text {
+  text-decoration: line-through;
+  color: var(--hf-muted);
+}
+
+.shopping-check {
+  width: 28px;
+  height: 28px;
+  border-radius: 999px;
+  border: 2px solid color-mix(in srgb, var(--category-text, #64748b) 32%, #fff);
+  background: transparent;
+  display: inline-flex;
+  align-items: center;
+  justify-content: center;
+  cursor: pointer;
+  transition: transform 200ms ease, background 200ms ease, border-color 200ms ease;
+}
+
+.shopping-check:hover {
+  transform: scale(1.06);
+}
+
+.shopping-check-dot {
+  color: #fff;
+  font-size: 14px;
+  line-height: 1;
+  opacity: 0;
+  transform: scale(0.6);
+  transition: opacity 200ms ease, transform 220ms cubic-bezier(.2,.85,.3,1.3);
+}
+
+.shopping-check.is-checked {
+  background: var(--hf-brand);
+  border-color: var(--hf-brand);
+}
+
+.shopping-check.is-checked .shopping-check-dot {
+  opacity: 1;
+  transform: scale(1);
+}
+
+@keyframes shoppingEnter {
+  0% {
+    opacity: 0;
+    transform: translateY(6px) scale(0.98);
+  }
+  70% {
+    opacity: 1;
+    transform: translateY(0) scale(1.01);
+  }
+  100% {
+    transform: translateY(0) scale(1);
+  }
+}
+
+.shopping-store-select-compact {
+  width: auto;
+  min-width: 150px;
+  max-width: 220px;
+  padding-right: 28px;
+  font-size: 13px;
+}
diff --git a/frontend/src/kitchen/pages/ShoppingPage.jsx b/frontend/src/kitchen/pages/ShoppingPage.jsx
index 88bab9d4d0d472b90f66b6c6b4773db3501a75ac..ca8bbf0d8166a642665d92b24b7ee5da7585fc23 100644
--- a/frontend/src/kitchen/pages/ShoppingPage.jsx
+++ b/frontend/src/kitchen/pages/ShoppingPage.jsx
@@ -1,298 +1,308 @@
-import React, { useEffect, useMemo, useRef, useState } from "react";
-import KitchenLayout from "../Layout.jsx";
-import { apiRequest } from "../api.js";
-import { useAuth } from "../auth";
-import { useActiveWeek } from "../weekContext.jsx";
-
-function ChevronIcon(props) {
-  return (
-    <svg viewBox="0 0 20 20" fill="none" aria-hidden="true" {...props}>
-      <path d="M11.75 4.5 6.25 10l5.5 5.5" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" />
-    </svg>
-  );
-}
-
-function addDaysToISO(iso, days) {
-  const date = new Date(`${iso}T00:00:00Z`);
-  date.setUTCDate(date.getUTCDate() + days);
-  return date.toISOString().slice(0, 10);
-}
-
-function normalizeWeekStartInput(value) {
-  if (!value) return "";
-  const d = new Date(`${value}T00:00:00Z`);
-  const day = d.getUTCDay();
-  const diff = (day === 0 ? -6 : 1) - day;
-  d.setUTCDate(d.getUTCDate() + diff);
-  return d.toISOString().slice(0, 10);
-}
-
-function formatWeekTitle(iso) {
-  if (!iso) return "";
-  return new Date(`${iso}T00:00:00Z`).toLocaleDateString("es-ES", {
-    day: "2-digit",
-    month: "2-digit",
-    year: "numeric"
-  });
-}
-
-function formatTripDate(value) {
-  if (!value || value === "sin-fecha") return "Sin fecha";
-  return new Date(`${value}T00:00:00Z`).toLocaleDateString("es-ES", { day: "2-digit", month: "2-digit", year: "numeric" });
-}
-
-function slugColor(slug = "") {
-  const normalized = String(slug || "otros");
-  const seed = normalized.split("").reduce((acc, char) => acc + char.charCodeAt(0), 0);
-  const hue = seed % 360;
-  return {
-    colorBg: `hsl(${hue} 70% 95%)`,
-    colorText: `hsl(${hue} 55% 35%)`
-  };
-}
-
-function itemKey(item) {
-  return `${item.ingredientId || "no-id"}-${item.canonicalName}`;
-}
-
-export default function ShoppingPage() {
-  const { user } = useAuth();
-  const { activeWeek: weekStart, setActiveWeek: setWeekStart } = useActiveWeek();
-  const [tab, setTab] = useState("pending");
-  const [error, setError] = useState("");
-  const [success, setSuccess] = useState("");
-  const [isRefreshing, setIsRefreshing] = useState(false);
-  const [stores, setStores] = useState([]);
-  const [selectedStoreId, setSelectedStoreId] = useState("");
-  const selectedStoreRef = useRef("");
-  const [pendingByCategory, setPendingByCategory] = useState([]);
-  const [purchasedByStoreDay, setPurchasedByStoreDay] = useState([]);
-  const [transitioningItemKey, setTransitioningItemKey] = useState(null);
-  const [recentlyMovedItemKey, setRecentlyMovedItemKey] = useState(null);
-  const isDiodGlobalMode = user?.globalRole === "diod" && !user?.activeHouseholdId;
-
-  const applyPayload = (data) => {
-    setStores(data.stores || []);
-    setPendingByCategory(data.pendingByCategory || []);
-    setPurchasedByStoreDay(data.purchasedByStoreDay || []);
-  };
-
-  const loadList = async ({ silent = false } = {}) => {
-    if (isDiodGlobalMode) return;
-    if (!silent) setIsRefreshing(true);
-    setError("");
-    try {
-      const data = await apiRequest(`/api/kitchen/shopping/${weekStart}`);
-      applyPayload(data);
-    } catch (err) {
-      setError(err.message || "No se pudo cargar la lista.");
-    } finally {
-      if (!silent) setIsRefreshing(false);
-    }
-  };
-
-  useEffect(() => {
-    void loadList();
-  }, [weekStart, isDiodGlobalMode]);
-
-  useEffect(() => {
-    if (!recentlyMovedItemKey) return undefined;
-    const timer = setTimeout(() => setRecentlyMovedItemKey(null), 650);
-    return () => clearTimeout(timer);
-  }, [recentlyMovedItemKey]);
-
-  const refreshList = async () => {
-    if (isDiodGlobalMode) return;
-    setIsRefreshing(true);
-    try {
-      const data = await apiRequest(`/api/kitchen/shopping/${weekStart}/rebuild`, { method: "POST" });
-      applyPayload(data);
-      setSuccess("Lista reconstruida");
-    } catch (err) {
-      setError(err.message || "No se pudo refrescar la lista.");
-    } finally {
-      setIsRefreshing(false);
-    }
-  };
-
-  const setItemStatus = async (item, status) => {
-    if (isDiodGlobalMode) return;
-    const key = itemKey(item);
-    setTransitioningItemKey(key);
-    try {
-      const data = await apiRequest(`/api/kitchen/shopping/${weekStart}/item`, {
-        method: "PUT",
-        body: JSON.stringify({
-          canonicalName: item.canonicalName,
-          ingredientId: item.ingredientId,
-          status,
-          storeId: status === "purchased" ? selectedStoreRef.current || null : null
-        })
-      });
-      applyPayload(data);
-      setRecentlyMovedItemKey(key);
-    } catch (err) {
-      setError(err.message || "No se pudo actualizar.");
-    } finally {
-      setTransitioningItemKey(null);
-    }
-  };
-
-  const updatePurchasedItemStore = async (item, storeId) => {
-    try {
-      const data = await apiRequest(`/api/kitchen/shopping/${weekStart}/item/store`, {
-        method: "PUT",
-        body: JSON.stringify({ canonicalName: item.canonicalName, ingredientId: item.ingredientId, storeId: storeId || null })
-      });
-      applyPayload(data);
-    } catch (err) {
-      setError(err.message || "No se pudo cambiar el supermercado.");
-    }
-  };
-
-  const assignStoreToTodayUnassigned = async () => {
-    try {
-      const data = await apiRequest(`/api/kitchen/shopping/${weekStart}/purchased/assign-store`, {
-        method: "POST",
-        body: JSON.stringify({ storeId: selectedStoreId || null })
-      });
-      applyPayload(data);
-      setSuccess(data.updated ? "Supermercado asignado" : "No había comprados de hoy sin supermercado");
-    } catch (err) {
-      setError(err.message || "No se pudo asignar supermercado en bloque.");
-    }
-  };
-
-  const createStoreFromDropdown = async () => {
-    const name = window.prompt("Nombre del supermercado");
-    if (!name || !name.trim()) return;
-    setError("");
-    try {
-      await apiRequest("/api/kitchen/shopping/stores", {
-        method: "POST",
-        body: JSON.stringify({ name: name.trim() })
-      });
-      await loadList({ silent: true });
-    } catch (err) {
-      setError(err.message || "No se pudo crear el supermercado.");
-    }
-  };
-
-  const pendingCount = useMemo(
-    () => pendingByCategory.reduce((acc, group) => acc + (group.items?.length || 0), 0),
-    [pendingByCategory]
-  );
-
-  if (isDiodGlobalMode) {
-    return (
-      <KitchenLayout>
-        <div className="kitchen-card">Selecciona un hogar activo para ver su lista de la compra.</div>
-      </KitchenLayout>
-    );
-  }
-
-  return (
-    <KitchenLayout>
-      <div className="kitchen-stack-lg">
-        <div className="kitchen-card shopping-header-card">
-          <div className="shopping-header-row">
-            <div>
-              <h3>Lista de la compra · Semana {formatWeekTitle(weekStart)}</h3>
-              <p className="kitchen-muted">Marca productos y se registra automáticamente quién compró y cuándo.</p>
-            </div>
-            <button className="kitchen-button secondary" type="button" onClick={refreshList} disabled={isRefreshing}>Refrescar</button>
-          </div>
-
-          <div className="shopping-week-nav">
-            <button className="shopping-week-arrow" type="button" onClick={() => setWeekStart((prev) => addDaysToISO(prev, -7))}><ChevronIcon className="shopping-week-arrow-icon" /></button>
-            <input className="kitchen-input" type="date" value={weekStart} onChange={(event) => setWeekStart(normalizeWeekStartInput(event.target.value))} />
-            <button className="shopping-week-arrow" type="button" onClick={() => setWeekStart((prev) => addDaysToISO(prev, 7))}><ChevronIcon className="shopping-week-arrow-icon is-next" /></button>
-          </div>
-
-          <div className="shopping-toolbar">
-            <select
-              className="kitchen-select"
-              value={selectedStoreId}
-              onChange={(event) => {
-                const value = event.target.value;
-                if (value === "__add__") {
-                  void createStoreFromDropdown();
-                  return;
-                }
-                selectedStoreRef.current = value;
-                setSelectedStoreId(value);
-              }}
-            >
-              <option value="">Supermercado (opcional)</option>
-              {stores.map((store) => (
-                <option key={store._id} value={store._id}>{store.name}</option>
-              ))}
-              <option value="__add__">Añadir supermercado…</option>
-            </select>
-            <button className="kitchen-button secondary" type="button" onClick={assignStoreToTodayUnassigned}>Asignar a comprados de hoy sin supermercado</button>
-          </div>
-          {success ? <div className="kitchen-alert success">{success}</div> : null}
-          {error ? <div className="kitchen-alert error">{error}</div> : null}
-        </div>
-
-        <div className="kitchen-dishes-tabs" role="tablist" aria-label="Estado de la compra">
-          <button className={`kitchen-tab-button ${tab === "pending" ? "is-active" : ""}`} onClick={() => setTab("pending")}>Pendiente ({pendingCount})</button>
-          <button className={`kitchen-tab-button ${tab === "purchased" ? "is-active" : ""}`} onClick={() => setTab("purchased")}>Comprado</button>
-        </div>
-
-        {tab === "pending" ? (
-          <div className="shopping-categories">
-            {pendingByCategory.length === 0 ? (
-              <div className="kitchen-card kitchen-empty"><h4>No hay pendientes para esta semana.</h4></div>
-            ) : pendingByCategory.map((group) => {
-              const category = { name: group.categoryInfo?.name || "Sin categoría", ...slugColor(group.categoryInfo?.slug), ...group.categoryInfo };
-              return (
-                <div className="kitchen-card shopping-category-card" key={group.categoryId || group.categoryInfo?.slug || group.categoryInfo?.name} style={{ "--category-bg": category.colorBg, "--category-text": category.colorText }}>
-                  <div className="shopping-category-head"><h4>{category.name.toUpperCase()}</h4><span className="shopping-category-count">{group.items.length} items</span></div>
-                  <div className="shopping-items-list">
-                    {group.items.map((item) => {
-                      const key = itemKey(item);
-                      return (
-                        <div className={`shopping-item ${transitioningItemKey === key ? "is-leaving" : ""}`} key={key}>
-                          <button className="shopping-check" type="button" onClick={() => setItemStatus(item, "purchased")}><span className="shopping-check-dot">✓</span></button>
-                          <span className="shopping-item-text">{item.displayName} {item.occurrences > 1 ? `x${item.occurrences}` : ""}</span>
-                        </div>
-                      );
-                    })}
-                  </div>
-                </div>
-              );
-            })}
-          </div>
-        ) : (
-          <div className="shopping-categories">
-            {purchasedByStoreDay.length === 0 ? (
-              <div className="kitchen-card kitchen-empty"><h4>Aún no hay ingredientes comprados.</h4></div>
-            ) : purchasedByStoreDay.map((group) => (
-              <div className="kitchen-card shopping-category-card" key={`${group.purchasedDate}-${group.storeId || "none"}`}>
-                <h4>{group.storeName} · {formatTripDate(group.purchasedDate)}</h4>
-                <div className="shopping-items-list">
-                  {group.items.map((item) => {
-                    const key = itemKey(item);
-                    return (
-                      <div className={`shopping-item purchased ${transitioningItemKey === key ? "is-leaving" : ""} ${recentlyMovedItemKey === key ? "is-entering" : ""}`} key={key}>
-                        <button className="shopping-check is-checked" type="button" onClick={() => setItemStatus(item, "pending")}><span className="shopping-check-dot">✓</span></button>
-                        <span className="shopping-item-text">{item.displayName} {item.occurrences > 1 ? `x${item.occurrences}` : ""}</span>
-                        <select className="kitchen-select" value={item.storeId || ""} onChange={(event) => updatePurchasedItemStore(item, event.target.value)}>
-                          <option value="">Sin supermercado</option>
-                          {stores.map((store) => (
-                            <option key={store._id} value={store._id}>{store.name}</option>
-                          ))}
-                        </select>
-                      </div>
-                    );
-                  })}
-                </div>
-              </div>
-            ))}
-          </div>
-        )}
-      </div>
-    </KitchenLayout>
-  );
-}
+import React, { useEffect, useMemo, useRef, useState } from "react";
+import KitchenLayout from "../Layout.jsx";
+import { apiRequest } from "../api.js";
+import { useAuth } from "../auth";
+import { useActiveWeek } from "../weekContext.jsx";
+
+function ChevronIcon(props) {
+  return (
+    <svg viewBox="0 0 20 20" fill="none" aria-hidden="true" {...props}>
+      <path d="M11.75 4.5 6.25 10l5.5 5.5" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" />
+    </svg>
+  );
+}
+
+function RefreshIcon(props) {
+  return (
+    <svg viewBox="0 0 24 24" fill="none" aria-hidden="true" {...props}>
+      <path d="M20 12a8 8 0 1 1-2.343-5.657" stroke="currentColor" strokeWidth="1.8" strokeLinecap="round"/>
+      <path d="M20 4v4h-4" stroke="currentColor" strokeWidth="1.8" strokeLinecap="round" strokeLinejoin="round"/>
+    </svg>
+  );
+}
+
+function addDaysToISO(iso, days) {
+  const date = new Date(`${iso}T00:00:00Z`);
+  date.setUTCDate(date.getUTCDate() + days);
+  return date.toISOString().slice(0, 10);
+}
+
+function normalizeWeekStartInput(value) {
+  if (!value) return "";
+  const d = new Date(`${value}T00:00:00Z`);
+  const day = d.getUTCDay();
+  const diff = (day === 0 ? -6 : 1) - day;
+  d.setUTCDate(d.getUTCDate() + diff);
+  return d.toISOString().slice(0, 10);
+}
+
+function formatWeekTitle(iso) {
+  if (!iso) return "";
+  return new Date(`${iso}T00:00:00Z`).toLocaleDateString("es-ES", {
+    day: "2-digit",
+    month: "2-digit",
+    year: "numeric"
+  });
+}
+
+function formatTripDate(value) {
+  if (!value || value === "sin-fecha") return "Sin fecha";
+  return new Date(`${value}T00:00:00Z`).toLocaleDateString("es-ES", { day: "2-digit", month: "2-digit", year: "numeric" });
+}
+
+function slugColor(slug = "") {
+  const normalized = String(slug || "otros");
+  const seed = normalized.split("").reduce((acc, char) => acc + char.charCodeAt(0), 0);
+  const hue = seed % 360;
+  return {
+    colorBg: `hsl(${hue} 70% 95%)`,
+    colorText: `hsl(${hue} 55% 35%)`
+  };
+}
+
+function itemKey(item) {
+  return `${item.ingredientId || "no-id"}-${item.canonicalName}`;
+}
+
+export default function ShoppingPage() {
+  const { user } = useAuth();
+  const { activeWeek: weekStart, setActiveWeek: setWeekStart } = useActiveWeek();
+  const [tab, setTab] = useState("pending");
+  const [error, setError] = useState("");
+  const [success, setSuccess] = useState("");
+  const [isRefreshing, setIsRefreshing] = useState(false);
+  const [stores, setStores] = useState([]);
+  const [selectedStoreId, setSelectedStoreId] = useState("");
+  const selectedStoreRef = useRef("");
+  const [pendingByCategory, setPendingByCategory] = useState([]);
+  const [purchasedByStoreDay, setPurchasedByStoreDay] = useState([]);
+  const [transitioningItemKey, setTransitioningItemKey] = useState(null);
+  const [recentlyMovedItemKey, setRecentlyMovedItemKey] = useState(null);
+  const isDiodGlobalMode = user?.globalRole === "diod" && !user?.activeHouseholdId;
+
+  const applyPayload = (data) => {
+    setStores(data.stores || []);
+    setPendingByCategory(data.pendingByCategory || []);
+    setPurchasedByStoreDay(data.purchasedByStoreDay || []);
+  };
+
+  const loadList = async ({ silent = false } = {}) => {
+    if (isDiodGlobalMode) return;
+    if (!silent) setIsRefreshing(true);
+    setError("");
+    try {
+      const data = await apiRequest(`/api/kitchen/shopping/${weekStart}`);
+      applyPayload(data);
+    } catch (err) {
+      setError(err.message || "No se pudo cargar la lista.");
+    } finally {
+      if (!silent) setIsRefreshing(false);
+    }
+  };
+
+  useEffect(() => {
+    void loadList();
+  }, [weekStart, isDiodGlobalMode]);
+
+  useEffect(() => {
+    if (!recentlyMovedItemKey) return undefined;
+    const timer = setTimeout(() => setRecentlyMovedItemKey(null), 650);
+    return () => clearTimeout(timer);
+  }, [recentlyMovedItemKey]);
+
+  const refreshList = async () => {
+    if (isDiodGlobalMode) return;
+    setIsRefreshing(true);
+    try {
+      const data = await apiRequest(`/api/kitchen/shopping/${weekStart}/rebuild`, { method: "POST" });
+      applyPayload(data);
+      setSuccess("Lista reconstruida");
+    } catch (err) {
+      setError(err.message || "No se pudo refrescar la lista.");
+    } finally {
+      setIsRefreshing(false);
+    }
+  };
+
+  const setItemStatus = async (item, status) => {
+    if (isDiodGlobalMode) return;
+    const key = itemKey(item);
+    setTransitioningItemKey(key);
+    try {
+      const data = await apiRequest(`/api/kitchen/shopping/${weekStart}/item`, {
+        method: "PUT",
+        body: JSON.stringify({
+          canonicalName: item.canonicalName,
+          ingredientId: item.ingredientId,
+          status,
+          storeId: status === "purchased" ? selectedStoreRef.current || null : null
+        })
+      });
+      applyPayload(data);
+      setRecentlyMovedItemKey(key);
+    } catch (err) {
+      setError(err.message || "No se pudo actualizar.");
+    } finally {
+      setTransitioningItemKey(null);
+    }
+  };
+
+  const updatePurchasedItemStore = async (item, storeId) => {
+    try {
+      const data = await apiRequest(`/api/kitchen/shopping/${weekStart}/item/store`, {
+        method: "PUT",
+        body: JSON.stringify({ canonicalName: item.canonicalName, ingredientId: item.ingredientId, storeId: storeId || null })
+      });
+      applyPayload(data);
+    } catch (err) {
+      setError(err.message || "No se pudo cambiar el supermercado.");
+    }
+  };
+
+  const assignStoreToTodayUnassigned = async () => {
+    try {
+      const data = await apiRequest(`/api/kitchen/shopping/${weekStart}/purchased/assign-store`, {
+        method: "POST",
+        body: JSON.stringify({ storeId: selectedStoreId || null })
+      });
+      applyPayload(data);
+      setSuccess(data.updated ? "Supermercado asignado" : "No había comprados de hoy sin supermercado");
+    } catch (err) {
+      setError(err.message || "No se pudo asignar supermercado en bloque.");
+    }
+  };
+
+  const createStoreFromDropdown = async () => {
+    const name = window.prompt("Nombre del supermercado");
+    if (!name || !name.trim()) return;
+    setError("");
+    try {
+      await apiRequest("/api/kitchen/shopping/stores", {
+        method: "POST",
+        body: JSON.stringify({ name: name.trim() })
+      });
+      await loadList({ silent: true });
+    } catch (err) {
+      setError(err.message || "No se pudo crear el supermercado.");
+    }
+  };
+
+  const pendingCount = useMemo(
+    () => pendingByCategory.reduce((acc, group) => acc + (group.items?.length || 0), 0),
+    [pendingByCategory]
+  );
+
+  if (isDiodGlobalMode) {
+    return (
+      <KitchenLayout>
+        <div className="kitchen-card">Selecciona un hogar activo para ver su lista de la compra.</div>
+      </KitchenLayout>
+    );
+  }
+
+  return (
+    <KitchenLayout>
+      <div className="kitchen-stack-lg">
+        <div className="kitchen-card shopping-header-card">
+          <div className="shopping-header-row">
+            <div>
+              <h3>Lista de la compra · Semana {formatWeekTitle(weekStart)}</h3>
+            </div>
+            <button className="shopping-refresh-icon" type="button" onClick={refreshList} disabled={isRefreshing} aria-label="Reconstruir lista" title="Reconstruir lista">
+              <RefreshIcon className="shopping-week-arrow-icon" />
+            </button>
+          </div>
+
+          <div className="shopping-week-nav">
+            <button className="shopping-week-arrow" type="button" onClick={() => setWeekStart((prev) => addDaysToISO(prev, -7))}><ChevronIcon className="shopping-week-arrow-icon" /></button>
+            <input className="kitchen-input" type="date" value={weekStart} onChange={(event) => setWeekStart(normalizeWeekStartInput(event.target.value))} />
+            <button className="shopping-week-arrow" type="button" onClick={() => setWeekStart((prev) => addDaysToISO(prev, 7))}><ChevronIcon className="shopping-week-arrow-icon is-next" /></button>
+          </div>
+
+          <div className="shopping-toolbar">
+            <select
+              className="kitchen-select"
+              value={selectedStoreId}
+              onChange={(event) => {
+                const value = event.target.value;
+                if (value === "__add__") {
+                  void createStoreFromDropdown();
+                  return;
+                }
+                selectedStoreRef.current = value;
+                setSelectedStoreId(value);
+              }}
+            >
+              <option value="">Supermercado (opcional)</option>
+              {stores.map((store) => (
+                <option key={store._id} value={store._id}>{store.name}</option>
+              ))}
+              <option value="__add__">Añadir supermercado…</option>
+            </select>
+            <button className="kitchen-button secondary" type="button" onClick={assignStoreToTodayUnassigned}>Asignar a comprados de hoy sin supermercado</button>
+          </div>
+          {success ? <div className="kitchen-alert success">{success}</div> : null}
+          {error ? <div className="kitchen-alert error">{error}</div> : null}
+        </div>
+
+        <div className="kitchen-dishes-tabs" role="tablist" aria-label="Estado de la compra">
+          <button className={`kitchen-tab-button ${tab === "pending" ? "is-active" : ""}`} onClick={() => setTab("pending")}>Pendiente ({pendingCount})</button>
+          <button className={`kitchen-tab-button ${tab === "purchased" ? "is-active" : ""}`} onClick={() => setTab("purchased")}>Comprado</button>
+        </div>
+
+        {tab === "pending" ? (
+          <div className="shopping-categories">
+            {pendingByCategory.length === 0 ? (
+              <div className="kitchen-card kitchen-empty"><h4>No hay pendientes para esta semana.</h4></div>
+            ) : pendingByCategory.map((group) => {
+              const category = { name: group.categoryInfo?.name || "Sin categoría", ...slugColor(group.categoryInfo?.slug), ...group.categoryInfo };
+              return (
+                <div className="kitchen-card shopping-category-card" key={group.categoryId || group.categoryInfo?.slug || group.categoryInfo?.name} style={{ "--category-bg": category.colorBg, "--category-text": category.colorText }}>
+                  <div className="shopping-category-head"><h4>{category.name.toUpperCase()}</h4><span className="shopping-category-count">{group.items.length} items</span></div>
+                  <div className="shopping-items-list">
+                    {group.items.map((item) => {
+                      const key = itemKey(item);
+                      return (
+                        <div className={`shopping-item ${transitioningItemKey === key ? "is-leaving" : ""}`} key={key}>
+                          <button className="shopping-check" type="button" onClick={() => setItemStatus(item, "purchased")}><span className="shopping-check-dot">✓</span></button>
+                          <span className="shopping-item-text">{item.displayName} {item.occurrences > 1 ? `x${item.occurrences}` : ""}</span>
+                        </div>
+                      );
+                    })}
+                  </div>
+                </div>
+              );
+            })}
+          </div>
+        ) : (
+          <div className="shopping-categories">
+            {purchasedByStoreDay.length === 0 ? (
+              <div className="kitchen-card kitchen-empty"><h4>Aún no hay ingredientes comprados.</h4></div>
+            ) : purchasedByStoreDay.map((group) => (
+              <div className="kitchen-card shopping-category-card" key={`${group.purchasedDate}-${group.storeId || "none"}`}>
+                <h4>Comprado por {group.purchasedByName || "Usuario"} · {group.storeName || "Supermercado no definido"} · {formatTripDate(group.purchasedDate)}</h4>
+                <div className="shopping-items-list">
+                  {group.items.map((item) => {
+                    const key = itemKey(item);
+                    return (
+                      <div className={`shopping-item purchased ${transitioningItemKey === key ? "is-leaving" : ""} ${recentlyMovedItemKey === key ? "is-entering" : ""}`} key={key}>
+                        <button className="shopping-check is-checked" type="button" onClick={() => setItemStatus(item, "pending")}><span className="shopping-check-dot">✓</span></button>
+                        <span className="shopping-item-text">{item.displayName} {item.occurrences > 1 ? `x${item.occurrences}` : ""}</span>
+                        <select className="kitchen-select shopping-store-select-compact" value={item.storeId || ""} onChange={(event) => updatePurchasedItemStore(item, event.target.value)}>
+                          <option value="">Sin supermercado</option>
+                          {stores.map((store) => (
+                            <option key={store._id} value={store._id}>{store.name}</option>
+                          ))}
+                        </select>
+                      </div>
+                    );
+                  })}
+                </div>
+              </div>
+            ))}
+          </div>
+        )}
+      </div>
+    </KitchenLayout>
+  );
+}
